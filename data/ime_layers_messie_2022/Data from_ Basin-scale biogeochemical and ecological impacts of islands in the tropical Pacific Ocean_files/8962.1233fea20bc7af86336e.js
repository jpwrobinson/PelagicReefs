"use strict";(self.webpackChunkinvenio_assets=self.webpackChunkinvenio_assets||[]).push([[8962],{82872:(e,t,n)=>{n.d(t,{A:()=>h});var r=n(58168),i=n(23029),a=n(92901),o=n(56822),u=n(53954),c=n(85501),l=n(96540),s=n(53196),m=n(2685),d=n(76833),p=n(28930),v=n(5556),f=n.n(v);function A(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(A=function(){return!!e})()}var E=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,u.A)(n),(0,o.A)(e,A()?Reflect.construct(n,r||[],(0,u.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.isLoading,n=e.children;return l.createElement(s.default,(0,r.A)({id:"Loader.layout"},this.props),t?l.createElement(m.A,{className:"loader-container"},l.createElement(d.A,{active:!0,inverted:!0},l.createElement(p.A,{active:!0,size:"large",inline:"centered"}))):l.createElement(l.Fragment,null,n))}}])}(l.Component);E.propTypes={isLoading:f().bool,children:f().node},E.defaultProps={isLoading:!1,children:null};const h=s.default.component("Loader",E)},2545:(e,t,n)=>{n.d(t,{Ay:()=>y,Me:()=>E});var r=n(58168),i=n(80045),a=n(5556),o=n.n(a),u=n(96540),c=n(81057),l=n(27089),s=n(98462),m=n(76217),d=["src"],p=["isActionEvent"],v=function(e){var t=e.children;return u.createElement(l.A,{className:"requests-feed-container rich-input-content ml-0-mobile mr-0-mobile"},u.createElement(s.A,null,t))};v.propTypes={children:o().node},v.defaultProps={children:null};var f=function(e){var t=e.children;return u.createElement("div",{className:"requests-event-item"},u.createElement("div",{className:"requests-event-container"},t))};f.propTypes={children:o().node},f.defaultProps={children:null};var A=function(e){var t=e.children,n=e.isEvent;return u.createElement("div",{className:"requests-event-inner-container".concat(n?" thread":"")},t)};A.propTypes={children:o().node,isEvent:o().bool},A.defaultProps={children:null,isEvent:!1};var E=function(e){var t=e.src,n=(0,i.A)(e,d);return u.createElement("div",{className:"requests-avatar-container"},t&&u.createElement(c.Image,(0,r.A)({src:t,rounded:!0,avatar:!0},n)),!t&&u.createElement(m.A,{size:"large",name:"user circle outline"}))};E.propTypes={src:o().string},E.defaultProps={src:null};var h=function(e){var t=e.name,n=e.size,r=e.color;return u.createElement("div",{className:"requests-action-event-icon"},u.createElement(m.A,{name:t,size:n,className:r}))};h.propTypes={name:o().string.isRequired,size:o().string.isRequired,color:o().string.isRequired};var g=function(e){var t=e.isActionEvent,n=(0,i.A)(e,p);return u.createElement(s.A.Event,(0,r.A)({},n,{className:t?"requests-action-event":""}))};g.propTypes={isActionEvent:o().bool},g.defaultProps={isActionEvent:!1},v.Content=A,v.Avatar=E,v.Icon=h,v.Item=f,v.Event=g;const y=v},87058:(e,t,n)=>{n.d(t,{k:()=>o});var r=n(96540),i=n(5556),a=n.n(i),o=function(e){var t=e.content;return"html"===e.format?r.createElement("span",{dangerouslySetInnerHTML:{__html:t}}):t};o.propTypes={content:a().string,format:a().string},o.defaultProps={content:"",format:""}},13254:(e,t,n)=>{n.d(t,{A:()=>q});var r=n(58168),i=n(23029),a=n(92901),o=n(56822),u=n(53954),c=n(85501),l=n(87664),s=n(96540),m=n(5556),d=n.n(m),p=n(53196),v=n(1489),f=n(61225),A=n(44641),E=n(51253),h=(0,f.connect)((function(e){return{loading:e.timeline.loading,refreshing:e.timeline.refreshing,timeline:e.timeline.data,error:e.timeline.error,isSubmitting:e.timelineCommentEditor.isLoading,size:e.timeline.size,page:e.timeline.page}}),(function(e){return{getTimelineWithRefresh:function(){return e((0,A.Zx)())},timelineStopRefresh:function(){return e((0,A.En)())},setPage:function(t){return e((0,A.Ir)(t))}}}))(E.A);function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(g=function(){return!!e})()}var y=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,u.A)(n),(0,o.A)(e,g()?Reflect.construct(n,r||[],(0,u.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.request,n=e.userAvatar,i=e.permissions;return s.createElement(p.default,(0,r.A)({id:"InvenioRequests.RequestDetails.layout"},this.props),s.createElement(v.A,{stackable:!0,reversed:"mobile"},s.createElement(v.A.Column,{mobile:16,tablet:12,computer:13},s.createElement(h,{userAvatar:n,request:t,permissions:i})),s.createElement(v.A.Column,{mobile:16,tablet:4,computer:3},s.createElement(l.A,{request:t}))))}}])}(s.Component);y.propTypes={request:d().object.isRequired,userAvatar:d().string,permissions:d().object.isRequired},y.defaultProps={userAvatar:""};const q=p.default.component("InvenioRequests.RequestDetails",y)},87664:(e,t,n)=>{n.d(t,{A:()=>w});var r=n(23029),i=n(92901),a=n(56822),o=n(53954),u=n(85501),c=n(64467),l=n(59945),s=n(5556),m=n.n(s),d=n(96540),p=n(81057),v=n(53196),f=n(76217),A=n(87395),E=n(27041),h=n(36713),g=n(89263),y=n(7763);function q(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(q=function(){return!!e})()}var R=function(e){var t,n=e.user;return d.createElement("div",{className:"flex"},d.createElement(p.Image,{src:n.links.avatar,avatar:!0,size:"tiny",className:"mr-5",ui:!1,rounded:!0}),d.createElement("span",null,(null===(t=n.profile)||void 0===t?void 0:t.full_name)||(null===n||void 0===n?void 0:n.username)||(null===n||void 0===n?void 0:n.email)||l.M.t("Anonymous user")))};R.propTypes={user:m().shape({links:m().shape({avatar:m().string.isRequired}).isRequired,profile:m().shape({full_name:m().string}),username:m().string,email:m().string}).isRequired};var C=function(e){var t=e.community;return d.createElement("div",{className:"flex"},d.createElement(p.Image,{src:t.links.logo,avatar:!0,size:"tiny",className:"mr-5",ui:!1}),d.createElement("a",{href:"/communities/".concat(t.slug)},t.metadata.title))};C.propTypes={community:m().shape({links:m().shape({logo:m().string.isRequired}).isRequired,slug:m().string.isRequired,metadata:m().shape({title:m().string.isRequired}).isRequired}).isRequired};var b=function(e){var t=e.email;return d.createElement("div",{className:"flex"},d.createElement(f.A,{name:"mail",className:"mr-5"}),d.createElement("span",null,l.M.t("Email"),": ",t.id))};b.propTypes={email:m().shape({id:m().string.isRequired}).isRequired};var k=function(e){var t=e.group;return d.createElement("div",{className:"flex"},d.createElement(f.A,{name:"group",className:"mr-5"}),d.createElement("span",null,l.M.t("Group"),": ",null===t||void 0===t?void 0:t.name))};k.propTypes={group:m().shape({name:m().string.isRequired}).isRequired};var T=function(e){var t=e.userData,n=e.details,r="community"in t,i="email"in t,a="group"in t;return"user"in t?d.createElement(R,{user:n}):r?d.createElement(C,{community:n}):i?d.createElement(b,{email:n}):a?d.createElement(k,{group:n}):null};T.propTypes={userData:m().object.isRequired,details:m().oneOfType([m().shape({links:m().shape({avatar:m().string,logo:m().string}),profile:m().shape({full_name:m().string}),username:m().string,email:m().string,slug:m().string,metadata:m().shape({title:m().string}),id:m().string,name:m().string}),m().object]).isRequired};var x=function(e){var t=e.details;return d.createElement(A.A,{negative:!0},t.metadata.title)};x.propTypes={details:m().shape({metadata:m().shape({title:m().string.isRequired}).isRequired}).isRequired};var M=function(e){function t(){var e,n,i,u;(0,r.A)(this,t);for(var l=arguments.length,s=new Array(l),m=0;m<l;m++)s[m]=arguments[m];return n=this,i=t,u=[].concat(s),i=(0,o.A)(i),e=(0,a.A)(n,q()?Reflect.construct(i,u||[],(0,o.A)(n).constructor):i.apply(n,u)),(0,c.A)(e,"isResourceDeleted",(function(e){return!0===e.is_ghost})),e}return(0,u.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e,t,n,r,i,a=this.props.request,o=null===(e=a.expanded)||void 0===e?void 0:e.created_by,u=null===(t=a.expanded)||void 0===t?void 0:t.receiver;return d.createElement(v.default,{id:"InvenioRequest.RequestMetadata.Layout",request:a},d.createElement(d.Fragment,null,void 0!==o&&d.createElement(d.Fragment,null,d.createElement(E.A,{as:"h3",size:"tiny"},l.M.t("Creator")),this.isResourceDeleted(o)?d.createElement(x,{details:o}):d.createElement(T,{userData:a.created_by,details:null===(n=a.expanded)||void 0===n?void 0:n.created_by}),d.createElement(h.A,null)),d.createElement(E.A,{as:"h3",size:"tiny"},l.M.t("Receiver")),this.isResourceDeleted(u)?d.createElement(x,{details:u}):d.createElement(T,{userData:a.receiver,details:null===(r=a.expanded)||void 0===r?void 0:r.receiver}),d.createElement(h.A,null),d.createElement(E.A,{as:"h3",size:"tiny"},l.M.t("Request type")),d.createElement(y.A,{type:a.type}),d.createElement(h.A,null),d.createElement(E.A,{as:"h3",size:"tiny"},l.M.t("Status")),d.createElement(g.A,{status:a.status}),d.createElement(h.A,null),d.createElement(E.A,{as:"h3",size:"tiny"},l.M.t("Created")),(0,p.toRelativeTime)(a.created,l.M.language),a.expires_at&&d.createElement(d.Fragment,null,d.createElement(h.A,null),d.createElement(E.A,{as:"h3",size:"tiny"},l.M.t("Expires")),(0,p.toRelativeTime)(a.expires_at,l.M.language)),"accepted"===a.status&&(null===(i=a.topic)||void 0===i?void 0:i.record)&&d.createElement(d.Fragment,null,d.createElement(h.A,null),d.createElement(E.A,{as:"h3",size:"tiny"},l.M.t("Record")),d.createElement("a",{href:"/records/".concat(a.topic.record)},a.title))))}}])}(d.Component);M.propTypes={request:m().object.isRequired};const w=v.default.component("InvenioRequests.RequestMetadata",M)},89263:(e,t,n)=>{n.d(t,{A:()=>f});var r=n(23029),i=n(92901),a=n(56822),o=n(53954),u=n(85501),c=n(96540),l=n(5556),s=n.n(l),m=n(53196),d=n(76217);function p(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(p=function(){return!!e})()}var v=function(e){function t(){return(0,r.A)(this,t),e=this,n=t,i=arguments,n=(0,o.A)(n),(0,a.A)(e,p()?Reflect.construct(n,i||[],(0,o.A)(e).constructor):n.apply(e,i));var e,n,i}return(0,u.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this.props.status;return c.createElement(m.default,{id:"RequestStatus.layout.".concat(e),status:e},c.createElement("div",null,c.createElement(d.A,{name:"bars"}),c.createElement("span",null,e)))}}])}(c.Component);v.propTypes={status:s().string.isRequired};const f=m.default.component("InvenioRequests.RequestStatus",v)},28962:(e,t,n)=>{n.d(t,{zm:()=>I,lk:()=>L,BX:()=>O,KS:()=>w,w9:()=>N,Kd:()=>S,pD:()=>M});var r=n(61225),i=n(23029),a=n(92901),o=n(56822),u=n(53954),c=n(85501),l=n(53196),s=n(82872),m=n(91343),d=n(5556),p=n.n(d),v=n(40961),f=n(96540),A=document.getElementById("request-actions"),E=function(e){var t=e.request,n=e.actionSuccessCallback;return v.createPortal(f.createElement(m.U,{request:t,actionSuccessCallback:n,size:"medium"}),A)};E.propTypes={request:p().object.isRequired,actionSuccessCallback:p().func.isRequired};const h=l.default.component("InvenioRequests.RequestActionsPortal",E);var g=n(13254),y=n(62193),q=n.n(y);function R(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(R=function(){return!!e})()}var C=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,u.A)(n),(0,o.A)(e,R()?Reflect.construct(n,r||[],(0,u.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"componentDidMount",value:function(){(0,this.props.initRequest)()}},{key:"render",value:function(){var e=this.props,t=e.request,n=e.updateRequestAfterAction,r=e.userAvatar,i=e.permissions;return f.createElement(l.default,{id:"InvenioRequest.Request.layout"},f.createElement(s.A,{isLoading:q()(t)},f.createElement(h,{request:t,actionSuccessCallback:n}),f.createElement(g.A,{request:t,userAvatar:r,permissions:i})))}}])}(f.Component);C.propTypes={request:p().object.isRequired,initRequest:p().func.isRequired,updateRequestAfterAction:p().func.isRequired,userAvatar:p().string,permissions:p().object.isRequired},C.defaultProps={userAvatar:""};const b=l.default.component("InvenioRequests.Request",C);var k=n(38325),T=n(76217),x=n(59945),M=function(){return f.createElement("div",null,f.createElement(T.A,{name:"clock outline"}),f.createElement("span",null,x.M.t("Submitted")))},w=function(){return f.createElement("div",null,f.createElement(T.A,{name:"trash"}),f.createElement("span",null,x.M.t("Deleted")))},I=function(){return f.createElement("div",null,f.createElement(T.A,{name:"check circle"}),f.createElement("span",null,x.M.t("Accepted")))},O=function(){return f.createElement("div",null,f.createElement(T.A,{name:"times"}),f.createElement("span",null,x.M.t("Declined")))},L=function(){return f.createElement("div",null,f.createElement(T.A,{name:"stop"}),f.createElement("span",null,x.M.t("Cancelled")))},N=function(){return f.createElement("div",null,f.createElement(T.A,{name:"calendar times outline"}),f.createElement("span",null,x.M.t("Expired")))},S=(0,r.connect)((function(e){return{request:e.request.data}}),(function(e){return{initRequest:function(){return e((0,k.qw)())},updateRequestAfterAction:function(t){return e((0,k.Pi)(t))}}}))(b)},38325:(e,t,n)=>{n.d(t,{H5:()=>c,Pi:()=>l,dG:()=>o,qw:()=>u});var r=n(10467),i=n(54756),a=n.n(i),o="request/INIT",u=function(){return function(){var e=(0,r.A)(a().mark((function e(t,n,r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:o,payload:r.request});case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},c=function(e){return function(){var t=(0,r.A)(a().mark((function t(n,r,i){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:o,payload:e});case 1:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},l=function(e){return function(){var t=(0,r.A)(a().mark((function t(n,r,i){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n(c(e)),window.location.reload();case 2:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()}},51253:(e,t,n)=>{n.d(t,{A:()=>ne});var r=n(58168),i=n(23029),a=n(92901),o=n(56822),u=n(53954),c=n(85501),l=n(64467),s=n(5556),m=n.n(s),d=n(96540),p=n(53196),v=n(27089),f=n(36713),A=n(51217),E=n(82872),h=n(10467),g=n(54756),y=n.n(g),q=n(48423),R=n(87395),C=n(3487),b=function(e){var t=e.contentText,n=e.action,r=e.isLoading,i=e.error,a=e.headerText,o=e.cancelButtonText,u=e.actionButtonText,c=e.open,l=e.onOpen,s=e.onClose;return d.createElement(q.A,{onClose:l,onOpen:s,open:c},d.createElement(q.A.Header,null,a),d.createElement(q.A.Content,null,t),d.createElement(q.A.Actions,null,i&&d.createElement(R.A,{negative:!0,compact:!0},i),d.createElement(C.A,{content:o,onClick:function(){return s()}}),d.createElement(C.A,{content:u,negative:!0,onClick:function(){return n()},loading:r})))};b.propTypes={contentText:m().string.isRequired,action:m().func.isRequired,isLoading:m().bool.isRequired,error:m().string,headerText:m().string.isRequired,cancelButtonText:m().string.isRequired,actionButtonText:m().string.isRequired,open:m().bool.isRequired,onOpen:m().func.isRequired,onClose:m().func.isRequired},b.defaultProps={error:""};const k=b;var T=n(59945),x=n(18292);function M(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(M=function(){return!!e})()}var w=function(e){function t(e){var n,r,a,c;return(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,u.A)(a),n=(0,o.A)(r,M()?Reflect.construct(a,c||[],(0,u.A)(r).constructor):a.apply(r,c)),(0,l.A)(n,"onDelete",(0,h.A)(y().mark((function e(){var t,r,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props,r=t.action,i=t.onClose,n.setState({isLoading:!0}),e.prev=2,e.next=5,r();case 5:n.setState({isLoading:!1,error:""}),i(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),n.setState({isLoading:!1,error:(0,x.t)(e.t0)});case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))),n.state={isLoading:!1,error:""},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.onOpen,n=e.onClose,r=e.open,i=this.state,a=i.isLoading,o=i.error;return d.createElement(k,{contentText:T.M.t("Are you sure you want to delete this comment?"),action:this.onDelete,open:r,onOpen:t,onClose:n,isLoading:a,error:o,headerText:T.M.t("Confirm"),cancelButtonText:T.M.t("Cancel"),actionButtonText:T.M.t("Delete")})}}])}(d.Component);w.propTypes={open:m().bool.isRequired,onOpen:m().func.isRequired,onClose:m().func.isRequired,action:m().func.isRequired};var I=n(95270),O=function(e){var t=e.size,n=e.page,r=e.totalLength,i=e.setPage,a=Math.ceil(r/t);return r>t?d.createElement(I.A,{totalPages:a,activePage:n,onPageChange:function(e,t){var n=t.activePage;return i(n)}}):null};O.propTypes={size:m().number,page:m().number,totalLength:m().number,setPage:m().func.isRequired},O.defaultProps={size:1,page:1,totalLength:1};var L=n(2545),N=n(61225),S=n(27985),P=n(81057),j=n(85598),z=function(e){var t=e.isLoading,n=e.commentContent,r=e.setCommentContent,i=e.error,a=e.submitComment,o=e.userAvatar;return d.createElement("div",{className:"timeline-comment-editor-container"},i&&d.createElement(R.A,{negative:!0},i),d.createElement("div",{className:"flex"},d.createElement(L.Me,{src:o,className:"tablet computer only rel-mr-1"}),d.createElement(v.A,{fluid:!0,className:"ml-0-mobile mr-0-mobile fluid-mobile"},d.createElement(P.RichEditor,{inputValue:n,onEditorChange:function(e,t){r(t.getContent())},minHeight:150}))),d.createElement("div",{className:"text-align-right rel-mt-1"},d.createElement(j.yY,{icon:"send",size:"medium",content:T.M.t("Comment"),loading:t,onClick:function(){return a(n,"html")}})))};z.propTypes={commentContent:m().string,isLoading:m().bool,setCommentContent:m().func.isRequired,error:m().string,submitComment:m().func.isRequired,userAvatar:m().string},z.defaultProps={commentContent:"",isLoading:!1,error:"",userAvatar:""};const D=z;var _=(0,N.connect)((function(e){return{isLoading:e.timelineCommentEditor.isLoading,error:e.timelineCommentEditor.error,commentContent:e.timelineCommentEditor.commentContent}}),(function(e){return{submitComment:function(t,n){return e((0,S.cC)(t,n))},setCommentContent:function(t){return e((0,S.u9)(t))}}}))(D),B=n(58309);function H(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(H=function(){return!!e})()}var F=function(e){function t(e){var n,r,a,c;return(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,u.A)(a),n=(0,o.A)(r,H()?Reflect.construct(a,c||[],(0,u.A)(r).constructor):a.apply(r,c)),(0,l.A)(n,"toggleEditMode",(function(){var e=n.state.isEditing;n.setState({isEditing:!e,error:null})})),(0,l.A)(n,"updateComment",function(){var e=(0,h.A)(y().mark((function e(t,r){var i,a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.props,a=i.updateComment,o=i.event,t){e.next=3;break}return e.abrupt("return");case 3:return n.setState({isLoading:!0}),e.prev=4,e.next=7,a({content:t,format:r,event:o});case 7:n.setState({isLoading:!1,isEditing:!1,error:null}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),n.setState({isLoading:!1,isEditing:!0,error:(0,x.t)(e.t0)});case 13:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t,n){return e.apply(this,arguments)}}()),(0,l.A)(n,"deleteComment",(0,h.A)(y().mark((function e(){var t,r,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.props,r=t.deleteComment,i=t.event,(0,t.openConfirmModal)((function(){return r({event:i})}));case 2:case"end":return e.stop()}}),e)})))),n.state={isLoading:!1,isEditing:!1,error:null},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props.event,t=this.state,n=t.isLoading,r=t.isEditing,i=t.error;return d.createElement(p.default,{id:"TimelineCommentEventControlled.layout"},d.createElement(B.kc,{updateComment:this.updateComment,deleteComment:this.deleteComment,toggleEditMode:this.toggleEditMode,isLoading:n,isEditing:r,error:i,event:e}))}}])}(d.Component);F.propTypes={event:m().object.isRequired,updateComment:m().func.isRequired,deleteComment:m().func.isRequired,openConfirmModal:m().func.isRequired};const G=p.default.component("TimelineCommentEventControlled",F);var U=n(44641),J=n(88055),W=n.n(J);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){(0,l.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=function(e){var t=e.content,n=e.format,r=e.event;return function(){var e=(0,h.A)(y().mark((function e(i,a,o){var u,c,l;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i((0,U.En)()),u=o.requestEventsApi(r.links),c=(0,x.J)(t,n),i({type:U.fI}),e.next=6,u.updateComment(c);case 6:return l=e.sent,i({type:U.qO,payload:X(l.data,a().timeline.data)}),i((0,U.LD)()),e.abrupt("return",l.data);case 10:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},Y=function(e){var t=e.event;return function(){var e=(0,h.A)(y().mark((function e(n,r,i){var a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n((0,U.En)()),a=i.requestEventsApi(t.links),n({type:U.fI}),e.next=5,a.deleteComment();case 5:return o=e.sent,n({type:U.qO,payload:Q(t.id,r)}),n((0,U.LD)()),e.abrupt("return",o.data);case 9:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},X=function(e,t){var n=W()(t),r=n.hits.hits,i=r.findIndex((function(t){return t.id===e.id}));return r[i]=e,n},Q=function(e,t){var n=W()(t().timeline.data),r=n.hits.hits,i=r.findIndex((function(t){return t.id===e})),a=r[i],o={content:T.M.t("deleted a comment"),event:"comment_deleted",format:"html"};return r[i]=Z(Z({},a),{},{type:"L",payload:o}),n},$=(0,N.connect)(null,(function(e){return{updateComment:function(){var t=(0,h.A)(y().mark((function t(n){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e(K(n)));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),deleteComment:function(){var t=(0,h.A)(y().mark((function t(n){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e(Y(n)));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}))(G);n(2543);function ee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ee=function(){return!!e})()}var te=function(e){function t(e){var n,r,a,c;return(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,u.A)(a),n=(0,o.A)(r,ee()?Reflect.construct(a,c||[],(0,u.A)(r).constructor):a.apply(r,c)),(0,l.A)(n,"onOpenModal",(function(e){n.setState({modalOpen:!0,modalAction:e})})),n.state={modalOpen:!1,modalAction:null},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"componentDidMount",value:function(){(0,this.props.getTimelineWithRefresh)()}},{key:"componentDidUpdate",value:function(e){var t,n,r,i,a=this.props.timeline,o=(null===a||void 0===a||null===(t=a.hits)||void 0===t?void 0:t.total)>0,u=(null===(n=e.timeline)||void 0===n||null===(n=n.hits)||void 0===n?void 0:n.total)!==(null===a||void 0===a||null===(r=a.hits)||void 0===r?void 0:r.total);o&&u&&(null===(i=window.MathJax)||void 0===i||i.typeset())}},{key:"componentWillUnmount",value:function(){(0,this.props.timelineStopRefresh)()}},{key:"render",value:function(){var e,t,n=this,i=this.props,a=i.timeline,o=i.loading,u=i.error,c=i.setPage,l=i.size,s=i.page,m=i.userAvatar,h=i.request,g=i.permissions,y=this.state,q=y.modalOpen,R=y.modalAction;return d.createElement(E.A,{isLoading:o},d.createElement(A.A,{error:u},d.createElement(p.default,(0,r.A)({id:"TimelineFeed.layout"},this.props),d.createElement(v.A,{id:"requests-timeline",className:"ml-0-mobile mr-0-mobile"},d.createElement(p.default,{id:"TimelineFeed.header",request:h,permissions:g}),d.createElement(L.Ay,null,null===(e=a.hits)||void 0===e?void 0:e.hits.map((function(e){return d.createElement($,{key:e.id,event:e,openConfirmModal:n.onOpenModal})}))),d.createElement(f.A,{fitted:!0}),d.createElement(v.A,{textAlign:"center",className:"mb-15 mt-15"},d.createElement(O,{page:s,size:l,setPage:c,totalLength:null===(t=a.hits)||void 0===t?void 0:t.total})),d.createElement(_,{userAvatar:m}),d.createElement(w,{open:q,action:R,onOpen:function(){return n.setState({modalOpen:!0})},onClose:function(){return n.setState({modalOpen:!1})}})))))}}])}(d.Component);te.propTypes={getTimelineWithRefresh:m().func.isRequired,timelineStopRefresh:m().func.isRequired,timeline:m().object,error:m().object,isSubmitting:m().bool,setPage:m().func.isRequired,page:m().number,size:m().number,userAvatar:m().string,request:m().object.isRequired,permissions:m().object.isRequired,loading:m().bool.isRequired},te.defaultProps={timeline:null,error:null,isSubmitting:!1,page:1,size:10,userAvatar:""};const ne=p.default.component("TimelineFeed",te)},44641:(e,t,n)=>{n.d(t,{C3:()=>d,En:()=>q,Ir:()=>E,LD:()=>y,Zx:()=>g,fI:()=>p,fJ:()=>v,m3:()=>s,qO:()=>m});var r=n(10467),i=n(23029),a=n(92901),o=n(64467),u=n(54756),c=n.n(u),l=n(38325),s="timeline/IS_LOADING",m="timeline/SUCCESS",d="timeline/HAS_ERROR",p="timeline/REFRESHING",v="timeline/CHANGE_PAGE",f=function(){return(0,a.A)((function e(){(0,i.A)(this,e)}),null,[{key:"setIntervalId",value:function(e){this.intervalId=e}},{key:"resetInterval",value:function(){clearInterval(this.intervalId),delete this.intervalId}}])}();(0,o.A)(f,"IntervalId",void 0);var A=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(){var t=(0,r.A)(c().mark((function t(n,r,i){var a,o,u,v,f,A,E,h,g;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r(),o=a.timeline,u=o.size,v=o.page,f=o.data,e&&n({type:s}),n({type:p}),t.prev=4,t.next=7,i.requestsApi.getTimeline({size:u,page:v,sort:"oldest"});case 7:if(h=t.sent,!((null===(A=h.data)||void 0===A||null===(A=A.hits)||void 0===A?void 0:A.total)>(null===f||void 0===f||null===(E=f.hits)||void 0===E?void 0:E.total))){t.next=16;break}if(!h.data.hits.hits.some((function(e){var t;return"L"===e.type&&i.requestsApi.availableRequestStatuses.includes(null===e||void 0===e||null===(t=e.payload)||void 0===t?void 0:t.event)}))){t.next=16;break}return t.next=14,i.requestsApi.getRequest();case 14:g=t.sent,n((0,l.H5)(g.data));case 16:n({type:m,payload:h.data}),t.next=22;break;case 19:t.prev=19,t.t0=t.catch(4),n({type:d,payload:t.t0});case 22:case"end":return t.stop()}}),t,null,[[4,19]])})));return function(e,n,r){return t.apply(this,arguments)}}()},E=function(e){return function(){var t=(0,r.A)(c().mark((function t(n,r,i){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:v,payload:e}),t.next=3,n(A());case 3:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},h=function(e,t,n){var r=t(),i=r.timeline,a=i.loading,o=i.refreshing,u=i.error,c=r.timelineCommentEditor.isLoading;u&&e(q()),a&&o&&c||e(A(!1))},g=function(){return function(){var e=(0,r.A)(c().mark((function e(t,n,r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t(A(!0)),t(y());case 2:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},y=function(){return function(){var e=(0,r.A)(c().mark((function e(t,n,r){var i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f.intervalId||(i=setInterval((function(){return h(t,n)}),r.refreshIntervalMs),f.setIntervalId(i));case 2:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},q=function(){return function(e,t,n){f.resetInterval()}}},27985:(e,t,n)=>{n.d(t,{C3:()=>d,cC:()=>A,l4:()=>v,m3:()=>m,qO:()=>p,u9:()=>f});var r=n(45458),i=n(10467),a=n(54756),o=n.n(a),u=n(18292),c=n(44641),l=n(88055),s=n.n(l),m="eventEditor/IS_LOADING",d="eventEditor/HAS_ERROR",p="eventEditor/SUCCESS",v="eventEditor/SETTING_CONTENT",f=function(e){return function(){var t=(0,i.A)(o().mark((function t(n,r,i){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:v,payload:e});case 1:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},A=function(e,t){return function(){var n=(0,i.A)(o().mark((function n(r,i,a){var l,s,v,f,A,h,g,y;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return l=i(),s=l.timeline,r((0,c.En)()),r({type:m}),v=(0,u.J)(e,t||"html"),n.prev=4,n.next=7,a.requestsApi.submitComment(v);case 7:return f=n.sent,A=s.page,h=s.size,g=s.data.hits.hits.length,(y=g+1>h)&&r({type:c.fJ,payload:A+1}),r({type:p}),n.next=16,r({type:c.qO,payload:E(f.data,s,y)});case 16:r((0,c.LD)()),n.next=24;break;case 19:throw n.prev=19,n.t0=n.catch(4),r({type:d,payload:(0,u.t)(n.t0)}),r((0,c.LD)()),n.t0;case 24:case"end":return n.stop()}}),n,null,[[4,19]])})));return function(e,t,r){return n.apply(this,arguments)}}()},E=function(e,t,n){var i=s()(t.data),a=i.hits.hits;return i.hits.hits=n?[e]:[].concat((0,r.A)(a),[e]),i.hits.total++,i}},43977:(e,t,n)=>{n.d(t,{A:()=>k});var r=n(23029),i=n(92901),a=n(56822),o=n(53954),u=n(85501),c=n(64467),l=n(59945),s=n(5556),m=n.n(s),d=n(96540),p=n(81057),v=n(53196),f=n(76217),A=n(98462),E=n(34667),h=n(27089),g=n(85598),y=n(51217),q=n(2545),R=n(87058);function C(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(C=function(){return!!e})()}var b=function(e){function t(e){var n,i,u,l,s;(0,r.A)(this,t),u=this,l=t,s=[e],l=(0,o.A)(l),i=(0,a.A)(u,C()?Reflect.construct(l,s||[],(0,o.A)(u).constructor):l.apply(u,s)),(0,c.A)(i,"eventToType",(function(e){var t=e.type,n=e.payload;switch(t){case"L":return(null===n||void 0===n?void 0:n.event)||"unknown";case"C":return"comment";default:return"unknown"}}));var m=e.event;return i.state={commentContent:null===m||void 0===m||null===(n=m.payload)||void 0===n?void 0:n.content},i}return(0,u.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e,t,n,r,i,a,o,u,c=this,s=this.props,m=s.isLoading,C=s.isEditing,b=s.error,k=s.event,T=s.updateComment,x=s.deleteComment,M=s.toggleEditMode,w=this.state.commentContent,I=(null===k||void 0===k?void 0:k.revision_id)>1&&(null===k||void 0===k?void 0:k.payload),O=null===k||void 0===k||null===(e=k.permissions)||void 0===e?void 0:e.can_delete_comment,L=null===k||void 0===k||null===(t=k.permissions)||void 0===t?void 0:t.can_update_comment,N=k.created_by,S="user"in N,P="email"in N,j=null===(n=k.expanded)||void 0===n?void 0:n.created_by,z=null;S?(o=d.createElement(q.Ay.Avatar,{src:j.links.avatar,as:p.Image,circular:!0}),z=(null===(u=j.profile)||void 0===u?void 0:u.full_name)||j.username):P&&(o=d.createElement(f.A,{size:"large",name:"user circle outline"}),z=N.email);return d.createElement(v.default,{id:"TimelineEvent.layout.".concat(this.eventToType(k)),event:k},d.createElement(q.Ay.Item,null,d.createElement(q.Ay.Content,null,o,d.createElement(q.Ay.Event,null,d.createElement(A.A.Content,null,(O||L)&&d.createElement(E.A,{icon:"ellipsis horizontal",className:"right-floated",direction:"left","aria-label":l.M.t("Actions")},d.createElement(E.A.Menu,null,L&&d.createElement(E.A.Item,{onClick:function(){return M()}},l.M.t("Edit")),O&&d.createElement(E.A.Item,{onClick:function(){return x()}},l.M.t("Delete")))),d.createElement(A.A.Summary,null,d.createElement("b",null,z),d.createElement(A.A.Date,null,l.M.t("commented {{commentTime}}",{commentTime:(0,p.toRelativeTime)(k.created,l.M.language)}))),d.createElement(A.A.Extra,{text:!C},b&&d.createElement(y.A,{error:b}),C?d.createElement(p.RichEditor,{initialValue:null===k||void 0===k||null===(r=k.payload)||void 0===r?void 0:r.content,inputValue:w,onEditorChange:function(e,t){c.setState({commentContent:t.getContent()})},minHeight:150}):d.createElement(R.k,{content:null===k||void 0===k||null===(i=k.payload)||void 0===i?void 0:i.content,format:null===k||void 0===k||null===(a=k.payload)||void 0===a?void 0:a.format}),C&&d.createElement(h.A,{fluid:!0,className:"mt-15",textAlign:"right"},d.createElement(g.Zb,{onClick:function(){return M()}}),d.createElement(g.yY,{onClick:function(){return T(w,"html")},loading:m}))),I&&d.createElement(A.A.Meta,null,l.M.t("Edited")))))))}}])}(d.Component);b.propTypes={event:m().object.isRequired,deleteComment:m().func.isRequired,updateComment:m().func.isRequired,toggleEditMode:m().func.isRequired,isLoading:m().bool,isEditing:m().bool,error:m().string},b.defaultProps={isLoading:!1,isEditing:!1,error:void 0};const k=v.default.component("TimelineEvent",b)},58309:(e,t,n)=>{n.d(t,{gW:()=>y,Ih:()=>C,jU:()=>k,Il:()=>q,kc:()=>T.A,nk:()=>R,Ow:()=>b});var r=n(23029),i=n(92901),a=n(56822),o=n(53954),u=n(85501),c=n(59945),l=n(5556),s=n.n(l),m=n(96540),d=n(81057),p=n(53196),v=n(98462),f=n(2545),A=n(87058);function E(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(E=function(){return!!e})()}var h=function(e){function t(){return(0,r.A)(this,t),e=this,n=t,i=arguments,n=(0,o.A)(n),(0,a.A)(e,E()?Reflect.construct(n,i||[],(0,o.A)(e).constructor):n.apply(e,i));var e,n,i}return(0,u.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e,t,n,r,i=this.props,a=i.event,o=i.iconName,u=i.iconColor,l=i.eventContent,s="user"in a.created_by,E=null===(e=a.expanded)||void 0===e?void 0:e.created_by,h=null;s&&(n=m.createElement(d.Image,{src:E.links.avatar,avatar:!0,size:"tiny",className:"mr-5",ui:!1}),h=(null===(r=E.profile)||void 0===r?void 0:r.full_name)||E.username);return m.createElement(p.default,{id:"TimelineActionEvent.layout",event:a,iconName:o,iconColor:u},m.createElement(f.Ay.Item,null,m.createElement(f.Ay.Content,{isEvent:!0},m.createElement(f.Ay.Icon,{name:o,size:"large",color:u}),m.createElement(f.Ay.Event,{isActionEvent:!0},m.createElement(v.A.Content,null,m.createElement(v.A.Summary,{className:"flex"},n,m.createElement("b",null,h),m.createElement(v.A.Date,null,m.createElement(A.k,{content:l,format:null===a||void 0===a||null===(t=a.payload)||void 0===t?void 0:t.format})," ",(0,d.toRelativeTime)(a.created,c.M.language))))))))}}])}(m.Component);h.propTypes={event:s().object.isRequired,iconName:s().string.isRequired,eventContent:s().string.isRequired,iconColor:s().string},h.defaultProps={iconColor:"grey"};const g=p.default.component("TimelineActionEvent",h);var y=function(e){var t=e.event;return m.createElement(g,{iconName:"check circle",iconColor:"positive",event:t,eventContent:c.M.t("accepted this request")})};y.propTypes={event:s().object.isRequired};var q=function(e){var t=e.event;return m.createElement(g,{iconName:"close",event:t,eventContent:c.M.t("declined this request"),iconColor:"negative"})};q.propTypes={event:s().object.isRequired};var R=function(e){var t=e.event;return m.createElement(g,{iconName:"calendar times",event:t,eventContent:c.M.t("this request expired"),iconColor:"negative"})};R.propTypes={event:s().object.isRequired};var C=function(e){var t=e.event;return m.createElement(g,{iconName:"close",event:t,eventContent:c.M.t("cancelled this request"),iconColor:"negative"})};C.propTypes={event:s().object.isRequired};var b=function(e){var t=e.event;return m.createElement(g,{iconName:"close",iconColor:"negative",event:t,eventContent:c.M.t("unknown event")})};b.propTypes={event:s().object.isRequired};var k=function(e){var t=e.event;return m.createElement(g,{iconName:"erase",iconColor:"grey",event:t,eventContent:c.M.t("deleted a comment")})};k.propTypes={event:s().object.isRequired};var T=n(43977)}}]);
//# sourceMappingURL=8962.1233fea20bc7af86336e.js.map