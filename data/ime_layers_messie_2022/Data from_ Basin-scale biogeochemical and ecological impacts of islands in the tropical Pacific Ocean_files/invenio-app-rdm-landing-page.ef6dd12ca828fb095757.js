(self.webpackChunkinvenio_assets=self.webpackChunkinvenio_assets||[]).push([[5115],{53952:(e,t,n)=>{"use strict";n.d(t,{J:()=>c});var r=n(64467),o=n(58156),a=n.n(o);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var c=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},{restore:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id";return"/api/users/".concat(a()(e,t),"/restore")},block:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id";return"/api/users/".concat(a()(e,t),"/block")},approve:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id";return"/api/users/".concat(a()(e,t),"/approve")},activate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id";return"/api/users/".concat(a()(e,t),"/activate")},deactivate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id";return"/api/users/".concat(a()(e,t),"/deactivate")},impersonate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id";return"/api/users/".concat(a()(e,t),"/impersonate")}})},78927:(e,t,n)=>{"use strict";var r=n(96540),o=n(40961),a=n(23029),i=n(92901),c=n(56822),l=n(53954),s=n(85501),u=n(70742),d=n(1489),m=n(3487),p=n(76217),f=n(87395),h=n(10467),v=n(80296),g=n(54756),y=n.n(g),b=n(81057),C=n(5556),A=n.n(C),E=function(e){var t=e.recid,n=e.onError,o=(0,r.useState)(!1),a=(0,v.A)(o,2),i=a[0],c=a[1],l=function(){var e=(0,h.A)(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.prev=1,e.next=4,b.http.post("/api/records/".concat(t,"/draft"),{},{headers:{"Content-Type":"application/json",Accept:"application/vnd.inveniordm.v1+json"}});case 4:window.location="/uploads/".concat(t),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),c(!1),n(e.t0.response.data.message);case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}();return r.createElement(m.A,{fluid:!0,className:"warning",size:"medium",onClick:l,loading:i,icon:!0,labelPosition:"left"},r.createElement(p.A,{name:"edit"}),u.M.t("Edit"))};E.propTypes={recid:A().string.isRequired,onError:A().func.isRequired};var O=n(9300),R=n(93532),S=n(53196),M=n(34667),k=n(48423),w=n(53952),x=function(e){var t=e.recid,n=e.recordOwnerID;return r.createElement(M.A,{fluid:!0,text:u.M.t("Manage"),icon:"cog",floating:!0,labeled:!0,button:!0,className:"icon text-align-center"},r.createElement(M.A.Menu,null,r.createElement(M.A.Item,{as:"a",href:"/administration/records?q=id:".concat(t),target:"_blank",key:"manage_record",text:u.M.t("Manage record")}),r.createElement(M.A.Item,{as:"a",href:"/administration/users?q=id:".concat(n),target:"_blank",key:"manage_user",text:u.M.t("Manage user")}),r.createElement(M.A.Divider,null),n&&r.createElement(P,{recordOwnerID:n})))};x.propTypes={recid:A().string.isRequired,recordOwnerID:A().string.isRequired};var P=function(e){var t=e.recordOwnerID,n=r.useState(!1),o=(0,v.A)(n,2),a=o[0],i=o[1],c=function(){return i(!1)};return r.createElement(r.Fragment,null,r.createElement(M.A.Item,{as:"a",className:"error",onClick:function(){return i(!0)},key:"block_user",text:u.M.t("Block user")}),r.createElement(k.A,{open:a,closeIcon:!0,onClose:c,role:"dialog",closeOnDimmerClick:!1},r.createElement(k.A.Header,{as:"h2"},u.M.t("Block User")),r.createElement(k.A.Description,null,r.createElement(f.A,{warning:!0,icon:"warning sign",content:u.M.t("Blocking the user will delete all existing records of the user.")})),r.createElement(k.A.Actions,null,r.createElement(m.A,{onClick:function(){return c()},floated:"left"},"Cancel"),r.createElement(m.A,{size:"small",labelPosition:"left",icon:"warning",color:"red",content:u.M.t("Block"),onClick:function(){b.http.post(w.J.block({id:t})),c()}}))))};function q(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(q=function(){return!!e})()}P.propTypes={recordOwnerID:A().string.isRequired};var N=function(e){function t(e){var n,r,o,i;return(0,a.A)(this,t),r=this,o=t,i=[e],o=(0,l.A)(o),(n=(0,c.A)(r,q()?Reflect.construct(o,i||[],(0,l.A)(r).constructor):o.apply(r,i))).state={error:""},n}return(0,s.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.record,o=t.permissions,a=t.isDraft,i=t.isPreviewSubmissionRequest,c=t.currentUserId,l=t.recordOwnerID,s=t.groupsEnabled,h=this.state.error,v=n.id,g=function(t){console.error(t),e.setState({error:t})};return r.createElement(d.A,{columns:1,className:"record-management"},o.can_moderate&&r.createElement(d.A.Column,{className:"pb-5"},r.createElement(x,{recid:v,recordOwnerID:l})),o.can_edit&&!a&&r.createElement(d.A.Column,{className:o.can_manage?"pb-5 pt-5":"pb-5"},r.createElement(E,{recid:v,onError:g})),i&&a&&r.createElement(d.A.Column,{className:"pb-20"},r.createElement(m.A,{fluid:!0,className:"warning",size:"medium",onClick:function(){return window.location="/uploads/".concat(v)},icon:!0,labelPosition:"left"},r.createElement(p.A,{name:"edit"}),u.M.t("Edit"))),!i&&r.createElement(r.Fragment,null,r.createElement(d.A.Column,{className:"pt-5 pb-5"},r.createElement(R.z4,{fluid:!0,size:"medium",record:n,onError:g,disabled:!o.can_new_version})),r.createElement(d.A.Column,{className:"pt-5"},o.can_manage&&r.createElement(O.w,{disabled:!o.can_update_draft,record:n,permissions:o,groupsEnabled:s}))),r.createElement(S.default,{id:"InvenioAppRdm.RecordLandingPage.RecordManagement.container",isPreviewSubmissionRequest:i,record:n,currentUserId:c}),h&&r.createElement(d.A.Row,{className:"record-management"},r.createElement(d.A.Column,null,r.createElement(f.A,{negative:!0},h))))}}])}(r.Component);N.propTypes={record:A().object.isRequired,permissions:A().object.isRequired,isDraft:A().bool.isRequired,groupsEnabled:A().bool.isRequired,isPreviewSubmissionRequest:A().bool.isRequired,currentUserId:A().string.isRequired,recordOwnerID:A().string.isRequired};var j=n(58168),D=n(58156),I=n.n(D),T=n(27859),_=n(24941),B=n(36713),U=n(52822),L=function(e){return{id:e.id,parent:e.parent,parent_id:e.parent.id,publication_date:e.ui.publication_date_l10n_medium,version:e.ui.version,links:e.links,pids:e.pids,new_draft_parent_doi:e.ui.new_draft_parent_doi}},J=function(e){var t=e.item,n=e.activeVersion,o=I()(t.pids,"doi.identifier","");return r.createElement(T.A.Item,(0,j.A)({key:t.id},n&&{className:"version active"}),r.createElement(T.A.Content,{floated:"left"},n?r.createElement("span",{className:"text-break"},u.M.t("Version {{- version}}",{version:t.version})):r.createElement("a",{href:"/records/".concat(t.id),className:"text-break"},u.M.t("Version {{- version}}",{version:t.version})),o&&r.createElement("a",{href:"https://doi.org/".concat(o),className:"doi"+(n?" text-muted-darken":" text-muted")},o)),r.createElement(T.A.Content,{floated:"right"},r.createElement("small",{className:n?"text-muted-darken":"text-muted"},t.publication_date)))};J.propTypes={item:A().object.isRequired,activeVersion:A().bool.isRequired};var z=function(){return r.createElement(f.A,{info:!0,className:"no-border-radius m-0"},r.createElement(f.A.Header,null,r.createElement(p.A,{name:"eye"}),u.M.t("Preview")),r.createElement("p",null,u.M.t("Only published versions are displayed.")))},F=function(e){var t,n=e.record,o=e.isPreview,a=L(n),i=null===a||void 0===a||null===(t=a.parent)||void 0===t||null===(t=t.pids)||void 0===t||null===(t=t.doi)||void 0===t?void 0:t.identifier,c=null===a||void 0===a?void 0:a.new_draft_parent_doi,l=a.id,s=(0,r.useState)(!0),m=(0,v.A)(s,2),p=m[0],f=m[1],g=(0,r.useState)(null),C=(0,v.A)(g,2),A=C[0],E=C[1],O=(0,r.useState)(!1),R=(0,v.A)(O,2),S=R[0],M=R[1],k=(0,r.useState)({}),w=(0,v.A)(k,2),x=w[0],P=w[1];(0,r.useEffect)((function(){var e=function(){var e=(0,h.A)(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.http.get("".concat(a.links.versions,"?size=").concat(5,"&sort=version&allversions=true"),{headers:{Accept:"application/vnd.inveniordm.v1+json"},withCredentials:!0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=(0,b.withCancel)(e());function n(){return n=(0,h.A)(y().mark((function e(){var n,r,o,a;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.promise;case 3:n=e.sent,r=n.data.hits,o=r.hits,a=r.total,o=o.map(L),M(o.some((function(e){return e.id===l}))),P({hits:o,total:a}),f(!1),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),"UNMOUNTED"!==e.t0&&(E(u.M.t("An error occurred while fetching the versions.")),f(!1));case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),n.apply(this,arguments)}return function(){n.apply(this,arguments)}(),function(){null===t||void 0===t||t.cancel()}}),[a.links.versions,l]);return p?o?r.createElement(z,null):r.createElement(r.Fragment,null,r.createElement("div",{className:"rel-p-1"}),r.createElement(_.A,{className:"rel-ml-1 rel-mr-1"},r.createElement(_.A.Header,null,r.createElement(_.A.Line,null),r.createElement(_.A.Line,null),r.createElement(_.A.Line,null)))):A?r.createElement(b.ErrorMessage,{className:"rel-mr-1 rel-ml-1",content:u.M.t(A),negative:!0}):r.createElement(T.A,{divided:!0},o?r.createElement(z,null):null,x.hits.map((function(e){return r.createElement(J,{key:e.id,item:e,activeVersion:e.id===l})})),!S&&r.createElement(r.Fragment,null,r.createElement(B.A,{horizontal:!0},"..."),r.createElement(J,{item:a,activeVersion:!0})),x.total>1&&r.createElement(d.A,{className:"mt-0"},r.createElement(d.A.Row,{centered:!0},r.createElement("a",{href:"/search?q=parent.id:".concat(a.parent_id,"&sort=version&f=allversions:true"),className:"font-small"},u.M.t("View all {{count}} versions",{count:x.total})))),i?r.createElement(T.A.Item,{className:"parent-doi pr-0"},r.createElement(T.A.Content,{floated:"left"},r.createElement(U.x,null,r.createElement("p",{className:"text-muted"},r.createElement("strong",null,"Cite all versions?")," You can cite all versions by using the DOI"," ",r.createElement("a",{href:a.links.parent_doi},i),". This DOI represents all versions, and will always resolve to the latest one. ",r.createElement("a",{href:"/help/versioning"},"Read more"),".")))):c?r.createElement(T.A.Item,{className:"parent-doi pr-0"},r.createElement(T.A.Content,{floated:"left"},r.createElement(U.x,null,r.createElement("p",{className:"text-muted"},r.createElement("strong",null,"Cite all versions?")," You can cite all versions by using the DOI ",c,". The DOI is registered when the first version is published. ",r.createElement("a",{href:"/help/versioning"},"Read more"),".")))):null)};F.propTypes={record:A().object.isRequired,isPreview:A().bool.isRequired};var H=n(64467),V=n(38221),W=n.n(V),K=n(14425),G=n.n(K),Q=n(93682),Y=n(59399);function Z(e,t,n){return t=(0,l.A)(t),(0,c.A)(e,$()?Reflect.construct(t,n||[],(0,l.A)(e).constructor):t.apply(e,n))}function $(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return($=function(){return!!e})()}var X=function(e){function t(){return(0,a.A)(this,t),Z(this,t,arguments)}return(0,s.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this.props,t=e.text,n=e.onCopy,o=e.hoverState;return r.createElement(Y.CopyToClipboard,{text:t,onCopy:function(){n(t)}},r.createElement(m.A,{className:"copy",basic:!0,icon:"copy","aria-label":u.M.t("Copy to clipboard"),onMouseEnter:o,onMouseLeave:o}))}}])}(r.Component);X.propTypes={text:A().string.isRequired,onCopy:A().func.isRequired,hoverState:A().func},X.defaultProps={hoverState:null};var ee=function(e){function t(e){var n;return(0,a.A)(this,t),n=Z(this,t,[e]),(0,H.A)(n,"onCopy",(function(){n.setState((function(){return{confirmationPopupIsOpen:!0,confirmationPopupMsg:u.M.t("Copied!")}})),n.delayClosePopup()})),(0,H.A)(n,"delayClosePopup",(function(){var e=setTimeout((function(){n.setState(n.INITIAL_STATE)}),1500);n.setState({stateReset:e})})),(0,H.A)(n,"hoverStateHandler",(function(e){e.persist(),"mouseenter"===e.type&&n.setState({hoverPopupIsOpen:!0}),"mouseleave"===e.type&&n.setState({hoverPopupIsOpen:!1})})),n.INITIAL_STATE={confirmationPopupIsOpen:!1,confirmationPopupMsg:"",hoverPopupIsOpen:!1,stateReset:null},n.state=n.INITIAL_STATE,n}return(0,s.A)(t,e),(0,i.A)(t,[{key:"componentWillUnmount",value:function(){var e=this.state.stateReset;e&&clearTimeout(e)}},{key:"render",value:function(){var e=this.props,t=e.text,n=e.popUpPosition,o=this.state,a=o.confirmationPopupMsg,i=o.confirmationPopupIsOpen,c=o.hoverPopupIsOpen;return t&&r.createElement(Q.A,{role:"alert",open:c||i,content:a||u.M.t("Copy to clipboard"),inverted:!!a,position:n,size:"mini",trigger:r.createElement(X,{text:t,onCopy:this.onCopy,hoverState:this.hoverStateHandler})})}}])}(r.Component);function te(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(te=function(){return!!e})()}ee.propTypes={popUpPosition:A().string,text:A().string},ee.defaultProps={popUpPosition:"right center",text:""};var ne=function(e){function t(e){var n,o,i,s;return(0,a.A)(this,t),o=this,i=t,s=[e],i=(0,l.A)(i),n=(0,c.A)(o,te()?Reflect.construct(i,s||[],(0,l.A)(o).constructor):i.apply(o,s)),(0,H.A)(n,"placeholderLoader",(function(){return r.createElement(_.A,null,r.createElement(_.A.Paragraph,null,r.createElement(_.A.Line,null),r.createElement(_.A.Line,null),r.createElement(_.A.Line,null)))})),(0,H.A)(n,"errorMessage",(function(e){return r.createElement(f.A,{negative:!0},e)})),(0,H.A)(n,"fetchCitation",function(){var e=(0,h.A)(y().mark((function e(t,n,r){var o,a;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=!0===r?"&include_deleted=1":"",a="".concat(t.links.self,"?locale=").concat(navigator.language,"&style=").concat(n).concat(o),e.next=4,b.http.get(a,{headers:{Accept:"text/x-bibliography"}});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),(0,H.A)(n,"getCitation",function(){var e=(0,h.A)(y().mark((function e(t,r,o){var a;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({loading:!0,citation:"",error:""}),n.cancellableFetchCitation=(0,b.withCancel)(n.fetchCitation(t,r,o)),e.prev=2,e.next=5,n.cancellableFetchCitation.promise;case 5:a=e.sent,n.setState({loading:!1,citation:a.data}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),"UNMOUNTED"!==e.t0&&n.setState({loading:!1,citation:"",error:u.M.t("An error occurred while generating the citation.")});case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,n,r){return e.apply(this,arguments)}}()),n.state={loading:!0,citation:"",error:null},n}return(0,s.A)(t,e),(0,i.A)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.record,n=e.defaultStyle,r=e.includeDeleted;this.getCitation(t,n,r)}},{key:"componentWillUnmount",value:function(){var e;null===(e=this.cancellableFetchCitation)||void 0===e||e.cancel()}},{key:"render",value:function(){var e=this,t=this.props,n=t.styles,o=t.record,a=t.defaultStyle,i=t.includeDeleted,c=this.state,l=c.loading,s=c.citation,d=c.error,m=n.map((function(e){return{key:e[0],value:e[0],text:e[1]}})),p=G()(s).replace(/(https?:\/\/[^\s,;]+(?=[^\s,;]*))/g,(function(e){var t="";return e.endsWith(".")&&(t=".",e=e.slice(0,-1)),'<a href="'.concat(e,'" target="_blank">').concat(e,"</a>").concat(t)}));return r.createElement("div",null,r.createElement("div",{id:"citation-text",className:"wrap-overflowing-text rel-mb-2"},l?this.placeholderLoader():r.createElement("div",{dangerouslySetInnerHTML:{__html:p}})),r.createElement("div",{className:"auto-column-grid no-wrap"},r.createElement("div",{className:"flex align-items-center"},r.createElement("label",{id:"citation-style-label",className:"mr-10"},u.M.t("Style")),r.createElement(M.A,{className:"citation-dropdown","aria-labelledby":"citation-style-label",defaultValue:a,options:m,selection:!0,onChange:W()((function(t,n){return e.getCitation(o,n.value,i)}),500)})),r.createElement(ee,{text:s})),d?this.errorMessage(d):null)}}])}(r.Component);function re(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(re=function(){return!!e})()}ne.propTypes={styles:A().array.isRequired,record:A().object.isRequired,defaultStyle:A().string.isRequired,includeDeleted:A().bool.isRequired};var oe=function(e){function t(e){var n,r,o,i,s;(0,a.A)(this,t),o=this,i=t,s=[e],i=(0,l.A)(i);var u=(r=(0,c.A)(o,re()?Reflect.construct(i,s||[],(0,l.A)(o).constructor):i.apply(o,s))).props.formats;return r.state={selectedFormatUrl:null===(n=u[0])||void 0===n?void 0:n.export_url},r}return(0,s.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this,t=this.props.formats,n=this.state.selectedFormatUrl,o=t.map((function(e,t){return{key:"option-".concat(t),text:e.name,value:e.export_url}}));return r.createElement(d.A,null,r.createElement(d.A.Column,{width:11},r.createElement(M.A,{"aria-label":u.M.t("Export selection"),selection:!0,fluid:!0,selectOnNavigation:!1,options:o,onChange:function(t,n){return e.setState({selectedFormatUrl:n.value})},defaultValue:n})),r.createElement(d.A.Column,{width:5,className:"pl-0"},r.createElement(m.A,{as:"a",role:"button",fluid:!0,href:n,title:u.M.t("Download file")},u.M.t("Export"))))}}])}(r.Component);oe.propTypes={formats:A().array.isRequired};var ae=n(27041),ie=n(50363);function ce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ce=function(){return!!e})()}var le=function(e){function t(e){var n,o,i,s;return(0,a.A)(this,t),o=this,i=t,s=[e],i=(0,l.A)(i),n=(0,c.A)(o,ce()?Reflect.construct(i,s||[],(0,l.A)(o).constructor):i.apply(o,s)),(0,H.A)(n,"openConfirmModal",(function(){return n.setState({modalOpen:!0})})),(0,H.A)(n,"closeConfirmModal",(function(){return n.setState(n.INITIAL_STATE)})),(0,H.A)(n,"handleDelete",(0,h.A)(y().mark((function e(){var t,r,o,a,i,c;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props,r=t.result,o=t.recordCommunityEndpoint,a=t.successCallback,n.setState({loading:!0}),i={communities:[{id:r.id}]},e.prev=3,e.next=6,b.http.delete(o,{data:i});case 6:c=e.sent,a(c.data),n.closeConfirmModal(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),n.setState({error:e.t0,loading:!1});case 14:case"end":return e.stop()}}),e,null,[[3,11]])})))),(0,H.A)(n,"handleCheckboxChange",(function(e,t){var r=t.id,o=t.checked,a=n.state,i=a.checkboxRecords,c=a.checkboxMembers;"members-confirm"===r&&n.setState({checkboxMembers:o,buttonDisabled:!(o&&i)}),"records-confirm"===r&&n.setState({checkboxRecords:o,buttonDisabled:!(c&&o)})})),n.INITIAL_STATE={modalOpen:!1,loading:!1,error:void 0,checkboxMembers:!1,checkboxRecords:!1,buttonDisabled:!0},n.state=n.INITIAL_STATE,n.checkBoxRef=r.createRef(),n}return(0,s.A)(t,e),(0,i.A)(t,[{key:"componentDidUpdate",value:function(){if(this.state.modalOpen&&this.checkBoxRef){var e,t=this.checkBoxRef.current.inputRef;null===t||void 0===t||null===(e=t.current)||void 0===e||e.focus()}}},{key:"render",value:function(){var e,t=this,n=this.state,o=n.modalOpen,a=n.loading,i=n.error,c=n.checkboxMembers,l=n.checkboxRecords,s=n.buttonDisabled,d=this.props.result.metadata.title;return r.createElement(r.Fragment,null,r.createElement(m.A,{size:"tiny",negative:!0,labelPosition:"left",icon:"trash",floated:"right",onClick:this.openConfirmModal,content:u.M.t("Remove"),"aria-label":u.M.t("Remove {{communityTitle}} from this record",{communityTitle:d})}),r.createElement(k.A,{size:"tiny",dimmer:"blurring",open:o},r.createElement(k.A.Header,{as:"h2"},u.M.t("Remove community")),r.createElement(k.A.Content,null,r.createElement("p",null,u.M.t("Are you sure you want to remove the record from the community?")),r.createElement(f.A,{negative:!0},r.createElement(f.A.Header,{className:"rel-mb-1"},r.createElement(p.A,{name:"warning sign",className:"rel-mr-1"}),u.M.t("I understand the consequences:")),r.createElement(r.Fragment,null,r.createElement(ie.A,{ref:this.checkBoxRef,id:"members-confirm",label:r.createElement("label",null,r.createElement(U.x,null,"Members of the community ",r.createElement("b",null,'"',{communityTitle:d},'"')," will"," ",r.createElement("u",null,"lose their access")," to the record.")),checked:c,onChange:this.handleCheckboxChange,className:"mb-5"}),r.createElement(ie.A,{id:"records-confirm",label:u.M.t("The record can only be re-included in the community by going through a new review by the community curators."),checked:l,onChange:this.handleCheckboxChange,className:"mb-5"})))),r.createElement(k.A.Actions,null,i&&r.createElement(b.ErrorMessage,{header:u.M.t("Something went wrong"),content:(null===(e=i.response)||void 0===e||null===(e=e.data)||void 0===e||null===(e=e.errors)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.message)||i.message,icon:"exclamation",className:"text-align-left",negative:!0}),r.createElement(m.A,{onClick:function(){return t.closeConfirmModal()},floated:"left",disabled:a,loading:a,"aria-label":u.M.t("Cancel removal")},u.M.t("Cancel")),r.createElement(m.A,{disabled:s||a,negative:!0,onClick:function(){return t.handleDelete()},loading:a,content:u.M.t("Remove"),"aria-label":u.M.t("Confirm removal")}))))}}])}(r.Component);le.propTypes={result:A().object.isRequired,recordCommunityEndpoint:A().object.isRequired,successCallback:A().func.isRequired};var se=n(78585);function ue(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ue=function(){return!!e})()}var de=function(e){function t(e){var n,o,i,s;return(0,a.A)(this,t),o=this,i=t,s=[e],i=(0,l.A)(i),n=(0,c.A)(o,ue()?Reflect.construct(i,s||[],(0,l.A)(o).constructor):i.apply(o,s)),(0,H.A)(n,"handleSetBranding",function(){var e=(0,h.A)(y().mark((function e(t){var r,o,a,i,c,l;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.props,o=r.recordCommunityEndpoint,a=r.updateRecordCallback,n.setState({loading:!0}),i={default:t},n.cancellableAction=(0,b.withCancel)(b.http.put(o,i)),e.prev=4,e.next=7,n.cancellableAction.promise;case 7:c=e.sent,n.setState({loading:!1}),a(c.data),e.next=18;break;case 12:if(e.prev=12,e.t0=e.catch(4),"UNMOUNTED"!==e.t0){e.next=16;break}return e.abrupt("return");case 16:console.error(e.t0),n.setState({error:(null===e.t0||void 0===e.t0||null===(l=e.t0.response)||void 0===l||null===(l=l.data)||void 0===l?void 0:l.message)||(null===e.t0||void 0===e.t0?void 0:e.t0.message),loading:!1});case 18:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}()),(0,H.A)(n,"renderCommunity",(function(){var e=n.state.loading,t=n.props,o=t.result,a=t.isCommunityDefault,i=o.metadata.title;return a?r.createElement(Q.A,{trigger:r.createElement(m.A,{size:"tiny",labelPosition:"left",icon:"paint brush",floated:"right",onClick:function(){return n.handleSetBranding(null)},content:u.M.t("Remove branding"),"aria-label":u.M.t("{{communityTitle}} is a default branding for this record",{communityTitle:i}),loading:e}),content:u.M.t("Remove this community from appearing on top of the record details page."),position:"top center"}):r.createElement(Q.A,{trigger:r.createElement(m.A,{size:"tiny",labelPosition:"left",icon:"paint brush",floated:"right",onClick:function(){return n.handleSetBranding(o.id)},content:u.M.t("Set branding"),"aria-label":u.M.t("Set {{communityTitle}} as a default branding for this record",{communityTitle:i}),loading:e}),content:u.M.t("Set this community to appear on the top of the record details page."),position:"top center"})})),n.state={loading:!1,error:void 0},n}return(0,s.A)(t,e),(0,i.A)(t,[{key:"componentWillUnmount",value:function(){this.cancellableAction&&this.cancellableAction.cancel()}},{key:"render",value:function(){var e=this.state.error;return e?r.createElement(f.A,{negative:!0,floated:"right",className:"community-branding-error",size:"tiny"},e):this.renderCommunity()}}])}(r.Component);function me(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(me=function(){return!!e})()}de.propTypes={result:A().object.isRequired,recordCommunityEndpoint:A().object.isRequired,updateRecordCallback:A().func.isRequired,isCommunityDefault:A().bool.isRequired};var pe=function(e){function t(){return(0,a.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,c.A)(e,me()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,s.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e,t=this.props,n=t.result,o=t.successCallback,a=t.updateRecordCallback,i=t.recordCommunityEndpoint,c=t.recordParent,l=t.permissions.can_manage,s=(null===c||void 0===c||null===(e=c.communities)||void 0===e?void 0:e.default)===(null===n||void 0===n?void 0:n.id),u=l&&r.createElement(r.Fragment,null,r.createElement(de,{result:n,recordCommunityEndpoint:i,updateRecordCallback:a,isCommunityDefault:s}),r.createElement(le,{result:n,recordCommunityEndpoint:i,successCallback:o}));return r.createElement(se.mG,{actions:u,result:n,isCommunityDefault:s})}}])}(r.Component);pe.propTypes={result:A().object.isRequired,recordCommunityEndpoint:A().string.isRequired,successCallback:A().func.isRequired,updateRecordCallback:A().func.isRequired,permissions:A().object.isRequired,recordParent:A().object.isRequired};var fe=n(98871);function he(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(he=function(){return!!e})()}var ve="InvenioAppRdm.RecordCommunitiesSearch",ge=function(e){function t(){var e,n,r,o;(0,a.A)(this,t);for(var i=arguments.length,s=new Array(i),d=0;d<i;d++)s[d]=arguments[d];return n=this,r=t,o=[].concat(s),r=(0,l.A)(r),e=(0,c.A)(n,he()?Reflect.construct(r,o||[],(0,l.A)(n).constructor):r.apply(n,o)),(0,H.A)(e,"handleSuccessCallback",(function(t){(0,e.props.successActionCallback)(t,u.M.t("Success"))})),e}return(0,s.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this.props,t=e.recordCommunityEndpoint,n=e.permissions,o=e.recordParent,a=e.updateRecordCallback,i=(0,H.A)({},"".concat(ve,".ResultsList.item"),(0,S.parametrize)(pe,{recordCommunityEndpoint:t,successCallback:this.handleSuccessCallback,updateRecordCallback:a,permissions:n,recordParent:o})),c=new fe.HZ({axios:{url:t,headers:{Accept:"application/vnd.inveniordm.v1+json"}}});return r.createElement(S.OverridableContext.Provider,{value:i},r.createElement(fe.gz,{appName:ve,urlHandlerApi:{enabled:!1},searchApi:c,initialQueryState:{size:5,page:1}},r.createElement(r.Fragment,null,r.createElement(k.A.Content,null,r.createElement(fe.IW,{autofocus:!0,actionProps:{icon:"search",content:null,className:"search","aria-label":u.M.t("Search")},placeholder:u.M.t("Search for community...")})),r.createElement(k.A.Content,{scrolling:!0,className:"community-list-results"},r.createElement(fe.oK,null,r.createElement(fe.i6,null),r.createElement(fe.$D,null),r.createElement(fe.dy,null))),r.createElement(k.A.Content,{className:"text-align-center"},r.createElement(fe.dK,null)))))}}])}(r.Component);function ye(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ye=function(){return!!e})()}ge.propTypes={recordCommunityEndpoint:A().string.isRequired,successActionCallback:A().func.isRequired,updateRecordCallback:A().func.isRequired,permissions:A().object.isRequired,recordParent:A().object.isRequired};var be=function(e){function t(e){var n,r,o,i;(0,a.A)(this,t),r=this,o=t,i=[e],o=(0,l.A)(o),n=(0,c.A)(r,ye()?Reflect.construct(o,i||[],(0,l.A)(r).constructor):o.apply(r,i)),(0,H.A)(n,"handleRecordUpdate",(function(e){n.setState({recordParent:e})}));var s=n.props.record;return n.state={recordParent:s.parent},n}return(0,s.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this.props,t=e.recordCommunityEndpoint,n=e.modalOpen,o=e.successActionCallback,a=e.handleOnOpen,i=e.handleOnClose,c=e.trigger,l=e.permissions,s=this.state.recordParent;return r.createElement(k.A,{role:"dialog","aria-labelledby":"record-communities-header",id:"community-selection-modal",closeOnDimmerClick:!1,closeIcon:!0,open:n,onClose:i,onOpen:a,trigger:c},r.createElement(k.A.Header,null,r.createElement(ae.A,{as:"h2",size:"small",id:"record-communities-header",className:"mt-5"},u.M.t("Communities"))),r.createElement(ge,{recordCommunityEndpoint:t,successActionCallback:o,permissions:l,recordParent:s,updateRecordCallback:this.handleRecordUpdate}),r.createElement(k.A.Actions,null,r.createElement(m.A,{onClick:i},u.M.t("Close"))))}}])}(r.Component);be.propTypes={recordCommunityEndpoint:A().string.isRequired,trigger:A().object,modalOpen:A().bool,successActionCallback:A().func.isRequired,handleOnClose:A().func.isRequired,handleOnOpen:A().func.isRequired,permissions:A().object.isRequired,record:A().object.isRequired},be.defaultProps={modalOpen:!1,trigger:void 0};var Ce=n(62193),Ae=n.n(Ce),Ee=n(23848),Oe=n(98866);function Re(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Re=function(){return!!e})()}var Se=function(e){function t(){return(0,a.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,c.A)(e,Re()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,s.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this.props,t=e.communities,n=e.loading,o=e.error,a=e.maxDisplayedCommunities,i=null;if(n)i=r.createElement(_.A,null,r.createElement(_.A.Header,{image:!0},r.createElement(_.A.Line,null),r.createElement(_.A.Line,null)),r.createElement(_.A.Header,{image:!0},r.createElement(_.A.Line,null),r.createElement(_.A.Line,null)),r.createElement(_.A.Header,{image:!0},r.createElement(_.A.Line,null),r.createElement(_.A.Line,null)));else if(Ae()(t))i=r.createElement("p",null,r.createElement("i",null,r.createElement("small",null,u.M.t("This record is not included in any communities yet."))));else if((null===t||void 0===t?void 0:t.length)>0){var c=null===t||void 0===t?void 0:t.slice(0,a).map((function(e){var t;return r.createElement(d.A,{key:e.id},r.createElement(d.A.Row,{verticalAlign:"middle"},r.createElement(d.A.Column,{width:2},r.createElement(b.Image,{wrapped:!0,size:"mini",src:e.links.logo,alt:""})),r.createElement(d.A.Column,{width:14},r.createElement(Ee.A.Content,null,r.createElement(Ee.A.Header,{className:"ui"},r.createElement(ae.A,{as:"a",href:e.links.self_html,size:"small"},e.metadata.title,((null===(t=e.children)||void 0===t?void 0:t.allow)||void 0!==e.parent)&&r.createElement("p",{className:"ml-5 display-inline-block"},r.createElement(Q.A,{content:"Verified community",trigger:r.createElement(p.A,{size:"small",color:"green",name:"check circle outline"}),position:"top center"}))),e.parent&&r.createElement(Oe.A,null,"Part of"," ",r.createElement("a",{href:"/communities/".concat(e.parent.slug)},e.parent.metadata.title)))))))}));i=r.createElement(r.Fragment,null,r.createElement(Ee.A.Group,{unstackable:!0},c),o&&r.createElement(f.A,{error:!0},o))}return i}}])}(r.Component);Se.propTypes={maxDisplayedCommunities:A().number.isRequired,communities:A().array,loading:A().bool,error:A().string},Se.defaultProps={communities:void 0,loading:!1,error:""};var Me=n(2685),ke=n(27089),we=n(31827),xe=(n(2776),n(9504),n(42035),n(2115),n(91343));n(46842),n(13254),n(87664),n(51253),n(43977);function Pe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Pe=function(){return!!e})()}var qe=function(e){function t(){return(0,a.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,c.A)(e,Pe()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,s.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this.props,t=e.result,n=e.successCallback,o=t.expanded.receiver,a=t.links.self_html.replace("/requests","/me/requests"),i=r.createElement(xe.U,{request:t,actionSuccessCallback:n});return r.createElement(se.mG,{result:o,actions:i,detailUrl:a})}}])}(r.Component);function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function je(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(je=function(){return!!e})()}qe.propTypes={result:A().object.isRequired,successCallback:A().func.isRequired};var De="InvenioAppRdm.PendingCommunitiesSearch",Ie=function(e){function t(){var e,n,r,o;(0,a.A)(this,t);for(var i=arguments.length,s=new Array(i),d=0;d<i;d++)s[d]=arguments[d];return n=this,r=t,o=[].concat(s),r=(0,l.A)(r),e=(0,c.A)(n,je()?Reflect.construct(r,o||[],(0,l.A)(n).constructor):r.apply(n,o)),(0,H.A)(e,"handleSuccessCallback",(function(t){(0,e.props.successActionCallback)(t,u.M.t("Success"))})),e}return(0,s.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this.props.searchConfig,t=new fe.HZ(e.searchApi),n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(n),!0).forEach((function(t){(0,H.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}((0,H.A)({},"".concat(De,".ResultsList.item"),(0,S.parametrize)(qe,{successCallback:this.handleSuccessCallback})),we.Lu);return r.createElement(S.OverridableContext.Provider,{value:n},r.createElement(fe.gz,{appName:De,urlHandlerApi:{enabled:!1},searchApi:t,initialQueryState:e.initialQueryState},r.createElement(r.Fragment,null,r.createElement(k.A.Content,null,r.createElement(fe.IW,{autofocus:!0,actionProps:{icon:"search",content:null,className:"search","aria-label":u.M.t("Search")},placeholder:u.M.t("Search for pending submissions to communities...")})),r.createElement(k.A.Content,{scrolling:!0,className:"community-list-results"},r.createElement(fe.oK,null,r.createElement(fe.i6,null),r.createElement(fe.$D,null),r.createElement(fe.dy,null))),r.createElement(k.A.Content,{className:"text-align-center"},r.createElement(fe.dK,null)))))}}])}(r.Component);function Te(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Te=function(){return!!e})()}Ie.propTypes={searchConfig:A().object.isRequired,successActionCallback:A().func.isRequired};var _e=function(e){function t(){return(0,a.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,c.A)(e,Te()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,s.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this.props,t=e.searchConfig,n=e.modalOpen,o=e.successActionCallback,a=e.handleOnOpen,i=e.handleOnClose;return r.createElement(k.A,{role:"dialog","aria-labelledby":"record-communities-header",id:"community-selection-modal",closeIcon:!0,closeOnDimmerClick:!1,open:n,onClose:i,onOpen:a},r.createElement(k.A.Header,null,r.createElement(ae.A,{as:"h2",size:"small",id:"record-communities-header",className:"mt-5"},u.M.t("Pending communities"))),r.createElement(Ie,{searchConfig:t,successActionCallback:o}),r.createElement(k.A.Actions,null,r.createElement(m.A,{onClick:i},u.M.t("Close"))))}}])}(r.Component);function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){(0,H.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Le(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Le=function(){return!!e})()}_e.propTypes={searchConfig:A().object.isRequired,modalOpen:A().bool,successActionCallback:A().func.isRequired,handleOnClose:A().func.isRequired,handleOnOpen:A().func.isRequired},_e.defaultProps={modalOpen:!1};var Je=function(e){function t(e){var n,r,o,i;return(0,a.A)(this,t),r=this,o=t,i=[e],o=(0,l.A)(o),n=(0,c.A)(r,Le()?Reflect.construct(o,i||[],(0,l.A)(r).constructor):o.apply(r,i)),(0,H.A)(n,"changeSelectedCommunity",(function(e){n.setState({selectedCommunity:e,error:null}),n.openConfirmModal()})),(0,H.A)(n,"canIncludeDirectly",(function(){var e=n.state.selectedCommunity;return n.props.userCommunitiesMemberships[null===e||void 0===e?void 0:e.id]&&"open"===(null===e||void 0===e?void 0:e.access.review_policy)})),(0,H.A)(n,"isIncludedDirectly",(function(e){return e.is_closed&&"accepted"===e.status})),(0,H.A)(n,"handleSuccessSubmit",(function(e){var t=n.props.handleSuccessAction;n.closeConfirmModal(),n.isIncludedDirectly(e.processed[0].request)?t(e,u.M.t("Record submitted")):t(e,u.M.t("Review requested"))})),(0,H.A)(n,"submitCommunity",function(){var e=(0,h.A)(y().mark((function e(t){var r,o,a,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.props.recordCommunityEndpoint,o=n.state.selectedCommunity,n.setState({loading:!0,error:null}),e.prev=3,a={communities:[{id:o.id}]},t&&(a={communities:[{id:o.id,comment:{payload:{content:t,format:"html"}}}]}),e.next=8,b.http.post(r,a,{headers:{Accept:"application/json","Content-Type":"application/json"}});case 8:i=e.sent,n.handleSuccessSubmit(i.data),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(3),console.error(e.t0),n.setState({error:e.t0.response.data.errors[0].message});case 16:return e.prev=16,n.setState({loading:!1}),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,12,16,19]])})));return function(t){return e.apply(this,arguments)}}()),(0,H.A)(n,"openConfirmModal",(function(){return n.setState({confirmationModalOpen:!0})})),(0,H.A)(n,"closeConfirmModal",(function(){return n.setState({confirmationModalOpen:!1})})),n.state={confirmationModalOpen:!1,selectedCommunity:null,loading:!1,error:null},n}return(0,s.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.selectedCommunity,o=t.confirmationModalOpen,a=t.loading,i=t.error,c=this.props,l=c.userCommunitiesMemberships,s=c.modalOpen,d=c.toggleModal,m=c.recordUserCommunitySearchConfig,p=c.recordCommunitySearchConfig,h=c.handleClose,v=c.record,g={allCommunities:Ue(Ue({},p),{},{toggleText:u.M.t("Search in all communities")}),myCommunities:Ue(Ue({},m),{},{toggleText:u.M.t("Search in my communities")})};return r.createElement(r.Fragment,null,r.createElement(R.qE,{onCommunityChange:this.changeSelectedCommunity,chosenCommunity:n,modalOpen:s,userCommunitiesMemberships:l,onModalChange:d,modalHeader:u.M.t("Select a community"),apiConfigs:g,handleClose:h,record:v,isInitialSubmission:!1}),o&&r.createElement(R.Kd,{loading:a,errors:i&&r.createElement(f.A,{error:!0},i),isConfirmModalOpen:o,onSubmit:function(t){var n=t.reviewComment;return e.submitCommunity(n)},community:n,onClose:function(){return e.closeConfirmModal()},directPublish:this.canIncludeDirectly(),record:v}))}}])}(r.Component);Je.propTypes={modalOpen:A().bool,toggleModal:A().func.isRequired,userCommunitiesMemberships:A().object.isRequired,handleSuccessAction:A().func.isRequired,recordCommunityEndpoint:A().string.isRequired,recordCommunitySearchConfig:A().object.isRequired,recordUserCommunitySearchConfig:A().string.isRequired,handleClose:A().func.isRequired,record:A().object.isRequired},Je.defaultProps={modalOpen:!1};var ze=n(69521);function Fe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Fe=function(){return!!e})()}var He=function(e){function t(e){var n,o,i,s;return(0,a.A)(this,t),o=this,i=t,s=[e],i=(0,l.A)(i),n=(0,c.A)(o,Fe()?Reflect.construct(i,s||[],(0,l.A)(o).constructor):i.apply(o,s)),(0,H.A)(n,"focusDropdownRef",(function(){n.dropdownRef.current.ref.current.focus()})),(0,H.A)(n,"handleSuccessAction",(function(e,t){var r=n.props.actionSucceed;n.setState({actionFeedback:t,visibleSuccessAction:!1}),n.toggleSubmissionModal(!1),n.togglePendingRequestsModal(!1),n.setState({visibleSuccessAction:!0}),n.focusDropdownRef(),r()})),(0,H.A)(n,"toggleSubmissionModal",(function(e){n.setState({submissionModalOpen:e}),e||n.focusDropdownRef()})),(0,H.A)(n,"togglePendingRequestsModal",(function(e){n.setState({pendingRequestModalOpen:e}),e||n.focusDropdownRef()})),(0,H.A)(n,"handleChange",(function(e,t){var r=n.props.toggleManageCommunitiesModal;switch(t.value){case"submit-to-community":n.toggleSubmissionModal(!0);break;case"pending-submissions":n.togglePendingRequestsModal(!0);break;case"manage-communities":r(!0);break;default:return}})),n.state={submissionModalOpen:!1,pendingRequestModalOpen:!1,visibleSuccessAction:!1,actionFeedback:""},n.dropdownRef=r.createRef(),n}return(0,s.A)(t,e),(0,i.A)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.visibleSuccessAction,o=t.submissionModalOpen,a=t.actionFeedback,i=t.pendingRequestModalOpen,c=this.props,l=c.userCommunitiesMemberships,s=c.searchConfig,d=c.recordCommunitySearchConfig,m=c.recordCommunityEndpoint,f=c.recordUserCommunitySearchConfig,h=c.record,v=[{id:"submit-to-community",value:"submit-to-community",text:u.M.t("Submit to community"),icon:"plus"},{id:"pending-submissions",value:"pending-submissions",text:u.M.t("Pending submissions"),icon:"comments outline"},{id:"manage-communities",value:"manage-communities",text:u.M.t("Manage communities"),icon:"settings"}];return r.createElement(r.Fragment,null,r.createElement("div",{className:"flex align-items-baseline ml-auto rel-mr-1 green-color"},n&&r.createElement(ze.BK,{timeOutDelay:5e3,show:n,content:r.createElement("div",{role:"alert",className:"half-width sub header small text size truncated"},a)})),!h.is_draft&&r.createElement(M.A,{ref:this.dropdownRef,id:"modal-dropdown",className:"manage-menu-dropdown","aria-label":u.M.t("Community management menu dropdown"),closeOnChange:!0,direction:"left",options:v,onChange:this.handleChange,selectOnBlur:!1,selectOnNavigation:!1,value:null,trigger:r.createElement(p.A,{name:"cog",color:"grey",className:"ml-0"})}),r.createElement(Je,{modalOpen:o,userCommunitiesMemberships:l,toggleModal:this.toggleSubmissionModal,handleClose:function(){return e.toggleSubmissionModal(!1)},handleSuccessAction:this.handleSuccessAction,recordCommunityEndpoint:m,recordCommunitySearchConfig:d,recordUserCommunitySearchConfig:f,record:h}),r.createElement(_e,{modalOpen:i,handleOnOpen:function(){return e.togglePendingRequestsModal(!0)},handleOnClose:function(){return e.togglePendingRequestsModal(!1)},successActionCallback:this.handleSuccessAction,searchConfig:s}))}}])}(r.Component);function Ve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ve=function(){return!!e})()}He.propTypes={userCommunitiesMemberships:A().object.isRequired,recordCommunityEndpoint:A().string.isRequired,recordCommunitySearchConfig:A().string.isRequired,recordUserCommunitySearchConfig:A().string.isRequired,toggleManageCommunitiesModal:A().func.isRequired,actionSucceed:A().func,searchConfig:A().object.isRequired,record:A().object.isRequired},He.defaultProps={actionSucceed:void 0};var We=function(e){function t(e){var n,r,o,i;return(0,a.A)(this,t),r=this,o=t,i=[e],o=(0,l.A)(o),n=(0,c.A)(r,Ve()?Reflect.construct(o,i||[],(0,l.A)(r).constructor):o.apply(r,i)),(0,H.A)(n,"toggleManageCommunitiesModal",(function(e){if(!e){var t=document.getElementById("modal-dropdown");t&&t.focus()}n.setState({manageCommunitiesModalOpen:e})})),(0,H.A)(n,"fetchRecordCommunities",(0,h.A)(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.recordCommunityEndpoint,e.next=3,b.http.get(t,{headers:{Accept:"application/vnd.inveniordm.v1+json"}});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))),(0,H.A)(n,"getCommunities",(0,h.A)(y().mark((function e(){var t,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.cancellableFetchCommunities=(0,b.withCancel)(n.fetchRecordCommunities()),n.setState({loading:!0,error:null}),e.prev=2,e.next=5,n.cancellableFetchCommunities.promise;case 5:t=e.sent,r=t.data.hits.hits,n.setState({communities:r,loading:!1}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),"UNMOUNTED"!==e.t0&&n.setState({loading:!1,error:u.M.t("An error occurred while fetching communities.")});case 13:case"end":return e.stop()}}),e,null,[[2,10]])})))),(0,H.A)(n,"handleRefresh",(function(){n.getCommunities(),n.toggleManageCommunitiesModal(!1)})),n.state={loading:!0,communities:void 0,error:void 0,manageCommunitiesModalOpen:!1},n}return(0,s.A)(t,e),(0,i.A)(t,[{key:"componentDidMount",value:function(){this.getCommunities()}},{key:"componentWillUnmount",value:function(){var e;null===(e=this.cancellableFetchCommunities)||void 0===e||e.cancel()}},{key:"render",value:function(){var e,t=this,n=this.props,o=n.recordCommunitySearchConfig,a=n.permissions,i=n.canManageRecord,c=n.userCommunitiesMemberships,l=n.recordCommunityEndpoint,s=n.recordUserCommunitySearchConfig,d=n.searchConfig,p=n.record,f=this.state,h=f.communities,v=f.loading,g=f.error,y=f.manageCommunitiesModalOpen;return(!Ae()(h)||i)&&r.createElement(r.Fragment,null,r.createElement(ae.A,{size:"medium",as:"h2",className:"flex align-items-baseline mt-0",attached:"top"},u.M.t("Communities"),i&&r.createElement(He,{actionSucceed:this.handleRefresh,userCommunitiesMemberships:c,recordCommunityEndpoint:l,searchConfig:d,recordCommunitySearchConfig:o,recordUserCommunitySearchConfig:s,toggleManageCommunitiesModal:this.toggleManageCommunitiesModal,record:p})),r.createElement(Me.A,{attached:"bottom",className:"rdm-sidebar"},r.createElement(Se,{permissions:a,communities:h,error:g,loading:v,maxDisplayedCommunities:3,branded:null===(e=p.parent)||void 0===e||null===(e=e.communities)||void 0===e?void 0:e.default}),r.createElement(be,{id:"record-communities-list-modal",modalOpen:y,handleOnOpen:function(){return t.toggleManageCommunitiesModal(!0)},handleOnClose:function(){return t.toggleManageCommunitiesModal(!1)},successActionCallback:this.handleRefresh,recordCommunityEndpoint:l,permissions:a,record:p}),!v&&(null===h||void 0===h?void 0:h.length)>3&&r.createElement(ke.A,{align:"center",className:"mt-10"},r.createElement(m.A,{className:"transparent","aria-haspopup":"dialog","aria-expanded":y,"aria-controls":"record-communities-list-modal",onClick:function(){return t.toggleManageCommunitiesModal(!0)}},u.M.t("View all {{count}} communities",{count:h.length})))))}}])}(r.Component);We.propTypes={recordCommunitySearchConfig:A().object.isRequired,recordCommunityEndpoint:A().string.isRequired,recordUserCommunitySearchConfig:A().object.isRequired,permissions:A().object.isRequired,canManageRecord:A().bool.isRequired,userCommunitiesMemberships:A().object.isRequired,searchConfig:A().object.isRequired,record:A().object.isRequired};var Ke=document.getElementById("recordManagement"),Ge=document.getElementById("recordManagementMobile"),Qe=document.getElementById("recordVersions"),Ye=document.getElementById("recordCitation"),Ze=document.getElementById("recordExportDownload"),$e=document.getElementById("sidebar-communities-manage"),Xe=S.overrideStore.getAll();function et(e){o.render(r.createElement(S.OverridableContext.Provider,{value:Xe},r.createElement(N,{record:JSON.parse(Ke.dataset.record),permissions:JSON.parse(Ke.dataset.permissions),isDraft:JSON.parse(Ke.dataset.isDraft),isPreviewSubmissionRequest:JSON.parse(Ke.dataset.isPreviewSubmissionRequest),currentUserId:Ke.dataset.currentUserId,recordOwnerID:Ke.dataset.recordOwnerId,groupsEnabled:JSON.parse(Ke.dataset.groupsEnabled)})),e)}if(Ke&&(et(Ke),Ge&&et(Ge)),Qe&&o.render(r.createElement(F,{record:JSON.parse(Qe.dataset.record),isPreview:JSON.parse(Qe.dataset.preview)}),Qe),Ye&&o.render(r.createElement(ne,{record:JSON.parse(Ye.dataset.record),styles:JSON.parse(Ye.dataset.styles),defaultStyle:JSON.parse(Ye.dataset.defaultstyle),includeDeleted:JSON.parse(Ye.dataset.includeDeleted)}),Ye),Ze&&o.render(r.createElement(oe,{formats:JSON.parse(Ze.dataset.formats)}),Ze),$e){var tt=JSON.parse($e.dataset.recordCommunitySearchConfig),nt=$e.dataset.pendingCommunitiesSearchConfig;o.render(r.createElement(S.OverridableContext.Provider,{value:Xe},r.createElement(S.default,{id:"InvenioAppRdm.RecordLandingPage.CommunitiesManagement.container",userCommunitiesMemberships:JSON.parse($e.dataset.userCommunitiesMemberships),recordCommunityEndpoint:$e.dataset.recordCommunityEndpoint,recordUserCommunitySearchConfig:JSON.parse($e.dataset.recordUserCommunitySearchConfig),canManageRecord:JSON.parse($e.dataset.canManageRecord),recordCommunitySearchConfig:tt,permissions:JSON.parse($e.dataset.permissions),searchConfig:JSON.parse(nt),record:JSON.parse(Ye.dataset.record)},r.createElement(We,{userCommunitiesMemberships:JSON.parse($e.dataset.userCommunitiesMemberships),recordCommunityEndpoint:$e.dataset.recordCommunityEndpoint,recordUserCommunitySearchConfig:JSON.parse($e.dataset.recordUserCommunitySearchConfig),canManageRecord:JSON.parse($e.dataset.canManageRecord),recordCommunitySearchConfig:tt,permissions:JSON.parse($e.dataset.permissions),searchConfig:JSON.parse(nt),record:JSON.parse(Ye.dataset.record)}))),$e)}},17965:(e,t,n)=>{"use strict";var r=n(16426),o={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var n,a,i,c,l,s,u=!1;t||(t={}),n=t.debug||!1;try{if(i=r(),c=document.createRange(),l=document.getSelection(),(s=document.createElement("span")).textContent=e,s.ariaHidden="true",s.style.all="unset",s.style.position="fixed",s.style.top=0,s.style.clip="rect(0, 0, 0, 0)",s.style.whiteSpace="pre",s.style.webkitUserSelect="text",s.style.MozUserSelect="text",s.style.msUserSelect="text",s.style.userSelect="text",s.addEventListener("copy",(function(r){if(r.stopPropagation(),t.format)if(r.preventDefault(),"undefined"===typeof r.clipboardData){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var a=o[t.format]||o.default;window.clipboardData.setData(a,e)}else r.clipboardData.clearData(),r.clipboardData.setData(t.format,e);t.onCopy&&(r.preventDefault(),t.onCopy(r.clipboardData))})),document.body.appendChild(s),c.selectNodeContents(s),l.addRange(c),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");u=!0}catch(d){n&&console.error("unable to copy using execCommand: ",d),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),u=!0}catch(d){n&&console.error("unable to copy using clipboardData: ",d),n&&console.error("falling back to prompt"),a=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"\u2318":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(a,e)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(c):l.removeAllRanges()),s&&document.body.removeChild(s),i()}return u}},71599:(e,t,n)=>{var r=n(54552)({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});e.exports=r},14425:(e,t,n)=>{var r=n(71599),o=n(13222),a=/[&<>"']/g,i=RegExp(a.source);e.exports=function(e){return(e=o(e))&&i.test(e)?e.replace(a,r):e}},25264:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.CopyToClipboard=void 0;var o=c(n(96540)),a=c(n(17965)),i=["text","onCopy","options","children"];function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=h(e);if(t){var a=h(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}(this,n)}}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(l,e);var t,n,r,c=p(l);function l(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return v(f(e=c.call.apply(c,[this].concat(n))),"onClick",(function(t){var n=e.props,r=n.text,i=n.onCopy,c=n.children,l=n.options,s=o.default.Children.only(c),u=(0,a.default)(r,l);i&&i(r,u),s&&s.props&&"function"===typeof s.props.onClick&&s.props.onClick(t)})),e}return t=l,(n=[{key:"render",value:function(){var e=this.props,t=(e.text,e.onCopy,e.options,e.children),n=u(e,i),r=o.default.Children.only(t);return o.default.cloneElement(r,s(s({},n),{},{onClick:this.onClick}))}}])&&d(t.prototype,n),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.default.PureComponent);t.CopyToClipboard=g,v(g,"defaultProps",{onCopy:void 0,options:void 0})},59399:(e,t,n)=>{"use strict";var r=n(25264).CopyToClipboard;r.CopyToClipboard=r,e.exports=r},16426:e=>{e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],r=0;r<e.rangeCount;r++)n.push(e.getRangeAt(r));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}}},e=>{e.O(0,[3378,1057,7655,6506,5373,8871,621,4709,5941,9736,5965,1677,9827,8102,742,5368,9945,8585,1990,1357,3532,1644,8962,9300,5680],(()=>{return t=78927,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=invenio-app-rdm-landing-page.ef6dd12ca828fb095757.js.map