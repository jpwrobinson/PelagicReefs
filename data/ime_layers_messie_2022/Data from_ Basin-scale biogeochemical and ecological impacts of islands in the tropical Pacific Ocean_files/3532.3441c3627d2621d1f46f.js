"use strict";(self.webpackChunkinvenio_assets=self.webpackChunkinvenio_assets||[]).push([[3532],{93532:(e,t,n)=>{n.d(t,{Re:()=>K,D:()=>Po,qE:()=>wi,En:()=>Ai,Y4:()=>Ye,Kp:()=>it,et:()=>di,k6:()=>yo,KI:()=>Eo,q1:()=>se,l0:()=>Rn,yY:()=>ia,l4:()=>Sn,Km:()=>te,g7:()=>Rr,z4:()=>cn,EM:()=>Xn,PI:()=>hi,Hq:()=>Pr,IZ:()=>Hi,nH:()=>kr,bT:()=>Ir,CP:()=>jr,n:()=>qr,fB:()=>Ki,GC:()=>Nr,Kd:()=>qi,y5:()=>Wr,Je:()=>Qr,n2:()=>So});var r=n(58168),i=n(23029),a=n(92901),o=n(56822),l=n(53954),c=n(85501),s=n(96540),u=n(61225),d=n(5556),p=n.n(d),f=n(17684),m=n(81057),h=n(83794),v=n(80501),b=n(36713),y=n(27041),g=n(11990),A=n(64467),E=n(93682),w=n(76217),R=n(3487);function C(e,t,n){return t=(0,l.A)(t),(0,o.A)(e,P()?Reflect.construct(t,n||[],(0,l.A)(e).constructor):t.apply(e,n))}function P(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(P=function(){return!!e})()}var S=function(e){function t(){var e;(0,i.A)(this,t);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=C(this,t,[].concat(r)),(0,A.A)(e,"handlePublicButtonClick",(function(){var t=e.props,n=t.formik,r=t.fieldPath;n.form.setFieldValue(r,"public"),n.form.setFieldValue("access.embargo",{active:!1})})),(0,A.A)(e,"handleRestrictionButtonClick",(function(){var t=e.props,n=t.formik,r=t.fieldPath;n.form.setFieldValue(r,"restricted")})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.formik,n=e.disabled,r=e.fieldPath;n&&t.form.setFieldValue(r,"restricted")}},{key:"render",value:function(){var e=this.props,t=e.active,n=e.disabled,r=e.canRestrictRecord,i=t?"positive":"",a=t?"":"negative";return s.createElement(s.Fragment,null,!r&&s.createElement(E.A,{trigger:s.createElement(w.A,{className:"right-floated",name:"question circle outline"}),content:g.M.t("Record visibility can not be changed to restricted anymore. Please contact support if you still need to make these changes.")}),s.createElement(R.A.Group,{widths:"2"},s.createElement(R.A,{className:i,"data-testid":"protection-buttons-component-public",disabled:n,onClick:this.handlePublicButtonClick,active:t},g.M.t("Public")),s.createElement(R.A,{disabled:!r,className:a,"data-testid":"protection-buttons-component-restricted",active:!t,onClick:this.handleRestrictionButtonClick},g.M.t("Restricted"))))}}])}(s.Component);S.propTypes={canRestrictRecord:p().bool,fieldPath:p().string.isRequired,formik:p().object.isRequired,active:p().bool,disabled:p().bool},S.defaultProps={active:!0,disabled:!1,canRestrictRecord:!0};var k=function(e){function t(){return(0,i.A)(this,t),C(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props.fieldPath;return s.createElement(f.FastField,{name:t,component:function(t){return s.createElement(S,(0,r.A)({formik:t},e.props))}})}}])}(s.Component);k.defaultProps={canRestrictRecord:!0},k.propTypes={canRestrictRecord:p().bool,fieldPath:p().string.isRequired};var O=n(53196),D=n(91272),I=function(e){var t=e.recordAccess,n=e.communityAccess,i=e.record,a=e.recordRestrictionGracePeriod,o=e.allowRecordRestriction,l="public"===t,c="public"===n;return s.createElement(O.default,(0,r.A)({id:"ReactInvenioDeposit.MetadataAccess.layout"},e),s.createElement(s.Fragment,null,g.M.t("Full record"),s.createElement(k,{canRestrictRecord:function(){var e;return!(!o&&null!==i&&void 0!==i&&i.created&&"restricted"!==(null===i||void 0===i||null===(e=i.access)||void 0===e?void 0:e.record)&&i.is_published)||!(D.DateTime.fromISO(i.created).plus({days:a})<D.DateTime.now())}(),record:i,active:l&&c,disabled:!c,fieldPath:"access.record"})))};I.propTypes={recordAccess:p().string.isRequired,communityAccess:p().string.isRequired,record:p().object.isRequired,recordRestrictionGracePeriod:p().number.isRequired,allowRecordRestriction:p().bool.isRequired};var F=function(e){var t=e.access,n=e.accessCommunity,r=e.metadataOnly,i="public"===t.files,a="public"===t.record,o="public"===n,l=!o||!a,c=o&&!i&&a,u=!r&&o&&a;return r?s.createElement(h.A.Meta,{"data-testid":"access-files"},s.createElement("em",null,g.M.t("The record has no files."))):s.createElement("div",{"data-testid":"access-files"},u&&s.createElement(s.Fragment,null,g.M.t("Files only"),s.createElement(k,{active:i,disable:!o,fieldPath:"access.files"})),l&&s.createElement(h.A.Description,null,s.createElement("em",null,g.M.t("The full record is restricted."))),c&&s.createElement(h.A.Description,null,s.createElement("em",null,g.M.t("The files of this record are restricted."))))};F.propTypes={access:p().object.isRequired,metadataOnly:p().bool,accessCommunity:p().string.isRequired},F.defaultProps={metadataOnly:!1};var M=n(62193),x=n.n(M),T=n(27859),_=n(50363);function q(e,t,n){return t=(0,l.A)(t),(0,o.A)(e,z()?Reflect.construct(t,n||[],(0,l.A)(e).constructor):t.apply(e,n))}function z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(z=function(){return!!e})()}var j=function(e){function t(){return(0,i.A)(this,t),q(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.formik,r=e.checked,i=e.disabled;return s.createElement(_.A,{id:t,"data-testid":"embargo-checkbox-component",disabled:i,checked:r,onChange:function(){n.field.value?n.form.setFieldValue("access.embargo",{active:!1}):n.form.setFieldValue(t,!0)}})}}])}(s.Component);j.propTypes={fieldPath:p().string.isRequired,formik:p().object.isRequired,checked:p().bool,disabled:p().bool},j.defaultProps={checked:!1,disabled:!0};var L=function(e){function t(){return(0,i.A)(this,t),q(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.disabled,i=t.fieldPath,a=n?{change:!0}:{};return s.createElement(f.FastField,(0,r.A)({name:i,component:function(t){return s.createElement(j,(0,r.A)({formik:t},e.props))}},a))}}])}(s.Component);function B(e){var t=e.fieldPath,n=e.label,r=e.labelIcon,i=e.placeholder,a=e.required,o=e.helpText;return s.createElement(m.TextField,{fieldPath:t,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:r,label:n}),placeholder:i,required:a,helpText:o})}L.propTypes={disabled:p().bool,fieldPath:p().string.isRequired},L.defaultProps={disabled:!1},B.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,placeholder:p().string,required:p().bool,helpText:p().string},B.defaultProps={required:!1,labelIcon:"calendar",placeholder:g.M.t("YYYY-MM-DD"),label:g.M.t("Embargo until"),helpText:"".concat(g.M.t("Format"),": ").concat(g.M.t("YYYY-MM-DD"))};var N=n(52822),U=function(e){var t,n,r,i=e.access,a=e.accessCommunity,o=e.metadataOnly,l="public"===i.record,c="public"===i.files,u="public"===a,d=!o&&!c,p=(null===(t=i.embargo)||void 0===t?void 0:t.active)||!1,f=null===(n=i.embargo)||void 0===n?void 0:n.until,h=null===(r=i.embargo)||void 0===r?void 0:r.reason,v=!p&&!x()(f),y=u&&(!l||d),A=f?D.DateTime.fromISO(f).toLocaleString(D.DateTime.DATE_FULL):"???";return s.createElement(T.A,null,s.createElement(T.A.Item,{disabled:!y,"data-testid":"option-list-embargo"},s.createElement(T.A.Icon,{"aria-hidden":"false"},s.createElement(L,{fieldPath:"access.embargo.active",checked:p,disabled:!y})),s.createElement(T.A.Content,null,s.createElement(T.A.Header,{as:"label",htmlFor:"access.embargo.active"},g.M.t("Apply an embargo")," ",s.createElement(w.A,{name:"clock outline"})),s.createElement(T.A.Description,null,s.createElement(N.x,null,"Record or files protection must be ",s.createElement("b",null,"restricted")," to apply an embargo.")),p&&s.createElement(s.Fragment,null,s.createElement(b.A,{hidden:!0,className:"rel-mb-1"}),s.createElement(B,{fieldPath:"access.embargo.until",required:!0}),s.createElement(m.TextAreaField,{label:g.M.t("Embargo reason"),fieldPath:"access.embargo.reason",placeholder:g.M.t("Optionally, describe the reason for the embargo."),optimized:"true"})),v&&s.createElement(s.Fragment,null,s.createElement(b.A,{hidden:!0}),s.createElement("p",null,g.M.t("Embargo was lifted on {{fmtDate}}.",{fmtDate:A})),h&&s.createElement("p",null,s.createElement("b",null,g.M.t("Reason")),": ",h,".")))))};U.propTypes={access:p().object.isRequired,metadataOnly:p().bool,accessCommunity:p().string.isRequired},U.defaultProps={metadataOnly:!1};var V=n(87395),H=function(e){var t,n,r=e.access,i=e.metadataOnly,a=e.accessCommunity,o="public"===r.record,l="public"===r.files,c="public"===a,u=(null===(t=r.embargo)||void 0===t?void 0:t.active)||!1,d=!c||!o&&!u,p=c&&o&&(i||l),f=u&&!l&&o,m=!u&&!l&&o,h=!o&&u,v=null!==(n=r.embargo)&&void 0!==n&&n.until?D.DateTime.fromISO(r.embargo.until).toLocaleString(D.DateTime.DATE_FULL):"???";return p?s.createElement(V.A,{icon:!0,positive:!0,visible:!0,"data-testid":"access-message"},s.createElement(w.A,{name:"lock open"}),s.createElement(V.A.Content,null,s.createElement(V.A.Header,null,g.M.t("Public")),i?g.M.t("The record is publicly accessible."):g.M.t("The record and files are publicly accessible."))):h?s.createElement(V.A,{icon:!0,warning:!0,visible:!0,"data-testid":"access-message"},s.createElement(w.A,{name:"lock"}),s.createElement(V.A.Content,null,s.createElement(V.A.Header,null,g.M.t("Embargoed (full record)")),s.createElement(N.x,{i18nKey:"access-message"},"On ",s.createElement("b",null,v)," the record will automatically be made publicly accessible. Until then, the record can ",s.createElement("b",null,"only")," be accessed by"," ",s.createElement("b",null,"users specified"),' in the permissions."'))):d?s.createElement(V.A,{icon:!0,negative:!0,visible:!0,"data-testid":"access-message"},s.createElement(w.A,{name:"lock"}),s.createElement(V.A.Content,null,s.createElement(V.A.Header,null,g.M.t("Restricted")),s.createElement(N.x,null,"The record can ",s.createElement("b",null,"only")," be accessed by ",s.createElement("b",null,"users specified")," in the permissions."))):m?s.createElement(V.A,{icon:!0,warning:!0,visible:!0,"data-testid":"access-message"},s.createElement(w.A,{name:"lock"}),s.createElement(V.A.Content,null,s.createElement(V.A.Header,null,g.M.t("Public with restricted files")),s.createElement(N.x,null,"The record is publicly accessible. The files can ",s.createElement("b",null,"only")," be accessed by"," ",s.createElement("b",null,"users specified")," in the permissions."))):f?s.createElement(V.A,{icon:!0,warning:!0,visible:!0,"data-testid":"access-message"},s.createElement(w.A,{name:"lock"}),s.createElement(V.A.Content,null,s.createElement(V.A.Header,null,g.M.t("Embargoed (files-only)")),s.createElement(N.x,{defaults:"The record is publicly accessible. On <bold>{{ date }}</bold> the files will automatically be made publicly accessible. Until then, the files can <bold>only</bold> be accessed by <bold>users specified</bold> in the permissions.",values:{date:v},components:{bold:s.createElement("b",null)}}))):void 0};function Y(e,t,n){return t=(0,l.A)(t),(0,o.A)(e,W()?Reflect.construct(t,n||[],(0,l.A)(e).constructor):t.apply(e,n))}function W(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(W=function(){return!!e})()}H.propTypes={access:p().object.isRequired,metadataOnly:p().bool,accessCommunity:p().string.isRequired},H.defaultProps={metadataOnly:!1};var G=function(e){function t(){return(0,i.A)(this,t),Y(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.formik,r=e.label,i=e.labelIcon,a=e.showMetadataAccess,o=e.community,l=e.record,c=e.recordRestrictionGracePeriod,u=e.allowRecordRestriction,d=!0===(null===o||void 0===o?void 0:o.is_ghost),p=o&&!d&&o.access.visibility||"public",f=!n.form.values.files.enabled;return s.createElement(h.A,{className:"access-right"},s.createElement(v.A.Field,{required:!0},s.createElement(h.A.Content,null,s.createElement(h.A.Header,null,s.createElement(m.FieldLabel,{htmlFor:t,icon:i,label:r}))),s.createElement(h.A.Content,null,a&&s.createElement(s.Fragment,null,s.createElement(I,{recordAccess:n.field.value.record,communityAccess:p,record:l,recordRestrictionGracePeriod:c,allowRecordRestriction:u}),s.createElement(b.A,{hidden:!0})),s.createElement(F,{access:n.field.value,accessCommunity:p,metadataOnly:f}),s.createElement(b.A,{hidden:!0}),s.createElement(H,{access:n.field.value,accessCommunity:p,metadataOnly:f}),s.createElement(b.A,{hidden:!0})),s.createElement(h.A.Content,null,s.createElement(h.A.Header,{as:y.A,size:"tiny"},g.M.t("Options"))),s.createElement(h.A.Content,{extra:!0},s.createElement(U,{access:n.field.value,accessCommunity:p,metadataOnly:f}))))}}])}(s.Component);G.propTypes={fieldPath:p().string.isRequired,formik:p().object.isRequired,label:p().string.isRequired,labelIcon:p().string.isRequired,showMetadataAccess:p().bool,community:p().object,record:p().object.isRequired,recordRestrictionGracePeriod:p().number.isRequired,allowRecordRestriction:p().bool.isRequired},G.defaultProps={showMetadataAccess:!0,community:void 0};var Q=(0,u.connect)((function(e){return{community:e.deposit.editorState.selectedCommunity}}),null)(G),K=function(e){function t(){return(0,i.A)(this,t),Y(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props.fieldPath;return s.createElement(f.Field,{name:t},(function(t){return s.createElement(Q,(0,r.A)({formik:t},e.props))}))}}])}(s.Component);K.propTypes={fieldPath:p().string.isRequired,label:p().string.isRequired,labelIcon:p().string,isMetadataOnly:p().bool,record:p().object.isRequired,recordRestrictionGracePeriod:p().number.isRequired,allowRecordRestriction:p().bool.isRequired},K.defaultProps={labelIcon:void 0,isMetadataOnly:void 0};var X=n(1489),$={lang:"",description:"",type:""},J=n(80045),Z=["fieldPath","label","labelIcon","required","multiple","placeholder","clearable","initialOptions","serializeSuggestions"];function ee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ee=function(){return!!e})()}var te=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,ee()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,i=e.labelIcon,a=e.required,o=e.multiple,l=e.placeholder,c=e.clearable,u=e.initialOptions,d=e.serializeSuggestions,p=(0,J.A)(e,Z),f=d||null;return s.createElement(m.RemoteSelectField,(0,r.A)({fieldPath:t,suggestionAPIUrl:"/api/vocabularies/languages",suggestionAPIHeaders:{Accept:"application/vnd.inveniordm.v1+json"},placeholder:l,required:a,clearable:c,multiple:o,initialSuggestions:u,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:i,label:n}),noQueryMessage:g.M.t("Search for languages...")},f&&{serializeSuggestions:f},p))}}])}(s.Component);te.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,required:p().bool,multiple:p().bool,clearable:p().bool,placeholder:p().string,initialOptions:p().arrayOf(p().shape({key:p().string,value:p().string,text:p().string})),serializeSuggestions:p().func},te.defaultProps={label:g.M.t("Languages"),labelIcon:"globe",multiple:!0,clearable:!0,placeholder:g.M.t('Search for a language by name (e.g "eng", "fr" or "Polish")'),required:!1,initialOptions:void 0,serializeSuggestions:void 0};var ne=n(82284);function re(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};if("object"===(0,ne.A)(e))for(var n in e)re(e[n],t);else t(e)}function ie(e){return e.sort((function(e,t){return e.text.localeCompare(t.text)}))}function ae(){window.scrollTo({top:0,left:0,behavior:"smooth"})}function oe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(oe=function(){return!!e})()}var le=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,oe()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.options,r=e.recordUI,i=e.editorConfig;return s.createElement(m.ArrayField,{addButtonLabel:g.M.t("Add description"),defaultNewValue:$,fieldPath:t,className:"additional-descriptions"},(function(e){var a,o=e.arrayHelpers,l=e.indexPath,c="".concat(t,".").concat(l);return s.createElement(X.A,{className:"description"},s.createElement(X.A.Row,null,s.createElement(X.A.Column,{mobile:16,tablet:10,computer:12},s.createElement(m.RichInputField,{fieldPath:"".concat(c,".description"),label:g.M.t("Additional Description"),editorConfig:i,optimized:!0,required:!0})),s.createElement(X.A.Column,{mobile:16,tablet:6,computer:4},s.createElement(v.A.Field,null,s.createElement(R.A,{"aria-label":g.M.t("Remove field"),className:"close-btn",floated:"right",icon:!0,onClick:function(){return o.remove(l)}},s.createElement(w.A,{name:"close"}))),s.createElement(m.SelectField,{fieldPath:"".concat(c,".type"),label:g.M.t("Type"),options:ie(n.type),required:!0,optimized:!0}),s.createElement(te,{serializeSuggestions:function(e){return e.map((function(e){return{text:e.title_l10n,value:e.id,fieldPathPrefix:e.id}}))},initialOptions:null!==r&&void 0!==r&&r.additional_descriptions&&null!==(a=r.additional_descriptions[l])&&void 0!==a&&a.lang?[r.additional_descriptions[l].lang]:[],fieldPath:"".concat(c,".lang"),label:g.M.t("Language"),multiple:!1,placeholder:g.M.t("Select language"),labelIcon:"",clearable:!0,selectOnBlur:!1}))))}))}}])}(s.Component);function ce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ce=function(){return!!e})()}le.propTypes={fieldPath:p().string.isRequired,options:p().shape({type:p().arrayOf(p().shape({icon:p().string,text:p().string,value:p().string})),lang:p().arrayOf(p().shape({text:p().string,value:p().string}))}).isRequired,recordUI:p().object,editorConfig:p().object},le.defaultProps={recordUI:{},editorConfig:void 0};var se=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,ce()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,r=e.labelIcon,i=e.options,a=e.editorConfig,o=e.recordUI;return s.createElement(s.Fragment,null,s.createElement(m.RichInputField,{className:"description-field rel-mb-1 rel-mt-2",fieldPath:t,editorConfig:a,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:r,label:n}),optimized:!0}),s.createElement(le,{recordUI:o,options:i,editorConfig:a,fieldPath:"metadata.additional_descriptions"}))}}])}(s.Component);se.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,editorConfig:p().object,recordUI:p().object,options:p().object.isRequired},se.defaultProps={label:g.M.t("Description"),labelIcon:"pencil",editorConfig:void 0,recordUI:void 0};var ue=n(28085),de=n(58156),pe=n.n(de),fe=n(55378),me=n.n(fe),he=n(8909),ve=n(79551),be=n(80296),ye=n(7309),ge=n.n(ye),Ae=n(48423),Ee=n(15941);function we(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(we=function(){return!!e})()}var Re=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,we()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.selectRef;return s.createElement(f.Field,{name:t},(function(e){var r=e.form.values;return s.createElement(m.RemoteSelectField,{fieldPath:t,suggestionAPIUrl:"/api/affiliations",suggestionAPIHeaders:{Accept:"application/vnd.inveniordm.v1+json"},initialSuggestions:(0,f.getIn)(r,t,[]),serializeSuggestions:function(e){return(0,m.AffiliationsSuggestions)(e,!0)},placeholder:g.M.t("Search or create affiliation"),label:s.createElement(m.FieldLabel,{htmlFor:"".concat(t,".name"),label:g.M.t("Affiliations")}),noQueryMessage:g.M.t("Search for affiliations.."),allowAdditions:!0,clearable:!0,multiple:!0,onValueChange:function(e,n){e.formikProps.form.setFieldValue(t,n)},value:(0,f.getIn)(r,t,[]).map((function(e){return e.name||e.text||e.id})),ref:n,search:function(e){return e}})}))}}])}(s.Component);Re.propTypes={fieldPath:p().string.isRequired,selectRef:p().object},Re.defaultProps={selectRef:void 0};var Ce=n(45458),Pe=n(99786),Se=n.n(Pe);function ke(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ke=function(){return!!e})()}var Oe=function(e){function t(e){var n,r,a,c;return(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),n=(0,o.A)(r,ke()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c)),(0,A.A)(n,"handleIdentifierAddition",(function(e,t){var r=t.value;n.setState((function(e){return{selectedOptions:Se()([{text:r,value:r,key:r}].concat((0,Ce.A)(e.selectedOptions)),"value")}}))})),(0,A.A)(n,"valuesToOptions",(function(e){return e.map((function(e){return{text:e,value:e,key:e}}))})),(0,A.A)(n,"handleChange",(function(e){var t=e.data,r=e.formikProps,i=n.props.fieldPath;n.setState({selectedOptions:n.valuesToOptions(t.value)}),r.form.setFieldValue(i,t.value)})),n.state={selectedOptions:e.initialOptions},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,r=e.placeholder,i=this.state.selectedOptions;return s.createElement(m.SelectField,{fieldPath:t,label:n,options:i,placeholder:r,noResultsMessage:g.M.t("Type the value of an identifier..."),search:!0,multiple:!0,selection:!0,allowAdditions:!0,onChange:this.handleChange,icon:null,onAddItem:this.handleIdentifierAddition,optimized:!0})}}])}(s.Component);Oe.propTypes={initialOptions:p().arrayOf(p().shape({key:p().string.isRequired,text:p().string.isRequired,value:p().string.isRequired})).isRequired,fieldPath:p().string.isRequired,label:p().string,placeholder:p().string},Oe.defaultProps={label:g.M.t("Identifiers"),placeholder:g.M.t("e.g. ORCID, ISNI or GND.")};var De="personal",Ie="organizational";function Fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(xe=function(){return!!e})()}var Te="add",_e="search_only",qe="off",ze=function(e){function t(e){var n,r,a,c;return(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),n=(0,o.A)(r,xe()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c)),(0,A.A)(n,"CreatorSchema",Ee.Ik({person_or_org:Ee.Ik({type:Ee.Yj(),family_name:Ee.Yj().when("type",(function(e,t){if(e===De&&n.isCreator())return t.required(g.M.t("Family name is a required field."))})),name:Ee.Yj().when("type",(function(e,t){if(e===Ie&&n.isCreator())return t.required(g.M.t("Name is a required field."))}))}),role:Ee.Yj().when("_",(function(e,t){if(!n.isCreator())return t.required(g.M.t("Role is a required field."))}))})),(0,A.A)(n,"openModal",(function(){n.setState({open:!0,action:null},(function(){var e=n.props.initialCreatibutor;x()(e)||(n.state.isOrganization?(e.person_or_org.family_name="",e.person_or_org.given_name=""):e.person_or_org.name="",n.initStatesFromInitialCreatibutor(e))}))})),(0,A.A)(n,"closeModal",(function(){n.setState({personAffiliations:[],personIdentifiers:[],organizationAffiliations:[],organizationIdentifiers:[],open:!1,action:null})})),(0,A.A)(n,"changeContent",(function(){n.setState({saveAndContinueLabel:g.M.t("Added")}),setTimeout((function(){n.setState({saveAndContinueLabel:g.M.t("Save and add another")})}),2e3)})),(0,A.A)(n,"displayActionLabel",(function(){var e=n.props,t=e.action,r=e.addLabel,i=e.editLabel;return t===Te?r:i})),(0,A.A)(n,"serializeCreatibutor",(function(e){var t=n.props.initialCreatibutor,r="person_or_org.identifiers",i=pe()(t,r,[]),a=pe()(e,r,[]).map((function(e){return t=i,n="identifier",r=e,ge()(t,(0,A.A)({},n,r))||(0,A.A)({},n,r);var t,n,r})),o=pe()(e,"affiliations",[]);return Me(Me({},e),{},{person_or_org:Me(Me({},e.person_or_org),{},{identifiers:a}),affiliations:o})})),(0,A.A)(n,"deserializeCreatibutor",(function(e){return{person_or_org:Me(Me({type:De},e.person_or_org),{},{identifiers:me()(pe()(e,"person_or_org.identifiers",[]),"identifier")}),affiliations:pe()(e,"affiliations",[]),role:pe()(e,"role","")}})),(0,A.A)(n,"isCreator",(function(){return"creators"===n.props.schema})),(0,A.A)(n,"onSubmit",(function(e,t){var r=n.props.onCreatibutorChange,i=n.state.action;switch(r(n.serializeCreatibutor(e)),t.setSubmitting(!1),t.resetForm(),i){case"saveAndContinue":n.closeModal(),n.openModal(),n.changeContent();break;case"saveAndClose":n.closeModal()}})),(0,A.A)(n,"serializeSuggestions",(function(e){var t=n.state.isOrganization;return(0,m.AffiliationsSuggestions)(e,t)})),(0,A.A)(n,"onOrganizationSearchChange",(function(e,t){var r=e.formikProps,i=t[0].extra;n.setState({organizationIdentifiers:i.identifiers.filter((function(e){return"grid"!==e.scheme})).map((function(e){return e.identifier})),organizationAffiliations:[]},(function(){var e=n.state,t=e.organizationIdentifiers,a=e.organizationAffiliations;r.form.setFieldValue("person_or_org.name",i.name),n.updateIdentifiersAndAffiliations(r,t,a,n.identifiersRef,n.affiliationsRef)}))})),(0,A.A)(n,"onPersonSearchChange",(function(e,t){var r=e.formikProps;if("manual-entry"===t[0].key)return n.namesAutocompleteRef.current.setState({suggestions:[],selectedSuggestions:[]}),void n.setState({showPersonForm:!0});var i=t[0].extra;n.setState({showPersonForm:!0,personIdentifiers:i.identifiers.map((function(e){return e.identifier})),personAffiliations:i.affiliations.map((function(e){return e}))},(function(){var e=n.state,t=e.personIdentifiers,a=e.personAffiliations,o="person_or_org",l="".concat(o,".family_name"),c="".concat(o,".given_name"),s=(0,A.A)((0,A.A)({},c,i.given_name),l,i.family_name);Object.entries(s).forEach((function(e){var t=(0,be.A)(e,2),n=t[0],i=t[1];r.form.setFieldValue(n,i)})),n.updateIdentifiersAndAffiliations(r,t,a,n.identifiersRef,n.affiliationsRef)}))})),n.state={open:!1,saveAndContinueLabel:g.M.t("Save and add another"),action:null,showPersonForm:e.autocompleteNames!==_e||!x()(e.initialCreatibutor),isOrganization:!x()(e.initialCreatibutor)&&e.initialCreatibutor.person_or_org.type===Ie,personIdentifiers:[],personAffiliations:[],organizationIdentifiers:[],organizationAffiliations:[]},n.inputRef=(0,s.createRef)(),n.identifiersRef=(0,s.createRef)(),n.affiliationsRef=(0,s.createRef)(),n.namesAutocompleteRef=(0,s.createRef)(),n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"initStatesFromInitialCreatibutor",value:function(e){var t,n=e.affiliations,r=void 0===n?[]:n,i=this.state.isOrganization,a=null===(t=e.person_or_org.identifiers)||void 0===t?void 0:t.map((function(e){return e.identifier}));this.setState({personIdentifiers:i?[]:a,personAffiliations:i?[]:r,organizationIdentifiers:i?a:[],organizationAffiliations:i?r:[]})}},{key:"updateIdentifiersAndAffiliations",value:function(e,t,n,r,i){var a="".concat("person_or_org",".identifiers"),o=(0,A.A)((0,A.A)({},a,t),"affiliations",n);Object.entries(o).forEach((function(t){var n=(0,be.A)(t,2),r=n[0],i=n[1];e.form.setFieldValue(r,i)})),r.current.setState({selectedOptions:r.current.valuesToOptions(t)});var l=n.map((function(e){var t=e.name;return{text:t,value:t,key:t,name:t}}));i.current.setState({suggestions:l,selectedSuggestions:l,searchQuery:null,error:!1,open:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.initialCreatibutor,i=t.autocompleteNames,a=t.roleOptions,o=t.trigger,l=t.action,c=this.state,u=c.open,d=c.showPersonForm,p=c.personIdentifiers,h=c.personAffiliations,b=c.organizationIdentifiers,y=c.organizationAffiliations,A=c.saveAndContinueLabel,E=this.displayActionLabel();return s.createElement(f.Formik,{initialValues:this.deserializeCreatibutor(n),onSubmit:this.onSubmit,enableReinitialize:!0,validationSchema:this.CreatorSchema,validateOnChange:!1,validateOnBlur:!1},(function(t){var c=t.values,f=t.resetForm,w=t.handleSubmit,C="person_or_org",P="".concat(C,".type"),S="".concat(C,".family_name"),k="".concat(C,".given_name"),O="".concat(C,".name"),D="".concat(C,".identifiers"),I="affiliations";return s.createElement(Ae.A,{centered:!1,onOpen:function(){return e.openModal()},open:u,trigger:o,onClose:function(){e.closeModal(),f()},closeIcon:!0,closeOnDimmerClick:!1},s.createElement(Ae.A.Header,{as:"h2",className:"pt-10 pb-10"},E),s.createElement(Ae.A.Content,null,s.createElement(v.A,null,s.createElement(v.A.Group,null,s.createElement(m.RadioField,{fieldPath:P,label:g.M.t("Person"),checked:pe()(c,P)===De,value:De,onChange:function(t){var n=t.formikProps;e.setState({isOrganization:!1}),n.form.setFieldValue(P,De),n.form.setFieldValue(D,p),n.form.setFieldValue(I,h)},autoFocus:!0,optimized:!0}),s.createElement(m.RadioField,{fieldPath:P,label:g.M.t("Organization"),checked:pe()(c,P)===Ie,value:Ie,onChange:function(t){var n=t.formikProps;e.setState({isOrganization:!0}),n.form.setFieldValue(P,Ie),n.form.setFieldValue(I,y),n.form.setFieldValue(D,b)},optimized:!0})),pe()(c,P,"")===De?s.createElement(s.Fragment,null,i!==qe&&s.createElement(m.RemoteSelectField,{selectOnBlur:!1,selectOnNavigation:!1,searchInput:{autoFocus:x()(n)},fieldPath:"creators",clearable:!0,multiple:!1,allowAdditions:!1,placeholder:g.M.t("Search for persons by name, identifier, or affiliation..."),noQueryMessage:g.M.t("Search for persons by name, identifier, or affiliation..."),required:!1,search:function(e){return e},suggestionAPIUrl:"/api/names",serializeSuggestions:e.serializeSuggestions,onValueChange:e.onPersonSearchChange,ref:e.namesAutocompleteRef}),d&&s.createElement(s.Fragment,null,s.createElement(v.A.Group,{widths:"equal"},s.createElement(m.TextField,{label:g.M.t("Family name"),placeholder:g.M.t("Family name"),fieldPath:S,required:e.isCreator()}),s.createElement(m.TextField,{label:g.M.t("Given names"),placeholder:g.M.t("Given names"),fieldPath:k})),s.createElement(Oe,{initialOptions:me()(pe()(c,D,[]),(function(e){return{text:e,value:e,key:e}})),fieldPath:D,ref:e.identifiersRef}),s.createElement(Re,{fieldPath:I,selectRef:e.affiliationsRef}))):s.createElement(s.Fragment,null,i!==qe&&s.createElement(m.RemoteSelectField,{selectOnBlur:!1,selectOnNavigation:!1,searchInput:{autoFocus:x()(n)},fieldPath:"creators",clearable:!0,multiple:!1,allowAdditions:!1,placeholder:g.M.t("Search for an organization by name, identifier, or affiliation..."),noQueryMessage:g.M.t("Search for organization by name, identifier, or affiliation..."),required:!1,search:function(e){return e},suggestionAPIUrl:"/api/affiliations",serializeSuggestions:e.serializeSuggestions,onValueChange:e.onOrganizationSearchChange}),s.createElement(m.TextField,{label:g.M.t("Name"),placeholder:g.M.t("Organization name"),fieldPath:O,required:e.isCreator(),input:{ref:e.inputRef}}),s.createElement(Oe,{initialOptions:me()(pe()(c,D,[]),(function(e){return{text:e,value:e,key:e}})),fieldPath:D,ref:e.identifiersRef,placeholder:g.M.t("e.g. ROR, ISNI or GND.")}),s.createElement(Re,{fieldPath:I,selectRef:e.affiliationsRef})),(pe()(c,P)===Ie||d&&pe()(c,P)===De)&&s.createElement(m.SelectField,(0,r.A)({fieldPath:"role",label:g.M.t("Role"),options:a,placeholder:g.M.t("Select role")},e.isCreator()&&{clearable:!0},{required:!e.isCreator(),optimized:!0,scrolling:!0})))),s.createElement(Ae.A.Actions,null,s.createElement(R.A,{name:"cancel",onClick:function(){f(),e.closeModal()},icon:"remove",content:g.M.t("Cancel"),floated:"left"}),l===Te&&s.createElement(R.A,{name:"submit",onClick:function(){e.setState({action:"saveAndContinue",showPersonForm:i!==_e},(function(){w()}))},primary:!0,icon:"checkmark",content:A}),s.createElement(R.A,{name:"submit",onClick:function(){e.setState({action:"saveAndClose",showPersonForm:i!==_e},(function(){return w()}))},primary:!0,icon:"checkmark",content:g.M.t("Save")})))}))}}])}(s.Component);ze.propTypes={schema:p().oneOf(["creators","contributors"]).isRequired,action:p().oneOf(["add","edit"]).isRequired,addLabel:p().string.isRequired,autocompleteNames:p().oneOf(["search","search_only","off"]),editLabel:p().string.isRequired,initialCreatibutor:p().shape({id:p().string,person_or_org:p().shape({family_name:p().string,given_name:p().string,name:p().string,type:p().string,identifiers:p().arrayOf(p().shape({scheme:p().string,identifier:p().string}))}),affiliations:p().array,role:p().string}),trigger:p().object.isRequired,onCreatibutorChange:p().func.isRequired,roleOptions:p().array},ze.defaultProps={roleOptions:[],initialCreatibutor:{},autocompleteNames:"search"};var je=n(97177),Le=n(65522),Be=n(16147),Ne=function(e){var t=e.compKey,n=e.identifiersError,r=e.index,i=e.replaceCreatibutor,a=e.removeCreatibutor,o=e.moveCreatibutor,l=e.addLabel,c=e.editLabel,u=e.initialCreatibutor,d=e.displayName,p=e.roleOptions,f=e.schema,m=e.autocompleteNames,h=s.useRef(null),v=(0,je.i)({item:{index:r,type:"creatibutor"}}),b=(0,be.A)(v,3),y=(b[0],b[1]),A=b[2],E=(0,Le.H)({accept:"creatibutor",hover:function(e,t){if(h.current){var n=e.index,i=r;n!==i&&t.isOver({shallow:!0})&&(o(n,i),e.index=i)}},collect:function(e){return{hidden:e.isOver({shallow:!0})}}}),w=(0,be.A)(E,2),C=w[0].hidden,P=w[1],S=n&&n.find((function(e){return![void 0,null].includes(e)}));return P(h),s.createElement(Be.o,{innerRef:h,key:t},s.createElement(T.A.Item,{key:t,className:C?"deposit-drag-listitem hidden":"deposit-drag-listitem"},s.createElement(T.A.Content,{floated:"right"},s.createElement(ze,{addLabel:l,editLabel:c,onCreatibutorChange:function(e){i(r,e)},initialCreatibutor:u,roleOptions:p,schema:f,autocompleteNames:m,action:"edit",trigger:s.createElement(R.A,{size:"mini",primary:!0,type:"button"},g.M.t("Edit"))}),s.createElement(R.A,{size:"mini",type:"button",onClick:function(){return a(r)}},g.M.t("Remove"))),s.createElement(Be.o,{innerRef:y},s.createElement(T.A.Icon,{name:"bars",className:"drag-anchor"})),s.createElement(Be.o,{innerRef:A},s.createElement(T.A.Content,null,s.createElement(T.A.Description,null,s.createElement("span",{className:"creatibutor"},pe()(u,"person_or_org.identifiers",[]).some((function(e){return"orcid"===e.scheme}))&&s.createElement("img",{alt:"ORCID logo",className:"inline-id-icon mr-5",src:"/static/images/orcid.svg",width:"16",height:"16"}),pe()(u,"person_or_org.identifiers",[]).some((function(e){return"ror"===e.scheme}))&&s.createElement("img",{alt:"ROR logo",className:"inline-id-icon mr-5",src:"/static/images/ror-icon.svg",width:"16",height:"16"}),pe()(u,"person_or_org.identifiers",[]).some((function(e){return"gnd"===e.scheme}))&&s.createElement("img",{alt:"GND logo",className:"inline-id-icon mr-5",src:"/static/images/gnd-icon.svg",width:"16",height:"16"}),d," ",function(e,t){if(e){var n,r,i=null!==(n=null===(r=t.find((function(t){return t.value===e})))||void 0===r?void 0:r.text)&&void 0!==n?n:e;return s.createElement(ue.A,{size:"tiny"},i)}}(null===u||void 0===u?void 0:u.role,p))),S&&s.createElement(ue.A,{pointing:"left",prompt:!0},S.scheme?S.scheme:"Invalid identifiers")))))};function Ue(e,t,n){return t=(0,l.A)(t),(0,o.A)(e,Ve()?Reflect.construct(t,n||[],(0,l.A)(e).constructor):t.apply(e,n))}function Ve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ve=function(){return!!e})()}Ne.propTypes={compKey:p().string.isRequired,identifiersError:p().array,index:p().number.isRequired,replaceCreatibutor:p().func.isRequired,removeCreatibutor:p().func.isRequired,moveCreatibutor:p().func.isRequired,addLabel:p().node,editLabel:p().node,initialCreatibutor:p().object.isRequired,displayName:p().string,roleOptions:p().array.isRequired,schema:p().string.isRequired,autocompleteNames:p().oneOfType([p().bool,p().string])},Ne.defaultProps={identifiersError:void 0,addLabel:void 0,editLabel:void 0,displayName:void 0,autocompleteNames:void 0};var He=function(e){function t(){var e;(0,i.A)(this,t);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=Ue(this,t,[].concat(r)),(0,A.A)(e,"handleOnContributorChange",(function(t){(0,e.props.push)(t)})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.form,n=t.values,r=t.errors,i=t.initialErrors,a=t.initialValues,o=e.remove,l=e.replace,c=e.move,u=e.name,d=e.label,p=e.labelIcon,h=e.roleOptions,b=e.schema,y=e.modal,g=e.autocompleteNames,A=e.addButtonLabel,E=(0,f.getIn)(n,u,[]),C=(0,f.getIn)(a,u,[]),P=(0,f.getIn)(r,u,null),S=(0,f.getIn)(i,u,null),k=P||E===C&&S;return s.createElement(ve.Q,{backend:he.t2},s.createElement(v.A.Field,{required:"creators"===b,className:k?"error":""},s.createElement(m.FieldLabel,{htmlFor:u,icon:p,label:d}),s.createElement(T.A,null,E.map((function(e,t){var n,r="".concat(u,".").concat(t),i=k&&(null===(n=k[t])||void 0===n||null===(n=n.person_or_org)||void 0===n?void 0:n.identifiers),a=function(e){var t=pe()(e,"person_or_org.type",De)===De,n=pe()(e,"person_or_org.family_name",""),r=pe()(e,"person_or_org.given_name",""),i=null===e||void 0===e?void 0:e.affiliations.map((function(e){return e.text||e.name})),a=pe()(e,"person_or_org.name"),o=i.length?" (".concat(i.join(", "),")"):"";if(t){var l=r?", ".concat(r):"";return"".concat(n).concat(l).concat(o)}return"".concat(a).concat(o)}(e);return s.createElement(Ne,{key:r,identifiersError:i,displayName:a,index:t,roleOptions:h,schema:b,compKey:r,initialCreatibutor:e,removeCreatibutor:o,replaceCreatibutor:l,moveCreatibutor:c,addLabel:y.addLabel,editLabel:y.editLabel,autocompleteNames:g})}))),s.createElement(ze,{onCreatibutorChange:this.handleOnContributorChange,action:"add",addLabel:y.addLabel,editLabel:y.editLabel,roleOptions:ie(h),schema:b,autocompleteNames:g,trigger:s.createElement(R.A,{type:"button",icon:!0,labelPosition:"left"},s.createElement(w.A,{name:"add"}),A)}),k&&"string"==typeof k&&s.createElement(ue.A,{pointing:"left",prompt:!0},k)))}}])}(s.Component),Ye=function(e){function t(){return(0,i.A)(this,t),Ue(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props.fieldPath;return s.createElement(f.FieldArray,{name:t,component:function(t){return s.createElement(He,(0,r.A)({},t,e.props))}})}}])}(s.Component);He.propTypes={fieldPath:p().string.isRequired,addButtonLabel:p().string,modal:p().shape({addLabel:p().string.isRequired,editLabel:p().string.isRequired}),schema:p().oneOf(["creators","contributors"]).isRequired,autocompleteNames:p().oneOf(["search","search_only","off"]),label:p().string,labelIcon:p().string,roleOptions:p().array.isRequired,form:p().object.isRequired,remove:p().func.isRequired,replace:p().func.isRequired,move:p().func.isRequired,push:p().func.isRequired,name:p().string.isRequired},He.defaultProps={autocompleteNames:"search",label:g.M.t("Creators"),labelIcon:"user",modal:{addLabel:g.M.t("Add creator"),editLabel:g.M.t("Edit creator")},addButtonLabel:g.M.t("Add creator")},Ye.propTypes={fieldPath:p().string.isRequired,addButtonLabel:p().string,modal:p().shape({addLabel:p().string.isRequired,editLabel:p().string.isRequired}),schema:p().oneOf(["creators","contributors"]).isRequired,autocompleteNames:p().oneOf(["search","search_only","off"]),label:p().string,labelIcon:p().string,roleOptions:p().array},Ye.defaultProps={autocompleteNames:"search",label:void 0,labelIcon:void 0,roleOptions:void 0,modal:{addLabel:g.M.t("Add creator"),editLabel:g.M.t("Edit creator")},addButtonLabel:g.M.t("Add creator")};var We=n(61505),Ge=n.n(We),Qe=n(87612),Ke=n.n(Qe),Xe=n(2404),$e=n.n(Xe),Je=n(61448),Ze=n.n(Je),et={date:"",description:"",type:""};function tt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return nt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function rt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(rt=function(){return!!e})()}var it=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,rt()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"getRequiredOption",(function(t,n){var r,i=tt(e.props.requiredOptions);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=Ke()(n,Ge()(a))[0];if($e()(o,t))return a}}catch(l){i.e(l)}finally{i.f()}return null})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.fieldPath,r=t.options,i=t.label,a=t.labelIcon,o=t.placeholderDate,l=t.required,c=t.requiredOptions,u=t.showEmptyValue;return s.createElement(O.default,{id:"InvenioRdmRecords.DatesField.AddDateArrayField.Container",fieldPath:n},s.createElement(m.ArrayField,{addButtonLabel:g.M.t("Add date"),defaultNewValue:et,fieldPath:n,helpText:g.M.t("Format: DATE or DATE/DATE where DATE is YYYY or YYYY-MM or YYYY-MM-DD."),label:i,labelIcon:a,required:l,requiredOptions:c,showEmptyValue:u},(function(t){var i=t.array,a=t.arrayHelpers,l=t.indexPath,c=t.value,u="".concat(n,".").concat(l),d=e.getRequiredOption(c,i),p=Ze()(d,"date"),f=Ze()(d,"type"),h=Ze()(d,"description");return s.createElement(m.GroupField,{fieldPath:n,optimized:!0},s.createElement(O.default,{id:"InvenioRdmRecords.DatesField.DateTextField.Container",fieldPath:"".concat(u,".date")},s.createElement(m.TextField,{fieldPath:"".concat(u,".date"),label:g.M.t("Date"),placeholder:o,disabled:p,required:!0,width:5})),s.createElement(O.default,{id:"InvenioRdmRecords.DatesField.TypeSelectField.Container",fieldPath:"".concat(u,".type")},s.createElement(m.SelectField,{fieldPath:"".concat(u,".type"),label:g.M.t("Type"),"aria-label":g.M.t("Type"),options:ie(r.type),disabled:f,required:!0,width:5,optimized:!0})),s.createElement(O.default,{id:"InvenioRdmRecords.DatesField.DescriptionTextField.Container",fieldPath:"".concat(u,".description")},s.createElement(m.TextField,{fieldPath:"".concat(u,".description"),label:g.M.t("Description"),disabled:h,width:5})),s.createElement(O.default,{id:"InvenioRdmRecords.DatesField.RemoveFormField.Container"},s.createElement(v.A.Field,null,s.createElement(R.A,{"aria-label":g.M.t("Remove field"),className:"close-btn",disabled:!x()(d),icon:!0,onClick:function(){return a.remove(l)},type:"button"},s.createElement(w.A,{name:"close"})))))})))}}])}(s.Component);it.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,options:p().shape({type:p().arrayOf(p().shape({text:p().string,value:p().string}))}).isRequired,required:p().bool,placeholderDate:p().string,requiredOptions:p().array,showEmptyValue:p().bool},it.defaultProps={label:g.M.t("Dates"),labelIcon:"calendar",placeholderDate:g.M.t("YYYY-MM-DD or YYYY-MM-DD/YYYY-MM-DD"),required:!1,requiredOptions:[],showEmptyValue:!1};var at=n(10467),ot=n(54756),lt=n.n(ot),ct=n(2543),st=n.n(ct),ut="DRAFT_FETCHED",dt="DRAFT_HAS_VALIDATION_ERRORS",pt="DRAFT_SAVE_STARTED",ft="DRAFT_SAVE_SUCCEEDED",mt="DRAFT_SAVE_FAILED",ht="DRAFT_PUBLISH_STARTED",vt="DRAFT_PUBLISH_FAILED",bt="DRAFT_PUBLISH_FAILED_WITH_VALIDATION_ERRORS",yt="DRAFT_PREVIEW_STARTED",gt="DRAFT_PREVIEW_FAILED",At="DRAFT_DELETE_STARTED",Et="DRAFT_DELETE_FAILED",wt="DRAFT_SUBMIT_REVIEW_STARTED",Rt="DRAFT_SUBMIT_REVIEW_FAILED",Ct="DRAFT_SUBMIT_REVIEW_FAILED_WITH_VALIDATION_ERRORS",Pt="RESERVE_PID_STARTED",St="RESERVE_PID_SUCCEEDED",kt="RESERVE_PID_FAILED",Ot="DISCARD_PID_STARTED",Dt="DISCARD_PID_SUCCEEDED",It="DISCARD_PID_FAILED",Ft="FILE_UPLOAD_ADDED",Mt="FILE_UPLOAD_IN_PROGRESS",xt="FILE_UPLOAD_FINISHED",Tt="FILE_UPLOAD_FAILED",_t="FILE_UPLOAD_SAVE_DRAFT_FAILED",qt="FILE_IMPORT_STARTED",zt="FILE_IMPORT_SUCCESS",jt="FILE_IMPORT_FAILED",Lt="FILE_DELETED_SUCCESS",Bt="FILE_DELETE_FAILED",Nt="FILE_UPLOAD_SET_CANCEL_FUNCTION",Ut="FILE_UPLOAD_CANCELLED",Vt="SET_COMMUNITY";function Ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wt(e){return Gt.apply(this,arguments)}function Gt(){return(Gt=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.history.replaceState(void 0,"",t);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Qt=function(){var e=(0,at.A)(lt().mark((function e(t,n){var r,i,a;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!!t.id,e.next=3,n.save(t);case 3:return i=e.sent,!x()(i.errors)&&(a={metadata:t.metadata,custom_fields:t.custom_fields},i.data=st().merge(i.data,a)),r||Wt(i.data.links.self_html),e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function Kt(e,t,n){return Xt.apply(this,arguments)}function Xt(){return(Xt=(0,at.A)(lt().mark((function e(t,n,r){var i,a,o,l,c,s,u,d,p,f,m,h,v,b;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.depositState,a=r.dispatchFn,o=r.failType,l=r.partialValidationActionType,e.prev=1,e.next=4,Qt(t,n,o);case 4:c=e.sent,e.next=12;break;case 7:throw e.prev=7,e.t0=e.catch(1),console.error("Error saving draft",e.t0,t),a({type:o,payload:{errors:e.t0.errors}}),e.t0;case 12:if(s=!x()(c.errors),u=s?c:{},d=i.editorState,p=d.actions,f=p.communityStateMustBeChecked,m=p.shouldDeleteReview,h=p.shouldUpdateReview,v=d.selectedCommunity,!f){e.next=28;break}if(b=c.data,!m){e.next=20;break}return e.next=20,n.deleteReview(b.links);case 20:if(!h){e.next=23;break}return e.next=23,n.createOrUpdateReview(b.links,v.id);case 23:return e.next=25,n.read(b.links);case 25:c=e.sent,a({type:ut,payload:{data:c.data}}),u.data=Yt(Yt({},u.data),c.data);case 28:if(!s){e.next=31;break}throw a({type:l,payload:{data:u.data,errors:u.errors}}),u;case 31:return e.abrupt("return",c);case 32:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}var $t=function(e){return function(){var t=(0,at.A)(lt().mark((function t(n){return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:Vt,payload:{community:e}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};function Jt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Zt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function Zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function en(e){var t=function(e,t){if("object"!=(0,ne.A)(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=(0,ne.A)(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==(0,ne.A)(t)?t:t+""}function tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tn(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var rn={uploading:"uploading",error:"error",finished:"finished",pending:"pending"},an={};const on=function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:an,i=arguments.length>1?arguments[1]:void 0,a=null!==(e=null===(t=i.payload)||void 0===t||null===(t=t.filename)||void 0===t?void 0:t.normalize())&&void 0!==e?e:"";switch(i.type){case Ft:return nn(nn({},r),{},{entries:nn(nn({},r.entries),{},(0,A.A)({},a,{progressPercentage:0,name:a,size:0,status:rn.pending,checksum:null,links:null,cancelUploadFn:null})),actionState:i.type});case Mt:return nn(nn({},r),{},{entries:nn(nn({},r.entries),{},(0,A.A)({},a,nn(nn({},r.entries[a]),{},{progressPercentage:i.payload.percent,status:rn.uploading}))),isFileUploadInProgress:!0,actionState:i.type});case xt:return n=nn(nn({},r),{},{entries:nn(nn({},r.entries),{},(0,A.A)({},a,nn(nn({},r.entries[a]),{},{status:rn.finished,size:i.payload.size,progressPercentage:100,checksum:i.payload.checksum,links:i.payload.links,cancelUploadFn:null})))}),nn(nn({},n),{},{isFileUploadInProgress:Object.values(n.entries).some((function(e){return e.status===rn.uploading})),actionState:i.type});case _t:return nn(nn({},r),{},{errors:nn({},i.payload.errors),actionState:i.type});case Tt:return n=nn(nn({},r),{},{entries:nn(nn({},r.entries),{},(0,A.A)({},a,nn(nn({},r.entries[a]),{},{status:rn.error,cancelUploadFn:null})))}),nn(nn({},n),{},{isFileUploadInProgress:Object.values(n.entries).some((function(e){return e.status===rn.uploading})),actionState:i.type});case Nt:return nn(nn({},r),{},{entries:nn(nn({},r.entries),{},(0,A.A)({},a,nn(nn({},r.entries[a]),{},{cancelUploadFn:i.payload.cancelUploadFn}))),actionState:i.type});case Ut:var o=r.entries,l=(o[a],(0,J.A)(o,[a].map(en)));return nn(nn({},r),{},{entries:nn({},l),isFileUploadInProgress:Object.values(l).some((function(e){return e.status===rn.uploading})),actionState:i.type});case Lt:var c=r.entries,s=(c[a],(0,J.A)(c,[a].map(en)));return nn(nn({},r),{},{entries:nn({},s),isFileUploadInProgress:Object.values(s).some((function(e){return e.status===rn.uploading})),actionState:i.type});case Bt:return nn(nn({},r),{},{actionState:i.type});case qt:return nn(nn({},r),{},{isFileImportInProgress:!0,actionState:i.type});case zt:return nn(nn({},r),{},{entries:nn({},i.payload.files),isFileImportInProgress:!1,actionState:i.type});case jt:return nn(nn({},r),{},{isFileImportInProgress:!1,actionState:i.type});default:return r}};var ln=["onError","record","disabled"],cn=function(e){var t=e.onError,n=e.record,i=e.disabled,a=(0,J.A)(e,ln),o=(0,s.useState)(!1),l=(0,be.A)(o,2),c=l[0],u=l[1],d=function(){var e=(0,at.A)(lt().mark((function e(){var r;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,e.next=4,m.http.post(n.links.versions);case 4:r=e.sent,window.location=r.data.links.self_html,e.next=13;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0),u(!1),t(e.t0.response.data.message);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();return s.createElement(E.A,{content:g.M.t("You don't have permissions to create a new version."),position:"top center",disabled:!i,trigger:s.createElement("span",null,s.createElement(R.A,(0,r.A)({type:"button",positive:!0,size:"mini",onClick:d,loading:c,icon:!0,labelPosition:"left",disabled:i},a),s.createElement(w.A,{name:"tag"}),g.M.t("New version")))})};cn.propTypes={onError:p().func.isRequired,record:p().object.isRequired,disabled:p().bool},cn.defaultProps={disabled:!1};var sn=n(75497),un=n(53959),dn=n(42755),pn=n(2685);function fn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(fn=function(){return!!e})()}var mn=function(e){var t=e.filesLocked;return s.createElement(un.A.Header,null,s.createElement(un.A.Row,null,s.createElement(un.A.HeaderCell,null,g.M.t("Preview")," ",s.createElement(E.A,{content:"Set the default preview",trigger:s.createElement(w.A,{fitted:!0,name:"help circle",size:"small"})})),s.createElement(un.A.HeaderCell,null,g.M.t("Filename")),s.createElement(un.A.HeaderCell,null,g.M.t("Size")),!t&&s.createElement(un.A.HeaderCell,{textAlign:"center"},g.M.t("Progress")),!t&&s.createElement(un.A.HeaderCell,null)))};mn.propTypes={filesLocked:p().bool},mn.defaultProps={filesLocked:!1};var hn=function(e){var t,n,r,i,a,o,l=e.filesLocked,c=e.file,u=e.deleteFile,d=e.defaultPreview,p=e.setDefaultPreview,f=e.decimalSizeDisplay,h=(0,s.useState)(!1),v=(0,be.A)(h,2),b=v[0],y=v[1],A=(0,s.useState)(!1),C=(0,be.A)(A,2),P=C[0],S=C[1],k=d===c.name,O=function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(!0),e.prev=1,e.next=4,u(t);case 4:k&&p(""),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),S(!1),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return s.createElement(un.A.Row,{key:c.name},s.createElement(un.A.Cell,{"data-label":g.M.t("Default preview"),width:2},s.createElement(_.A,{checked:k,onChange:function(){return p(k?"":c.name)}})),s.createElement(un.A.Cell,{"data-label":g.M.t("Filename"),width:10},s.createElement("div",null,c.uploadState.isPending?s.createElement("div",null,c.name):s.createElement("a",{href:pe()(c,"links.content",""),target:"_blank",rel:"noopener noreferrer",className:"mr-5 text-break"},c.name),s.createElement("br",null),c.checksum&&s.createElement("div",{className:"ui text-muted"},s.createElement("span",{style:{fontSize:"10px"}},c.checksum)," ",s.createElement(E.A,{content:g.M.t("This is the file fingerprint (MD5 checksum), which can be used to verify the file integrity."),trigger:s.createElement(w.A,{fitted:!0,name:"help circle",size:"small"}),position:"top center"})))),s.createElement(un.A.Cell,{"data-label":g.M.t("Size"),width:2},c.size?(0,m.humanReadableBytes)(c.size,f):""),!l&&s.createElement(un.A.Cell,{className:"file-upload-pending","data-label":g.M.t("Progress"),width:2},!(null!==(t=c.uploadState)&&void 0!==t&&t.isPending)&&s.createElement(dn.A,{className:"file-upload-progress primary",percent:c.progressPercentage,error:c.uploadState.isFailed,size:"medium",progress:!0,autoSuccess:!0,active:!0}),(null===(n=c.uploadState)||void 0===n?void 0:n.isPending)&&s.createElement("span",null,g.M.t("Pending"))),!l&&s.createElement(un.A.Cell,{textAlign:"right",width:2},((null===(r=c.uploadState)||void 0===r?void 0:r.isFinished)||(null===(i=c.uploadState)||void 0===i?void 0:i.isFailed)||(null===(a=c.uploadState)||void 0===a?void 0:a.isPending))&&(P?s.createElement(w.A,{loading:!0,name:"spinner"}):s.createElement(w.A,{link:!0,className:"action primary",name:"trash alternate outline",disabled:P,onClick:function(){return O(c)},"aria-label":g.M.t("Delete file"),title:g.M.t("Delete file")})),(null===(o=c.uploadState)||void 0===o?void 0:o.isUploading)&&s.createElement(R.A,{compact:!0,type:"button",negative:!0,size:"tiny",disabled:b,onClick:function(){return function(e){y(!0),e.cancelUploadFn()}(c)}},b?s.createElement(w.A,{loading:!0,name:"spinner"}):g.M.t("Cancel"))))};hn.propTypes={filesLocked:p().bool,file:p().object,deleteFile:p().func.isRequired,defaultPreview:p().string,setDefaultPreview:p().func.isRequired,decimalSizeDisplay:p().bool},hn.defaultProps={filesLocked:!1,file:void 0,defaultPreview:void 0,decimalSizeDisplay:!1};var vn=function(e){var t=e.filesLocked,n=e.filesList,r=e.dragText,i=e.uploadButtonIcon,a=e.uploadButtonText,o=e.openFileDialog;return!t&&s.createElement(pn.A,{basic:!0,padded:"very",className:n.length?"file-upload-area":"file-upload-area no-files"},s.createElement(X.A,{columns:3,textAlign:"center"},s.createElement(X.A.Row,{verticalAlign:"middle"},s.createElement(X.A.Column,{mobile:16,tablet:7,computer:7},s.createElement(y.A,{size:"small"},r)),s.createElement(X.A.Column,{className:"mt-10 mb-10",mobile:16,tablet:2,computer:2},"- ",g.M.t("or")," -"),s.createElement(X.A.Column,{mobile:16,tablet:7,computer:7},s.createElement(R.A,{type:"button",primary:!0,labelPosition:"left",icon:i,content:a,onClick:function(){return o()},disabled:null===o})))))};vn.propTypes={filesLocked:p().bool.isRequired,filesList:p().array,dragText:p().string,uploadButtonIcon:p().node,uploadButtonText:p().string,openFileDialog:p().func},vn.defaultProps={filesList:void 0,dragText:void 0,uploadButtonIcon:void 0,uploadButtonText:void 0,openFileDialog:null};var bn=function(e){var t=e.filesLocked,n=e.filesList,r=e.deleteFile,i=e.decimalSizeDisplay,a=(0,f.useFormikContext)(),o=a.setFieldValue,l=a.values,c=pe()(l,"files.default_preview","");return s.createElement(un.A,null,s.createElement(mn,{filesLocked:t}),s.createElement(un.A.Body,null,n.map((function(e){return s.createElement(hn,{key:e.name,filesLocked:t,file:e,deleteFile:r,defaultPreview:c,setDefaultPreview:function(e){return o("files.default_preview",e)},decimalSizeDisplay:i})}))))};bn.propTypes={filesLocked:p().bool,filesList:p().array,deleteFile:p().func,decimalSizeDisplay:p().bool},bn.defaultProps={filesLocked:void 0,filesList:void 0,deleteFile:void 0,decimalSizeDisplay:void 0};var yn=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,fn()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.filesEnabled,i=t.dropzoneParams,a=t.filesList;return n?s.createElement(sn.Ay,i,(function(t){var n=t.getRootProps,i=t.getInputProps,o=t.open;return s.createElement(X.A.Column,{width:16},s.createElement("span",n(),s.createElement("input",i()),0!==a.length&&s.createElement(X.A.Column,{verticalAlign:"middle"},s.createElement(bn,e.props)),s.createElement(vn,(0,r.A)({},e.props,{openFileDialog:o}))))})):s.createElement(X.A.Column,{width:16},s.createElement(pn.A,{basic:!0,padded:"very",className:"file-upload-area no-files"},s.createElement(X.A,{textAlign:"center"},s.createElement(X.A.Row,{verticalAlign:"middle"},s.createElement(X.A.Column,null,s.createElement(y.A,{size:"medium"},g.M.t("This is a Metadata-only record.")))))))}}])}(s.Component);yn.propTypes={deleteFile:p().func,dragText:p().string,dropzoneParams:p().object,filesEnabled:p().bool.isRequired,filesList:p().array,filesLocked:p().bool,links:p().object,setDefaultPreviewFile:p().func,uploadButtonIcon:p().string,uploadButtonText:p().string,decimalSizeDisplay:p().bool},yn.defaultProps={deleteFile:void 0,dragText:void 0,dropzoneParams:void 0,filesList:void 0,filesLocked:!1,links:void 0,setDefaultPreviewFile:void 0,uploadButtonIcon:void 0,uploadButtonText:void 0,decimalSizeDisplay:void 0};var gn=function(e){var t=e.filesList,n=e.filesSize,r=e.filesEnabled,i=e.showMetadataOnlyToggle,a=e.quota,o=e.decimalSizeDisplay,l=(0,f.useFormikContext)().setFieldValue,c=function(){l("files.enabled",!r),l("access.files","public")};return s.createElement(O.default,{id:"ReactInvenioDeposit.FileUploaderToolbar.layout",filesList:t,filesSize:n,filesEnabled:r,showMetadataOnlyToggle:i,quota:a,decimalSizeDisplay:o,handleOnChangeMetadataOnly:c},s.createElement(s.Fragment,null,s.createElement(X.A.Column,{verticalAlign:"middle",floated:"left",mobile:16,tablet:6,computer:6},s.createElement(O.default,{id:"ReactInvenioDeposit.FileUploaderToolbar.MetadataOnlyToggle.container",filesList:t,filesEnabled:r,showMetadataOnlyToggle:i,handleOnChangeMetadataOnly:c},i&&s.createElement(T.A,{horizontal:!0},s.createElement(T.A.Item,null,s.createElement(_.A,{label:g.M.t("Metadata-only record"),onChange:c,disabled:t.length>0,checked:!r})),s.createElement(T.A.Item,null,s.createElement(E.A,{trigger:s.createElement(w.A,{name:"question circle outline",className:"neutral"}),content:g.M.t("Disable files for this record"),position:"top center"}))))),s.createElement(O.default,{id:"ReactInvenioDeposit.FileUploaderToolbar.FileList.container",filesList:t,filesSize:n,filesEnabled:r,quota:a,decimalSizeDisplay:o},r&&s.createElement(X.A.Column,{mobile:16,tablet:10,computer:10,className:"storage-col"},s.createElement(y.A,{size:"tiny",className:"mr-10"},g.M.t("Storage available")),s.createElement(T.A,{horizontal:!0,floated:"right"},s.createElement(T.A.Item,null,s.createElement(ue.A,t.length===a.maxFiles?{color:"blue"}:{},g.M.t("{{length}} out of {{maxfiles}} files",{length:t.length,maxfiles:a.maxFiles}))),s.createElement(T.A.Item,null,s.createElement(ue.A,(0,m.humanReadableBytes)(n,o)===(0,m.humanReadableBytes)(a.maxStorage,o)?{color:"blue"}:{},(0,m.humanReadableBytes)(n,o)," ",g.M.t("out of")," ",(0,m.humanReadableBytes)(a.maxStorage,o))))))))};gn.propTypes={filesList:p().array,filesSize:p().oneOfType([p().number,p().string]),filesEnabled:p().bool.isRequired,quota:p().object,decimalSizeDisplay:p().bool,showMetadataOnlyToggle:p().bool},gn.defaultProps={filesList:void 0,filesSize:void 0,quota:void 0,decimalSizeDisplay:!1,showMetadataOnlyToggle:!0};var An=["config","files","isDraftRecord","hasParentRecord","quota","permissions","record","uploadFiles","deleteFile","importParentFiles","importButtonIcon","importButtonText","isFileImportInProgress","decimalSizeDisplay","filesLocked","allowEmptyFiles"],En=function(e){var t=e.config,n=e.files,i=e.isDraftRecord,a=e.hasParentRecord,o=e.quota,l=e.permissions,c=e.record,u=e.uploadFiles,d=e.deleteFile,p=e.importParentFiles,h=e.importButtonIcon,v=e.importButtonText,b=e.isFileImportInProgress,y=e.decimalSizeDisplay,A=e.filesLocked,E=e.allowEmptyFiles,C=(0,J.A)(e,An),P=(0,f.useFormikContext)().values,S=pe()(P,"files.enabled",!1),k=(0,s.useState)(),D=(0,be.A)(k,2),I=D[0],F=D[1],M=!i&&A,T=Object.values(n).map((function(e){return{name:e.name,size:e.size,checksum:e.checksum,links:e.links,uploadState:{isFailed:e.status===rn.error,isUploading:e.status===rn.uploading,isFinished:e.status===rn.finished,isPending:e.status===rn.pending},progressPercentage:e.progressPercentage,cancelUploadFn:e.cancelUploadFn}})),_=T.reduce((function(e,t){return e+t.size}),0),q={preventDropOnDocument:!0,onDropAccepted:function(e){var t=T.length+e.length>o.maxFiles,n=e.reduce((function(e,t){return e+t.size}),0),r=_+n>o.maxStorage,i=me()(T,"name"),a=new Set(i),l=e.reduce((function(e,t){return a.has(t.name)?e.duplicateFiles.push(t):0===t.size?e.emptyFiles.push(t):e.nonEmptyFiles.push(t),e}),{duplicateFiles:[],emptyFiles:[],nonEmptyFiles:[]}),c=l.duplicateFiles,d=l.emptyFiles,p=l.nonEmptyFiles,f=!x()(d),h=!x()(c);if(t)F(s.createElement("div",{className:"content"},s.createElement(V.A,{warning:!0,icon:"warning circle",header:g.M.t("Could not upload files."),content:g.M.t("Uploading the selected files would result in ".concat(T.length+e.length," files (max.").concat(o.maxFiles,")"))})));else if(r)F(s.createElement("div",{className:"content"},s.createElement(V.A,{warning:!0,icon:"warning circle",header:g.M.t("Could not upload files."),content:s.createElement(s.Fragment,null,g.M.t("Uploading the selected files would result in")," ",(0,m.humanReadableBytes)(_+n,y),g.M.t("but the limit is"),(0,m.humanReadableBytes)(o.maxStorage,y),".")})));else{var v=[];h&&v.push(s.createElement(V.A,{warning:!0,icon:"warning circle",header:g.M.t("The following files already exist"),list:me()(c,"name")})),!E&&f&&v.push(s.createElement(V.A,{warning:!0,icon:"warning circle",header:g.M.t("Could not upload all files."),content:g.M.t("Empty files were skipped."),list:me()(d,"name")})),x()(v)||F(s.createElement("div",{className:"content"},v));var b=E?[].concat((0,Ce.A)(p),(0,Ce.A)(d)):p;x()(b)||u(P,b)}},multiple:!0,noClick:!0,noKeyboard:!0,disabled:!1};T.length<o.maxFiles||(q.disabled=!0);var z=S&&i&&a&&!T.length;return s.createElement(O.default,(0,r.A)({id:"ReactInvenioDeposit.FileUploader.layout",config:t,files:n,isDraftRecord:i,hasParentRecord:a,quota:o,permissions:l,record:c,uploadFiles:u,deleteFile:d,importParentFiles:p,importButtonIcon:h,importButtonText:v,isFileImportInProgress:b,decimalSizeDisplay:y,filesEnabled:S,filesList:T,displayImportBtn:z,filesSize:_,dropzoneParams:q,warningMsg:I,setWarningMsg:F,filesLocked:M},C),s.createElement(s.Fragment,null,s.createElement(X.A,{className:"file-uploader"},s.createElement(X.A.Row,{className:"pt-10 pb-5"},!M&&s.createElement(gn,(0,r.A)({},C,{config:t,filesEnabled:S,filesList:T,filesSize:_,quota:o,decimalSizeDisplay:y}))),s.createElement(O.default,(0,r.A)({id:"ReactInvenioDeposit.FileUploader.ImportButton.container",importButtonIcon:h,importButtonText:v,importParentFiles:p,isFileImportInProgress:b,displayImportBtn:z},C),z&&s.createElement(X.A.Row,{className:"pb-5 pt-5"},s.createElement(X.A.Column,{width:16},s.createElement(V.A,{visible:!0,info:!0},s.createElement("div",{className:"right-floated display-inline-block"},s.createElement(R.A,{type:"button",size:"mini",primary:!0,icon:h,content:v,onClick:function(){return p()},disabled:b,loading:b})),s.createElement("p",{className:"display-inline-block mt-5"},s.createElement(w.A,{name:"info circle"}),g.M.t("You can import files from the previous version.")))))),s.createElement(O.default,(0,r.A)({id:"ReactInvenioDeposit.FileUploader.FileUploaderArea.container",filesList:T,dropzoneParams:q,filesLocked:M,filesEnabled:S,deleteFile:d,decimalSizeDisplay:y},C),S&&s.createElement(X.A.Row,{className:"pt-0 pb-0"},s.createElement(yn,(0,r.A)({},C,{filesList:T,dropzoneParams:q,filesLocked:M,filesEnabled:S,deleteFile:d,decimalSizeDisplay:y})))),s.createElement(O.default,(0,r.A)({id:"ReactInvenioDeposit.FileUploader.NewVersionButton.container",isDraftRecord:i,draft:P,filesLocked:M,permissions:l,record:c},C),i?s.createElement(X.A.Row,{className:"file-upload-note pt-5"},s.createElement(X.A.Column,{width:16},s.createElement(V.A,{visible:!0,warning:!0},s.createElement("p",null,s.createElement(w.A,{name:"warning sign"}),g.M.t("File addition, removal or modification are not allowed after you have published your upload."))))):A&&s.createElement(X.A.Row,{className:"file-upload-note pt-5"},s.createElement(X.A.Column,{width:16},s.createElement(V.A,{info:!0},s.createElement(cn,{record:c,onError:function(){},className:"right-floated",disabled:!l.can_new_version}),s.createElement("p",{className:"mt-5 display-inline-block"},s.createElement(w.A,{name:"info circle",size:"large"}),g.M.t("You must create a new version to add, modify or delete files."))))))),s.createElement(O.default,(0,r.A)({id:"ReactInvenioDeposit.FileUploader.Modal.container",warningMsg:I,setWarningMsg:F},C),s.createElement(Ae.A,{open:!!I,header:"Warning!",content:I,onClose:function(){return F()},closeIcon:!0}))))},wn=p().objectOf(p().shape({name:p().string,size:p().number,progressPercentage:p().number,checksum:p().string,links:p().object,cancelUploadFn:p().func,state:p().oneOf(Object.values(rn)),enabled:p().bool}));En.propTypes={config:p().object,dragText:p().string,files:wn,isDraftRecord:p().bool,hasParentRecord:p().bool,quota:p().shape({maxStorage:p().number,maxFiles:p().number}),record:p().object,uploadButtonIcon:p().string,uploadButtonText:p().string,importButtonIcon:p().string,importButtonText:p().string,isFileImportInProgress:p().bool,importParentFiles:p().func.isRequired,uploadFiles:p().func.isRequired,deleteFile:p().func.isRequired,decimalSizeDisplay:p().bool,filesLocked:p().bool,permissions:p().object,allowEmptyFiles:p().bool},En.defaultProps={permissions:void 0,config:void 0,files:void 0,record:void 0,isFileImportInProgress:!1,dragText:g.M.t("Drag and drop files"),isDraftRecord:!0,hasParentRecord:!1,quota:{maxFiles:5,maxStorage:Math.pow(10,10)},uploadButtonIcon:"upload",uploadButtonText:g.M.t("Upload files"),importButtonIcon:"sync",importButtonText:g.M.t("Import files"),decimalSizeDisplay:!0,filesLocked:!1,allowEmptyFiles:!0};var Rn=(0,u.connect)((function(e){var t,n,r=e.files,i=r.links;return{files:r.entries,links:i,record:e.deposit.record,config:e.deposit.config,permissions:e.deposit.permissions,isFileImportInProgress:e.files.isFileImportInProgress,hasParentRecord:Boolean((null===(t=e.deposit.record)||void 0===t||null===(t=t.versions)||void 0===t?void 0:t.index)&&(null===(n=e.deposit.record)||void 0===n||null===(n=n.versions)||void 0===n?void 0:n.index)>1)}}),(function(e){return{uploadFiles:function(t,n){return e(function(e,t){return function(){var n=(0,at.A)(lt().mark((function n(r,i,a){var o,l,c,s,u;return lt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Qt(e,a.service.drafts);case 3:o=n.sent,r({type:ut,payload:{data:o.data}}),l=o.data.links.files,c=Jt(t);try{for(c.s();!(s=c.n()).done;)u=s.value,a.service.files.upload(l,u)}catch(i){c.e(i)}finally{c.f()}n.next=15;break;case 10:throw n.prev=10,n.t0=n.catch(0),console.error("Error uploading files",n.t0,e,t),r({type:_t,payload:{errors:n.t0.errors}}),n.t0;case 15:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e,t,r){return n.apply(this,arguments)}}()}(t,n))},importParentFiles:function(){return e(function(){var e=(0,at.A)(lt().mark((function e(t,n,r){var i,a,o;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=n().deposit.record).id){e.next=3;break}return e.abrupt("return");case 3:return t({type:qt}),e.prev=4,a=i.links,e.next=8,r.service.files.importParentRecordFiles(a);case 8:o=e.sent,t({type:zt,payload:{files:o}}),e.next=17;break;case 12:throw e.prev=12,e.t0=e.catch(4),console.error("Error importing parent record files",e.t0),t({type:jt}),e.t0;case 17:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t,n,r){return e.apply(this,arguments)}}())},deleteFile:function(t){return e(function(e){return function(){var t=(0,at.A)(lt().mark((function t(n,r,i){var a,o;return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.links,t.next=4,i.service.files.delete(a);case 4:n({type:Lt,payload:{filename:e.name}}),t.next=16;break;case 7:if(t.prev=7,t.t0=t.catch(0),404!==t.t0.response.status||null===(o=e.uploadState)||void 0===o||!o.isPending){t.next=13;break}n({type:Lt,payload:{filename:e.name}}),t.next=16;break;case 13:throw console.error("Error deleting file",t.t0,e),n({type:Bt}),t.t0;case 16:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,n,r){return t.apply(this,arguments)}}()}(t))}}}))(En),Cn={scheme:"",identifier:""};function Pn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Pn=function(){return!!e})()}var Sn=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,Pn()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,r=e.labelIcon,i=e.required,a=e.schemeOptions,o=e.showEmptyValue;return s.createElement(m.ArrayField,{addButtonLabel:g.M.t("Add identifier"),defaultNewValue:Cn,fieldPath:t,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:r,label:n}),required:i,showEmptyValue:o},(function(e){var n=e.arrayHelpers,r=e.indexPath,i="".concat(t,".").concat(r);return s.createElement(m.GroupField,null,s.createElement(m.TextField,{fieldPath:"".concat(i,".identifier"),label:g.M.t("Identifier"),required:!0,width:11}),a&&s.createElement(m.SelectField,{fieldPath:"".concat(i,".scheme"),label:g.M.t("Scheme"),"aria-label":g.M.t("Scheme"),options:a,optimized:!0,required:!0,width:5}),!a&&s.createElement(m.TextField,{fieldPath:"".concat(i,".scheme"),label:g.M.t("Scheme"),"aria-label":g.M.t("Scheme"),required:!0,width:5}),s.createElement(v.A.Field,null,s.createElement(R.A,{"aria-label":g.M.t("Remove field"),className:"close-btn",icon:"close",onClick:function(){return n.remove(r)}})))}))}}])}(s.Component);Sn.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,required:p().bool,schemeOptions:p().arrayOf(p().shape({text:p().string,value:p().string})),showEmptyValue:p().bool},Sn.defaultProps={label:g.M.t("Identifiers"),labelIcon:"barcode",required:!1,schemeOptions:void 0,showEmptyValue:!1};var kn=n(38221),On=n.n(kn),Dn=n(73591),In="SAVE",Fn="PUBLISH",Mn="PUBLISH_WITHOUT_COMMUNITY",xn="PREVIEW",Tn="DELETE",_n="RESERVE_PID",qn="DISCARD_PID",zn="SUBMIT_REVIEW",jn=s.createContext({setSubmitContext:void 0});function Ln(e,t,n){return t=(0,l.A)(t),(0,o.A)(e,Bn()?Reflect.construct(t,n||[],(0,l.A)(e).constructor):t.apply(e,n))}function Bn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Bn=function(){return!!e})()}var Nn="external",Un=function(e,t){return(0,f.getIn)(e.errors,t,null)||(0,f.getIn)(e.initialErrors,t,null)},Vn=function(e){function t(){return(0,i.A)(this,t),Ln(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.handleReservePID,r=e.label,i=e.loading;return s.createElement(f.Field,null,(function(e){var a=e.form;return s.createElement(v.A.Button,{className:"positive",size:"mini",loading:i,disabled:t||i,onClick:function(e){return n(e,a)},content:r})}))}}])}(s.Component);Vn.propTypes={disabled:p().bool,handleReservePID:p().func.isRequired,label:p().string.isRequired,loading:p().bool},Vn.defaultProps={disabled:!1,loading:!1};var Hn=function(e){function t(){return(0,i.A)(this,t),Ln(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.handleDiscardPID,r=e.label,i=e.loading;return s.createElement(E.A,{content:r,trigger:s.createElement(f.Field,null,(function(e){var r=e.form;return s.createElement(v.A.Button,{disabled:t||i,loading:i,icon:"close",onClick:function(e){return n(e,r)},size:"mini"})}))})}}])}(s.Component);Hn.propTypes={disabled:p().bool,handleDiscardPID:p().func.isRequired,label:p().string.isRequired,loading:p().bool},Hn.defaultProps={disabled:!1,loading:!1};var Yn=function(e){function t(){var e;(0,i.A)(this,t);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=Ln(this,t,[].concat(r)),(0,A.A)(e,"handleChange",(function(t,n){var r=n.value;(0,e.props.onManagedUnmanagedChange)("managed"===r)})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.isManagedSelected,r=e.pidLabel;return s.createElement(v.A.Group,{inline:!0},s.createElement(v.A.Field,null,g.M.t("Do you already have a {{pidLabel}} for this upload?",{pidLabel:r})),s.createElement(v.A.Field,{width:2},s.createElement(Dn.A,{label:g.M.t("Yes"),"aria-label":g.M.t("Yes"),name:"radioGroup",value:"unmanaged",disabled:t,checked:!n,onChange:this.handleChange})),s.createElement(v.A.Field,{width:2},s.createElement(Dn.A,{label:g.M.t("No"),"aria-label":g.M.t("No"),name:"radioGroup",value:"managed",disabled:t,checked:n,onChange:this.handleChange})))}}])}(s.Component);Yn.propTypes={disabled:p().bool,isManagedSelected:p().bool.isRequired,onManagedUnmanagedChange:p().func.isRequired,pidLabel:p().string},Yn.defaultProps={disabled:!1,pidLabel:void 0};var Wn=function(e){function t(){var e;(0,i.A)(this,t);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=Ln(this,t,[].concat(r)),(0,A.A)(e,"handleReservePID",(function(t,n){var r=e.props.pidType;(0,e.context.setSubmitContext)(_n,{pidType:r}),n.handleSubmit(t)})),(0,A.A)(e,"handleDiscardPID",(function(t,n){var r=e.props.pidType;(0,e.context.setSubmitContext)(qn,{pidType:r}),n.handleSubmit(t)})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.actionState,n=e.actionStateExtra,r=e.btnLabelDiscardPID,i=e.btnLabelGetPID,a=e.disabled,o=e.helpText,l=e.identifier,c=e.pidPlaceholder,u=e.pidType,d=""!==l,p=s.createElement(Vn,{disabled:a||d,label:i,loading:t===Pt&&n.pidType===u,handleReservePID:this.handleReservePID}),f=s.createElement(Hn,{disabled:a,label:r,handleDiscardPID:this.handleDiscardPID,loading:t===Ot&&n.pidType===u,pidType:u});return s.createElement(s.Fragment,null,s.createElement(v.A.Group,{inline:!0},d?s.createElement(v.A.Field,null,s.createElement("label",null,l)):s.createElement(v.A.Field,{width:4},s.createElement(v.A.Input,{disabled:!0,value:"",placeholder:c,width:16})),s.createElement(v.A.Field,null,l?f:p)),o&&s.createElement("label",{className:"helptext"},o))}}])}(s.Component);(0,A.A)(Wn,"contextType",jn),Wn.propTypes={btnLabelGetPID:p().string.isRequired,disabled:p().bool,helpText:p().string,identifier:p().string.isRequired,btnLabelDiscardPID:p().string.isRequired,pidPlaceholder:p().string.isRequired,pidType:p().string.isRequired,actionState:p().string,actionStateExtra:p().object},Wn.defaultProps={disabled:!1,helpText:null,actionState:"",actionStateExtra:{}};var Gn=(0,u.connect)((function(e){return{actionState:e.deposit.actionState,actionStateExtra:e.deposit.actionStateExtra}}),null)(Wn),Qn=function(e){function t(e){var n;(0,i.A)(this,t),n=Ln(this,t,[e]),(0,A.A)(n,"handleIdentifierUpdate",(function(e){n.setState({localIdentifier:e})})),(0,A.A)(n,"onChange",(function(e){var t=n.props.onIdentifierChanged;n.setState({localIdentifier:e},(function(){return t(e)}))}));var r=e.identifier;return n.state={localIdentifier:r},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.identifier;t!==e.identifier&&this.handleIdentifierUpdate(t)}},{key:"render",value:function(){var e=this,t=this.state.localIdentifier,n=this.props,r=n.form,i=n.fieldPath,a=n.helpText,o=n.pidPlaceholder,l=Un(r,i);return s.createElement(s.Fragment,null,s.createElement(v.A.Field,{width:8,error:l},s.createElement(v.A.Input,{onChange:function(t,n){var r=n.value;return e.onChange(r)},value:t,placeholder:o,width:16,error:l})),a&&s.createElement("label",{className:"helptext"},a))}}])}(s.Component);Qn.propTypes={form:p().object.isRequired,fieldPath:p().string.isRequired,helpText:p().string,identifier:p().string.isRequired,onIdentifierChanged:p().func.isRequired,pidPlaceholder:p().string.isRequired},Qn.defaultProps={helpText:null};var Kn=function(e){function t(e){var n;(0,i.A)(this,t),n=Ln(this,t,[e]),(0,A.A)(n,"onExternalIdentifierChanged",(function(e){var t=n.props,r=t.form,i=t.fieldPath,a={identifier:e,provider:Nn};n.debounced&&n.debounced.cancel(),n.debounced=On()((function(){r.setFieldValue(i,a)}),200),n.debounced()}));var r=n.props,a=r.canBeManaged,o=r.canBeUnmanaged;return n.canBeManagedAndUnmanaged=a&&o,n.state={isManagedSelected:void 0},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e,t=this,n=this.state.isManagedSelected,r=this.props,i=r.btnLabelDiscardPID,a=r.btnLabelGetPID,o=r.canBeManaged,l=r.canBeUnmanaged,c=r.form,u=r.fieldPath,d=r.fieldLabel,p=r.isEditingPublishedRecord,f=r.managedHelpText,h=r.pidLabel,b=r.pidIcon,y=r.pidPlaceholder,g=r.required,A=r.unmanagedHelpText,E=r.pidType,w=r.field,R=r.record,C=w.value||{},P=C.identifier||"",S=C.provider||"",k="",O="";if(""!==P){var D=S===Nn;k=D?"":P,O=D?P:""}var I=""!==k,F=void 0===n?I||""===S:n,M=""!==((null===R||void 0===R||null===(e=R.pids)||void 0===e||null===(e=e.doi)||void 0===e?void 0:e.identifier)||""),x=""!==P,T=Un(c,u);return s.createElement(s.Fragment,null,s.createElement(v.A.Field,{required:g,error:T},s.createElement(m.FieldLabel,{htmlFor:u,icon:b,label:d})),this.canBeManagedAndUnmanaged&&s.createElement(Yn,{disabled:(p||I)&&(M||x),isManagedSelected:F,onManagedUnmanagedChange:function(e){e?c.setFieldValue("pids",{}):t.onExternalIdentifierChanged(""),t.setState({isManagedSelected:e})},pidLabel:h}),o&&F&&s.createElement(Gn,{disabled:M&&p,btnLabelDiscardPID:i,btnLabelGetPID:a,form:c,identifier:k,helpText:f,pidPlaceholder:y,pidType:E,pidLabel:h}),l&&!F&&s.createElement(Qn,{identifier:O,onIdentifierChanged:function(e){t.onExternalIdentifierChanged(e)},form:c,fieldPath:u,pidPlaceholder:y,helpText:A}))}}])}(s.Component);Kn.propTypes={field:p().object,form:p().object.isRequired,btnLabelDiscardPID:p().string.isRequired,btnLabelGetPID:p().string.isRequired,canBeManaged:p().bool.isRequired,canBeUnmanaged:p().bool.isRequired,fieldPath:p().string.isRequired,fieldLabel:p().string.isRequired,isEditingPublishedRecord:p().bool.isRequired,managedHelpText:p().string,pidIcon:p().string.isRequired,pidLabel:p().string.isRequired,pidPlaceholder:p().string.isRequired,pidType:p().string.isRequired,required:p().bool.isRequired,unmanagedHelpText:p().string,record:p().object.isRequired},Kn.defaultProps={managedHelpText:null,unmanagedHelpText:null,field:void 0};var Xn=function(e){function t(e){var n;return(0,i.A)(this,t),n=Ln(this,t,[e]),(0,A.A)(n,"validatePropValues",(function(){var e=n.props,t=e.canBeManaged,r=e.canBeUnmanaged,i=e.fieldPath;if(!t&&!r)throw Error("".concat(i," must be managed, unmanaged or both."))})),n.validatePropValues(),n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props.fieldPath;return s.createElement(f.FastField,(0,r.A)({name:e,component:Kn},this.props))}}])}(s.Component);Xn.propTypes={btnLabelDiscardPID:p().string,btnLabelGetPID:p().string,canBeManaged:p().bool,canBeUnmanaged:p().bool,fieldPath:p().string.isRequired,fieldLabel:p().string.isRequired,isEditingPublishedRecord:p().bool.isRequired,managedHelpText:p().string,pidIcon:p().string,pidLabel:p().string.isRequired,pidPlaceholder:p().string,pidType:p().string.isRequired,required:p().bool,unmanagedHelpText:p().string,record:p().object.isRequired},Xn.defaultProps={btnLabelDiscardPID:"Discard",btnLabelGetPID:"Reserve",canBeManaged:!0,canBeUnmanaged:!0,managedHelpText:null,pidIcon:"barcode",pidPlaceholder:"",required:!1,unmanagedHelpText:null};var $n=n(98871),Jn=n(73083),Zn=function(e){var t=e.updateQueryFilters,n=e.userSelectionFilters,r=e.filterValue,i=e.label,a=e.title,o=function(){t(n.concat([r]))},l=function(e){var t=e.filter((function(e){return e[1]===r[1]})).length>0;return t}(n);return l?s.createElement(Jn.A.Item,{name:i,active:!0,as:R.A,primary:!0,onClick:o},a):s.createElement(Jn.A.Item,{name:i,onClick:o},a)};Zn.propTypes={updateQueryFilters:p().func.isRequired,userSelectionFilters:p().array.isRequired,filterValue:p().array.isRequired,label:p().string.isRequired,title:p().string.isRequired};var er=n(23848),tr=(0,$n.Q2)((function(e){var t=e.currentResultsState,n=e.serializeLicenses,i=n||function(e){return{title:e.title_l10n,description:e.description_l10n,id:e.id}};return s.createElement(f.FastField,{name:"selectedLicense"},(function(e){var n=e.form,a=n.values,o=n.setFieldValue;return s.createElement(er.A.Group,null,t.data.hits.map((function(e){var t=e.title_l10n,n=e.description_l10n;return s.createElement(er.A,{key:t,onClick:function(){return o("selectedLicense",i(e))},className:"license-item mb-15"},s.createElement(Dn.A,(0,r.A)({checked:pe()(a,"selectedLicense.title")===t,onChange:function(){return o("selectedLicense",i(e))}},!n&&{className:"mt-0"})),s.createElement(er.A.Content,{className:"license-item-content"},s.createElement(y.A,{size:"small",className:"mt-0"},t),n&&s.createElement(er.A.Description,{className:"license-item-description"},n)))})))}))})),nr=n(92257);function rr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ir(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rr(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ar(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ar=function(){return!!e})()}var or=function(e){var t=e.updateQueryState,n=e.currentQueryState,r=e.autofocus,i=e.actionProps,a=e.placeholder,o=(0,s.useState)(""),l=(0,be.A)(o,2),c=l[0],u=l[1],d=function(){n.filters[0]=["tags","all"],n.queryString=c,t(n)};return s.createElement(lr,{actionProps:i,autofocus:r,executeSearch:d,onBtnSearchClick:d,onInputChange:function(e){u(e)},onKeyPress:function(e){"Enter"===e.key&&d()},placeholder:a,queryString:c})};or.propTypes={actionProps:p().object,autofocus:p().bool,currentQueryState:p().object,updateQueryState:p().func,placeholder:p().string},or.defaultProps={actionProps:null,autofocus:!1,placeholder:"",currentQueryState:null,updateQueryState:null};var lr=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,ar()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"componentDidMount",value:function(){this.props.autofocus&&this.focusInput&&this.focusInput.focus()}},{key:"render",value:function(){var e=this,t=this.props,n=t.actionProps,r=t.onBtnSearchClick,i=t.onInputChange,a=t.onKeyPress,o=t.placeholder,l=t.queryString;return s.createElement(nr.A,{action:ir({content:"Search",onClick:r},n),fluid:!0,placeholder:o||"Type something",onChange:function(e,t){var n=t.value;i(n)},value:l,onKeyPress:a,ref:function(t){e.focusInput=t}})}}])}(s.Component);lr.propTypes={actionProps:p().object,autofocus:p().bool,onBtnSearchClick:p().func,onInputChange:p().func,onKeyPress:p().func,placeholder:p().string,queryString:p().string},lr.defaultProps={actionProps:null,autofocus:!1,onBtnSearchClick:null,onInputChange:null,onKeyPress:null,placeholder:"",queryString:""};var cr=(0,$n.Q2)(or);function sr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(sr=function(){return!!e})()}var ur={"SearchFilters.Toggle":Zn},dr="standard",pr="custom",fr="add",mr=Ee.Ik().shape({selectedLicense:Ee.Ik().shape({title:Ee.Yj().required(g.M.t("Title is a required field.")),link:Ee.Yj().url(g.M.t("Link must be a valid URL"))})}),hr=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,sr()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"state",{open:!1}),(0,A.A)(e,"openModal",(function(){e.setState({open:!0})})),(0,A.A)(e,"closeModal",(function(){e.setState({open:!1})})),(0,A.A)(e,"onSubmit",(function(t,n){var r=e.props.onLicenseChange;e.closeModal(),r(t.selectedLicense),n.resetForm()})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.mode,r=t.trigger,i=t.action,a=t.searchConfig,o=t.serializeLicenses,l=t.initialLicense,c=this.state.open,u=l||{title:"",description:"",id:null,link:""},d=new $n.HZ(a.searchApi);return s.createElement(f.Formik,{initialValues:{selectedLicense:u},onSubmit:this.onSubmit,validationSchema:mr,validateOnChange:!1,validateOnBlur:!1},(function(t){var l=t.handleSubmit,u=t.resetForm;return s.createElement(Ae.A,{onOpen:function(){return e.openModal()},open:c,trigger:r,onClose:function(){e.closeModal(),u()},closeIcon:!0,closeOnDimmerClick:!1},s.createElement(Ae.A.Header,{as:"h2",className:"pt-10 pb-10"},i===fr?g.M.t("Add {{mode}} license",{mode:n}):g.M.t("Change {{mode}} license",{mode:n})),s.createElement(Ae.A.Content,{scrolling:!0},n===dr&&s.createElement(O.OverridableContext.Provider,{value:ur},s.createElement($n.gz,{searchApi:d,appName:"licenses",urlHandlerApi:{enabled:!1},initialQueryState:a.initialQueryState},s.createElement(X.A,null,s.createElement(X.A.Row,null,s.createElement(X.A.Column,{width:8,floated:"left",verticalAlign:"middle"},s.createElement(cr,{placeholder:g.M.t("Search"),autofocus:!0,actionProps:{icon:"search",content:null,className:"search"}})),s.createElement(X.A.Column,{width:8,textAlign:"right",floated:"right"},s.createElement(Jn.A,{compact:!0},s.createElement($n.lM,{title:g.M.t("Recommended"),label:"recommended",filterValue:["tags","recommended"]}),s.createElement($n.lM,{title:g.M.t("All"),label:"all",filterValue:["tags","all"]}),s.createElement($n.lM,{title:g.M.t("Data"),label:"data",filterValue:["tags","data"]}),s.createElement($n.lM,{title:g.M.t("Software"),label:"software",filterValue:["tags","software"]})))),s.createElement(X.A.Row,{verticalAlign:"middle"},s.createElement(X.A.Column,null,s.createElement($n.oK,null,s.createElement($n.i6,null),s.createElement($n.$D,null),s.createElement(tr,o&&{serializeLicenses:o}))))))),n===pr&&s.createElement(v.A,null,s.createElement(m.TextField,{label:g.M.t("Title"),placeholder:g.M.t("License title"),fieldPath:"selectedLicense.title",required:!0,autoFocus:!0}),s.createElement(m.TextAreaField,{fieldPath:"selectedLicense.description",label:g.M.t("Description")}),s.createElement(m.TextField,{label:g.M.t("Link"),placeholder:g.M.t("License link"),fieldPath:"selectedLicense.link"}))),s.createElement(Ae.A.Actions,null,s.createElement(R.A,{name:"cancel",onClick:function(){u(),e.closeModal()},icon:"remove",labelPosition:"left",content:g.M.t("Cancel"),floated:"left"}),s.createElement(R.A,{name:"submit",onClick:function(e){return l(e)},primary:!0,icon:"checkmark",labelPosition:"left",content:i===fr?g.M.t("Add license"):g.M.t("Change license")})))}))}}])}(s.Component);hr.propTypes={mode:p().oneOf(["standard","custom"]).isRequired,action:p().oneOf(["add","edit"]).isRequired,initialLicense:p().shape({id:p().string,title:p().string,description:p().string}),trigger:p().object.isRequired,onLicenseChange:p().func.isRequired,searchConfig:p().shape({searchApi:p().shape({axios:p().shape({headers:p().object})}).isRequired,initialQueryState:p().shape({filters:p().arrayOf(p().array)}).isRequired}).isRequired,serializeLicenses:p().func},hr.defaultProps={initialLicense:void 0,serializeLicenses:void 0};var vr=n(92516),br=n.n(vr),yr=function(e){var t=e.license,n=e.moveLicense,r=e.replaceLicense,i=e.removeLicense,a=e.searchConfig,o=e.serializeLicenses,l=s.useRef(null),c=(0,je.i)({item:{index:t.index,type:"license"}}),u=(0,be.A)(c,3),d=u[1],p=u[2],f=(0,Le.H)({accept:"license",hover:function(e,r){if(l.current){var i=e.index,a=t.index;i!==a&&r.isOver({shallow:!0})&&(n(i,a),e.index=a)}},collect:function(e){return{hidden:e.isOver({shallow:!0})}}}),m=(0,be.A)(f,2),h=m[0].hidden;return(0,m[1])(l),s.createElement(Be.o,{innerRef:l,key:t.key},s.createElement(T.A.Item,{key:t.key,className:h?"deposit-drag-listitem hidden":"deposit-drag-listitem"},s.createElement(T.A.Content,{floated:"right"},s.createElement(hr,{searchConfig:a,onLicenseChange:function(e){r(t.index,e)},mode:t.type,initialLicense:t.initial,action:"edit",trigger:s.createElement(R.A,{size:"mini",primary:!0,type:"button"},g.M.t("Edit")),serializeLicenses:o}),s.createElement(R.A,{size:"mini",type:"button",onClick:function(){i(t.index)}},g.M.t("Remove"))),s.createElement(Be.o,{innerRef:d},s.createElement(T.A.Icon,{name:"bars",className:"drag-anchor"})),s.createElement(Be.o,{innerRef:p},s.createElement(T.A.Content,null,s.createElement(T.A.Header,null,t.title),t.description&&s.createElement(T.A.Description,null,br()(t.description,{length:300})),t.link&&s.createElement("span",null,s.createElement("a",{href:t.link,target:"_blank",rel:"noopener noreferrer"},t.description&&s.createElement("span",null,"\xa0"),g.M.t("Read more")))))))};function gr(e,t,n){return t=(0,l.A)(t),(0,o.A)(e,Ar()?Reflect.construct(t,n||[],(0,l.A)(e).constructor):t.apply(e,n))}function Ar(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ar=function(){return!!e})()}yr.propTypes={license:p().object.isRequired,moveLicense:p().func.isRequired,replaceLicense:p().func.isRequired,removeLicense:p().func.isRequired,searchConfig:p().object.isRequired,serializeLicenses:p().func},yr.defaultProps={serializeLicenses:void 0};var Er=(0,a.A)((function e(t,n,r){(0,i.A)(this,e),this.index=r,this.type=n.id?"standard":"custom",this.key=n.id||n.title,this.initial="custom"===this.type?n:null;var a=ge()(t,n.id?function(e){return e.id===n.id}:function(e){return e.title===n.title})||{};this.description=a.description_l10n||n.description||"",this.title=a.title_l10n||n.title||"",this.link=a.props&&a.props.url||a.link||n.props&&n.props.url||n.link||""})),wr=function(e){function t(){return(0,i.A)(this,t),gr(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.label,n=e.labelIcon,r=e.fieldPath,i=e.uiFieldPath,a=e.form.values,o=e.move,l=e.push,c=e.remove,u=e.replace,d=e.required,p=e.searchConfig,h=e.serializeLicenses,b=(0,f.getIn)(a,i,[]);return s.createElement(ve.Q,{backend:he.t2},s.createElement(v.A.Field,{required:d},s.createElement(m.FieldLabel,{htmlFor:r,icon:n,label:t}),s.createElement(T.A,null,(0,f.getIn)(a,r,[]).map((function(e,t){var n=new Er(b,e,t);return s.createElement(yr,{key:n.key,license:n,moveLicense:o,replaceLicense:u,removeLicense:c,searchConfig:p,serializeLicenses:h})}))),s.createElement(hr,{searchConfig:p,trigger:s.createElement(R.A,{type:"button",key:"standard",icon:!0,labelPosition:"left"},s.createElement(w.A,{name:"add"}),g.M.t("Add standard")),onLicenseChange:function(e){l(e)},mode:"standard",action:"add",serializeLicenses:h}),s.createElement(hr,{searchConfig:p,trigger:s.createElement(R.A,{type:"button",key:"custom",icon:!0,labelPosition:"left"},s.createElement(w.A,{name:"add"}),g.M.t("Add custom")),onLicenseChange:function(e){l(e)},mode:"custom",action:"add"})))}}])}(s.Component);wr.propTypes={label:p().node.isRequired,labelIcon:p().node,fieldPath:p().string.isRequired,uiFieldPath:p().string,form:p().object.isRequired,move:p().func.isRequired,push:p().func.isRequired,remove:p().func.isRequired,replace:p().func.isRequired,required:p().bool.isRequired,searchConfig:p().object.isRequired,serializeLicenses:p().func},wr.defaultProps={labelIcon:void 0,uiFieldPath:void 0,serializeLicenses:void 0};var Rr=function(e){function t(){return(0,i.A)(this,t),gr(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props.fieldPath;return s.createElement(f.FieldArray,{name:t,component:function(t){return s.createElement(wr,(0,r.A)({},t,e.props))}})}}])}(s.Component);function Cr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Cr=function(){return!!e})()}Rr.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,searchConfig:p().object.isRequired,required:p().bool,serializeLicenses:p().func,uiFieldPath:p().string},Rr.defaultProps={label:g.M.t("Licenses"),uiFieldPath:"ui.rights",labelIcon:"drivers license",required:!1,serializeLicenses:void 0};var Pr=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,Cr()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.helpText,r=e.label,i=e.labelIcon,a=e.placeholder,o=e.required;return s.createElement(m.TextField,{fieldPath:t,helpText:n,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:i,label:r}),placeholder:a,required:o})}}])}(s.Component);function Sr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Sr=function(){return!!e})()}Pr.propTypes={fieldPath:p().string.isRequired,helpText:p().string,label:p().string,labelIcon:p().string,placeholder:p().string,required:p().bool},Pr.defaultProps={helpText:g.M.t("In case your upload was already published elsewhere, please use the date of the first publication. Format: YYYY-MM-DD, YYYY-MM, or YYYY. For intervals use DATE/DATE, e.g. 1939/1945."),label:g.M.t("Publication date"),labelIcon:"calendar",required:void 0,placeholder:g.M.t("YYYY-MM-DD or YYYY-MM-DD/YYYY-MM-DD for intervals. MM and DD are optional.")};var kr=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,Sr()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,r=e.labelIcon,i=e.placeholder;return s.createElement(m.TextField,{fieldPath:t,helpText:g.M.t("The publisher is used to formulate the citation, so consider the prominence of the role."),label:s.createElement(m.FieldLabel,{htmlFor:t,icon:r,label:n}),placeholder:i})}}])}(s.Component);kr.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,placeholder:p().string},kr.defaultProps={label:g.M.t("Publisher"),labelIcon:"building outline",placeholder:g.M.t("Publisher")};var Or={reference:""};function Dr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Dr=function(){return!!e})()}var Ir=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,Dr()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,r=e.labelIcon,i=e.required,a=e.showEmptyValue;return s.createElement(m.ArrayField,{addButtonLabel:g.M.t("Add reference"),defaultNewValue:Or,fieldPath:t,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:r,label:n}),required:i,showEmptyValue:a},(function(e){var n=e.arrayHelpers,r=e.indexPath,i="".concat(t,".").concat(r);return s.createElement(m.GroupField,{optimized:!0},s.createElement(m.TextField,{fieldPath:"".concat(i,".reference"),label:g.M.t("Reference string"),required:!0,width:16}),s.createElement(v.A.Field,null,s.createElement(R.A,{"aria-label":g.M.t("Remove field"),className:"close-btn",icon:!0,onClick:function(){return n.remove(r)}},s.createElement(w.A,{name:"close"}))))}))}}])}(s.Component);Ir.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,required:p().bool,showEmptyValue:p().bool},Ir.defaultProps={label:g.M.t("References"),labelIcon:"bookmark",required:!1,showEmptyValue:!1};var Fr={scheme:"",identifier:"",resource_type:"",relation_type:""},Mr=["fieldPath","label","labelIcon","options"];function xr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xr(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _r(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_r=function(){return!!e})()}var qr=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,_r()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"groupErrors",(function(e,t){var n=pe()(e,t);return n?{content:n}:null})),(0,A.A)(e,"_label",(function(e){return e.type_name+(e.subtype_name?" / "+e.subtype_name:"")})),(0,A.A)(e,"createOptions",(function(t){return t.map((function(t){return Tr(Tr({},t),{},{label:e._label(t)})})).sort((function(e,t){return e.label.localeCompare(t.label)})).map((function(e){return{value:e.id,icon:e.icon,text:e.label}}))})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,i=e.labelIcon,a=e.options,o=(0,J.A)(e,Mr),l=this.createOptions(a);return s.createElement(m.SelectField,(0,r.A)({fieldPath:t,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:i,label:n}),optimized:!0,"aria-label":n,options:l,selectOnBlur:!1},o))}}])}(s.Component);function zr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(zr=function(){return!!e})()}qr.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,labelclassname:p().string,options:p().arrayOf(p().shape({icon:p().string,type_name:p().string,subtype_name:p().string,id:p().string})).isRequired,required:p().bool},qr.defaultProps={label:g.M.t("Resource type"),labelIcon:"tag",labelclassname:"field-label-class",required:!1};var jr=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,zr()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,r=e.labelIcon,i=e.required,a=e.options,o=e.showEmptyValue;return s.createElement(s.Fragment,null,s.createElement("label",{className:"helptext",style:{marginBottom:"10px"}},g.M.t("Specify identifiers of related works. Supported identifiers include DOI, Handle, ARK, PURL, ISSN, ISBN, PubMed ID, PubMed Central ID, ADS Bibliographic Code, arXiv, Life Science Identifiers (LSID), EAN-13, ISTC, URNs, and URLs.")),s.createElement(m.ArrayField,{addButtonLabel:g.M.t("Add related work"),defaultNewValue:Fr,fieldPath:t,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:r,label:n}),required:i,showEmptyValue:o},(function(e){var n=e.arrayHelpers,r=e.indexPath,i="".concat(t,".").concat(r);return s.createElement(m.GroupField,{optimized:!0},s.createElement(m.SelectField,{clearable:!0,fieldPath:"".concat(i,".relation_type"),label:g.M.t("Relation"),"aria-label":g.M.t("Relation"),optimized:!0,options:a.relations,placeholder:{role:"option",content:"Select relation..."},required:!0,width:3}),s.createElement(m.TextField,{fieldPath:"".concat(i,".identifier"),label:g.M.t("Identifier"),required:!0,width:4}),s.createElement(m.SelectField,{clearable:!0,fieldPath:"".concat(i,".scheme"),label:g.M.t("Scheme"),"aria-label":g.M.t("Scheme"),optimized:!0,options:a.scheme,required:!0,width:2}),s.createElement(qr,{clearable:!0,fieldPath:"".concat(i,".resource_type"),labelIcon:"",options:a.resource_type,width:7,labelclassname:"small field-label-class"}),s.createElement(v.A.Field,null,s.createElement(R.A,{"aria-label":g.M.t("Remove field"),className:"close-btn",icon:!0,onClick:function(){return n.remove(r)}},s.createElement(w.A,{name:"close"}))))})))}}])}(s.Component);jr.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,required:p().bool,options:p().object.isRequired,showEmptyValue:p().bool},jr.defaultProps={label:g.M.t("Related works"),labelIcon:"barcode",required:void 0,showEmptyValue:!1};var Lr=["fieldPath","label","labelIcon","limitToOptions"];function Br(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Br=function(){return!!e})()}var Nr=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,Br()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"state",{limitTo:"all"}),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.fieldPath,i=t.label,a=t.labelIcon,o=t.limitToOptions,l=(0,J.A)(t,Lr),c=this.state.limitTo,u=o.length>2;return s.createElement(m.GroupField,{className:"main-group-field"},u&&s.createElement(v.A.Field,{width:5,className:"subjects-field"},s.createElement(m.FieldLabel,{htmlFor:n,icon:a,label:i}),s.createElement(m.GroupField,null,s.createElement(v.A.Field,{width:8,style:{marginBottom:"auto",marginTop:"auto"},className:"p-0"},g.M.t("Suggest from")),s.createElement(v.A.Dropdown,{className:"p-0",defaultValue:o[0].value,fluid:!0,"aria-label":g.M.t("Suggest from"),onChange:function(t,n){return e.setState({limitTo:n.value})},options:o,selection:!0,width:8}))),s.createElement(m.SubjectAutocompleteDropdown,(0,r.A)({},l,{fieldPath:n,label:!u&&s.createElement(m.FieldLabel,{htmlFor:n,icon:a,label:i}),limitTo:c,width:u?11:16})))}}])}(s.Component);Nr.propTypes={limitToOptions:p().array.isRequired,fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,placeholder:p().string},Nr.defaultProps={label:g.M.t("Keywords and subjects"),labelIcon:"tag",placeholder:g.M.t("Search for a subject by name")};var Ur={lang:"",title:"",type:"alternative-title"};function Vr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Vr=function(){return!!e})()}var Hr=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,Vr()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.options,r=e.recordUI;return s.createElement(m.ArrayField,{addButtonLabel:g.M.t("Add titles"),defaultNewValue:Ur,fieldPath:t,className:"additional-titles"},(function(e){var i,a=e.arrayHelpers,o=e.indexPath,l="".concat(t,".").concat(o);return s.createElement(m.GroupField,{fieldPath:t,optimized:!0},s.createElement(m.TextField,{fieldPath:"".concat(l,".title"),label:"Additional title",required:!0,width:5}),s.createElement(m.SelectField,{fieldPath:"".concat(l,".type"),label:"Type",optimized:!0,options:n.type,required:!0,width:5}),s.createElement(te,{serializeSuggestions:function(e){return e.map((function(e){return{text:e.title_l10n,value:e.id,fieldPathPrefix:e.id}}))},initialOptions:null!==r&&void 0!==r&&r.additional_titles&&null!==(i=r.additional_titles[o])&&void 0!==i&&i.lang?[r.additional_titles[o].lang]:[],fieldPath:"".concat(l,".lang"),label:"Language",multiple:!1,placeholder:"Select language",labelIcon:null,clearable:!0,selectOnBlur:!1,width:5}),s.createElement(v.A.Field,null,s.createElement(R.A,{"aria-label":g.M.t("Remove field"),className:"close-btn",icon:!0,onClick:function(){return a.remove(o)}},s.createElement(w.A,{name:"close"}))))}))}}])}(s.Component);function Yr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Yr=function(){return!!e})()}Hr.propTypes={fieldPath:p().string.isRequired,options:p().shape({type:p().arrayOf(p().shape({icon:p().string,text:p().string,value:p().string})),lang:p().arrayOf(p().shape({text:p().string,value:p().string}))}),recordUI:p().object},Hr.defaultProps={options:void 0,recordUI:void 0};var Wr=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,Yr()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.options,r=e.label,i=e.required,a=e.recordUI;return s.createElement(s.Fragment,null,s.createElement(m.TextField,{fieldPath:t,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:"book",label:r}),required:i,className:"title-field",optimized:!0}),s.createElement(Hr,{options:n,recordUI:a,fieldPath:"metadata.additional_titles"}))}}])}(s.Component);function Gr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Gr=function(){return!!e})()}Wr.propTypes={fieldPath:p().string.isRequired,label:p().string,options:p().shape({type:p().arrayOf(p().shape({icon:p().string,text:p().string,value:p().string})),lang:p().arrayOf(p().shape({text:p().string,value:p().string}))}).isRequired,required:p().bool,recordUI:p().object},Wr.defaultProps={label:g.M.t("Title"),required:!1,recordUI:void 0};var Qr=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,Gr()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,r=e.labelIcon,i=e.placeholder,a=s.createElement("span",null,s.createElement(N.x,null,"Mostly relevant for software and dataset uploads. A semantic version string is preferred see",s.createElement("a",{href:"https://semver.org/",target:"_blank",rel:"noopener noreferrer"}," ","semver.org"),", but any version string is accepted."));return s.createElement(m.TextField,{fieldPath:t,helpText:a,label:s.createElement(m.FieldLabel,{htmlFor:t,icon:r,label:n}),placeholder:i})}}])}(s.Component);function Kr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Kr=function(){return!!e})()}Qr.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string,placeholder:p().string},Qr.defaultProps={label:g.M.t("Version"),labelIcon:"code branch",placeholder:""};var Xr=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,Kr()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.label,r=e.labelIcon;return s.createElement(v.A.Field,{id:t,name:t},s.createElement(m.FieldLabel,{htmlFor:t,icon:r,label:n}),s.createElement(pn.A,{size:"massive",tertiary:!0,textAlign:"center"},"Coming soon"))}}])}(s.Component);Xr.propTypes={fieldPath:p().string.isRequired,label:p().string,labelIcon:p().string},Xr.defaultProps={label:void 0,labelIcon:void 0};var $r=n(90179),Jr=n.n($r),Zr=n(92411),ei=n.n(Zr),ti=["draftExists","isPublished","isVersion","actionState","formik"];function ni(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ni=function(){return!!e})()}var ri=g.M.t("discard changes"),ii=g.M.t("discard version"),ai=g.M.t("delete"),oi=g.M.t("Are you sure you want to discard the changes to this draft?"),li=g.M.t("Are you sure you want to delete this new version?"),ci=g.M.t("Are you sure you want to delete this draft?"),si=function(e){var t="";switch(e.actionLbl){case ri:t=oi;break;case ii:t=li;break;case ai:t=ci}return t},ui=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,ni()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"state",{modalOpen:!1}),(0,A.A)(e,"openConfirmModal",(function(){return e.setState({modalOpen:!0})})),(0,A.A)(e,"closeConfirmModal",(function(){return e.setState({modalOpen:!1})})),(0,A.A)(e,"handleDelete",function(){var t=(0,at.A)(lt().mark((function t(n){var r,i,a,o,l;return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.props,i=r.isPublished,a=r.isVersion,o=r.formik,l=o.handleSubmit,(0,e.context.setSubmitContext)(Tn,{isDiscardingVersion:i||a}),l(n),e.closeConfirmModal();case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.draftExists,n=e.isPublished,i=e.isVersion,a=e.actionState,o=e.formik,l=(0,J.A)(e,ti),c=this.state.modalOpen,u=o.isSubmitting,d=Jr()(l,["dispatch"]),p="";p=n?ri:i?ii:ai;var f=n?"warning":"negative",m=ei()(p);return s.createElement(s.Fragment,null,s.createElement(R.A,(0,r.A)({disabled:!t||u,onClick:this.openConfirmModal,className:f,icon:!0,loading:u&&a===At,labelPosition:"left"},d,{content:m})),s.createElement(Ae.A,{open:c,onClose:this.closeConfirmModal,size:"tiny"},s.createElement(Ae.A.Content,null,s.createElement(si,{actionLbl:p})),s.createElement(Ae.A.Actions,null,s.createElement(R.A,{onClick:this.closeConfirmModal,floated:"left"},g.M.t("Cancel")),s.createElement(R.A,{className:f,onClick:this.handleDelete,loading:u&&a===At,icon:"trash alternate outline",content:m}))))}}])}(s.Component);(0,A.A)(ui,"contextType",jn),ui.propTypes={draftExists:p().bool,isPublished:p().bool,isVersion:p().bool,actionState:p().string,formik:p().object.isRequired},ui.defaultProps={draftExists:!1,isPublished:!1,isVersion:!1,actionState:void 0};var di=(0,u.connect)((function(e){var t;return{draftExists:Boolean(e.deposit.record.id),isPublished:e.deposit.record.is_published,isVersion:(null===(t=e.deposit.record.versions)||void 0===t?void 0:t.index)>1,actionState:e.deposit.actionState}}),null)((0,f.connect)(ui)),pi=["actionState","formik"];function fi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(fi=function(){return!!e})()}var mi=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,fi()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"handlePreview",(function(t,n){(0,e.context.setSubmitContext)(xn),n(t)})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.actionState,i=t.formik,a=(0,J.A)(t,pi),o=i.handleSubmit,l=i.isSubmitting,c=Jr()(a,["dispatch"]);return s.createElement(R.A,(0,r.A)({name:"preview",disabled:l,onClick:function(t){return e.handlePreview(t,o)},loading:l&&n===yt,icon:"eye",labelPosition:"left",content:g.M.t("Preview")},c))}}])}(s.Component);(0,A.A)(mi,"contextType",jn),mi.propTypes={actionState:p().string,formik:p().object.isRequired},mi.defaultProps={actionState:void 0};var hi=(0,u.connect)((function(e){return{actionState:e.deposit.actionState,record:e.deposit.record}}),null)((0,f.connect)(mi)),vi=s.createContext({}),bi=n(78585),yi=function(e){var t,n=e.result,r=e.record,i=e.isInitialSubmission,a=(0,s.useContext)(vi),o=a.setLocalCommunity,l=a.getChosenCommunity,c=a.userCommunitiesMemberships,u=a.displaySelected,d=n.metadata,p=(null===(t=l())||void 0===t?void 0:t.id)===n.id,f=c[n.id],h="public"===r.access.record&&"restricted"===n.access.visibility,v=n.ui.permissions.can_submit_record,b=(0,ct.get)(n,"theme.enabled"),y=i&&b,A=h||y||!v,E=s.createElement(s.Fragment,null,h&&s.createElement(m.InvenioPopup,{popupId:"community-inclusion-info-popup",size:"small",trigger:s.createElement(w.A,{className:"mb-5",color:"grey",name:"question circle outline"}),ariaLabel:g.M.t("Community inclusion information"),content:g.M.t("Submission to this community is only allowed if the record is restricted.")}),!v&&s.createElement(m.InvenioPopup,{popupId:"community-inclusion-info-popup",size:"small",trigger:s.createElement(w.A,{className:"mb-5",color:"grey",name:"question circle outline"}),ariaLabel:g.M.t("Submission to this community is only allowed to community members."),content:g.M.t("Submission to this community is only allowed to community members.")}),y&&s.createElement(s.Fragment,null,s.createElement(m.InvenioPopup,{popupId:"community-inclusion-info-popup",size:"small",trigger:s.createElement(w.A,{className:"mb-5",color:"grey",name:"question circle outline"}),ariaLabel:g.M.t("Community submission conditions information"),content:g.M.t("Submission to this community is only allowed by dedicated upload form. Use the button to jump to the form.")}),s.createElement(R.A,{size:"tiny",as:"a",href:"/communities/".concat(n.slug)},"Go to the community")),!y&&s.createElement(R.A,{content:u&&p?g.M.t("Selected"):g.M.t("Select"),size:"tiny",positive:u&&p,onClick:function(){return o(n)},disabled:A,"aria-label":g.M.t("Select {{title}}",{title:d.title})})),C=s.createElement(s.Fragment,null,f&&s.createElement(ue.A,{size:"small",horizontal:!0,color:"teal"},s.createElement(w.A,{name:"key"}),ei()(f)),b&&s.createElement(ue.A,{color:"green",horizontal:!0,size:"small"},s.createElement(w.A,{name:"check circle"}),"Verified"));return s.createElement(bi.mG,{result:n,actions:E,extraLabels:C,showPermissionLabel:!0})};function gi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(gi=function(){return!!e})()}yi.propTypes={result:p().object.isRequired,record:p().object.isRequired,isInitialSubmission:p().bool},yi.defaultProps={isInitialSubmission:!0};var Ai=function(e){function t(e){var n,r,a,c;(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a);var s=(n=(0,o.A)(r,gi()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c))).props.apiConfigs.allCommunities;return n.state={selectedConfig:s},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.state.selectedConfig,n=t.searchApi,r=t.appId,i=t.initialQueryState,a=t.toggleText,o=this.props,l=o.apiConfigs,c=l.allCommunities,u=l.myCommunities,d=o.record,p=o.isInitialSubmission,f=o.CommunityListItem,m=o.pagination,h=o.myCommunitiesEnabled,v=o.autofocus,b=new $n.HZ(n),y=(0,A.A)({},"".concat(r,".ResultsList.item"),(0,O.parametrize)(f,{record:d,isInitialSubmission:p}));return s.createElement(O.OverridableContext.Provider,{value:y},s.createElement($n.gz,{appName:r,urlHandlerApi:{enabled:!1},searchApi:b,key:r,initialQueryState:i,defaultSortingOnEmptyQueryString:{sortBy:"bestmatch"}},s.createElement(s.Fragment,null,s.createElement(Ae.A.Content,{as:X.A,className:"m-0 pb-0 centered"},h&&s.createElement(X.A.Column,{mobile:16,tablet:8,computer:8,textAlign:"left",floated:"left",className:"pt-0 pl-0"},s.createElement(Jn.A,{role:"tablist",className:"theme-primary-menu",compact:!0},s.createElement(Jn.A.Item,{as:"button",role:"tab",id:"all-communities-tab","aria-selected":r===c.appId,"aria-controls":c.appId,name:"All",active:r===c.appId,onClick:function(){return e.setState({selectedConfig:c})}},g.M.t("All")),s.createElement(Jn.A.Item,{as:"button",role:"tab",id:"my-communities-tab","aria-selected":r===u.appId,"aria-controls":u.appId,name:"My communities",active:r===u.appId,onClick:function(){return e.setState({selectedConfig:u})}},g.M.t("My communities")))),s.createElement(X.A.Column,{mobile:16,tablet:8,computer:8,floated:h?"right":"null",verticalAlign:"middle",className:"pt-0 pr-0 pl-0"},s.createElement($n.IW,{placeholder:a,autofocus:v,actionProps:{icon:"search",content:null,className:"search","aria-label":g.M.t("Search")}}))),s.createElement(Ae.A.Content,{role:"tabpanel",id:r,scrolling:!0,className:"community-list-results"},s.createElement($n.oK,null,s.createElement($n.i6,null),s.createElement($n.$D,null),s.createElement($n.dy,null))),m&&s.createElement(Ae.A.Content,{className:"text-align-center"},s.createElement($n.dK,null)))))}}])}(s.Component);function Ei(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ei=function(){return!!e})()}Ai.propTypes={apiConfigs:p().shape({allCommunities:p().shape({appId:p().string.isRequired,initialQueryState:p().object.isRequired,searchApi:p().object.isRequired}),myCommunities:p().shape({appId:p().string.isRequired,initialQueryState:p().object.isRequired,searchApi:p().object.isRequired})}),record:p().object.isRequired,isInitialSubmission:p().bool,CommunityListItem:p().elementType,pagination:p().bool,myCommunitiesEnabled:p().bool,autofocus:p().bool},Ai.defaultProps={isInitialSubmission:!0,pagination:!0,myCommunitiesEnabled:!0,autofocus:!0,CommunityListItem:yi,apiConfigs:{allCommunities:{initialQueryState:{size:5,page:1,sortBy:"bestmatch"},searchApi:{axios:{url:"/api/communities",headers:{Accept:"application/vnd.inveniordm.v1+json"}}},appId:"ReactInvenioDeposit.CommunitySelectionSearch.AllCommunities",toggleText:"Search in all communities"},myCommunities:{initialQueryState:{size:5,page:1,sortBy:"bestmatch"},searchApi:{axios:{url:"/api/user/communities",headers:{Accept:"application/vnd.inveniordm.v1+json"}}},appId:"ReactInvenioDeposit.CommunitySelectionSearch.MyCommunities",toggleText:"Search in my communities"}}};var wi=function(e){function t(e){var n,r,a,c;(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),n=(0,o.A)(r,Ei()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c)),(0,A.A)(n,"getChosenCommunity",(function(){return n.state.localChosenCommunity})),(0,A.A)(n,"setCommunity",(function(e){(0,n.props.onCommunityChange)(e),n.setState({localChosenCommunity:e})})),(0,A.A)(n,"modalTrigger",(function(){var e=n.props,t=e.trigger,r=e.modalOpen;if(!x()(t))return s.cloneElement(t,{"aria-haspopup":"dialog","aria-expanded":r})})),(0,A.A)(n,"handleModalOpen",(function(){var e=n.props,t=e.chosenCommunity,r=e.onModalChange;n.setState({localChosenCommunity:t}),r&&r(!0)}));var u=e.chosenCommunity,d=e.userCommunitiesMemberships,p=e.displaySelected;return n.state={localChosenCommunity:u},n.contextValue={setLocalCommunity:n.setCommunity,getChosenCommunity:n.getChosenCommunity,userCommunitiesMemberships:d,displaySelected:p},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.extraContentComponents,n=e.modalHeader,r=e.onModalChange,i=e.modalOpen,a=e.apiConfigs,o=e.handleClose,l=e.record,c=e.isInitialSubmission;return s.createElement(vi.Provider,{value:this.contextValue},s.createElement(Ae.A,{role:"dialog","aria-labelledby":"community-modal-header",id:"community-selection-modal",className:"m-0",closeIcon:!0,closeOnDimmerClick:!1,open:i,onClose:function(){r&&r(!1)},onOpen:this.handleModalOpen,trigger:this.modalTrigger()},s.createElement(Ae.A.Header,null,s.createElement(y.A,{as:"h2",size:"small",id:"community-modal-header",className:"mt-5"},n)),s.createElement(Ai,{apiConfigs:a,record:l,isInitialSubmission:c}),t&&s.createElement(Ae.A.Content,null,t),s.createElement(Ae.A.Actions,null,s.createElement(R.A,{onClick:o},g.M.t("Close")))))}}])}(s.Component);wi.propTypes={chosenCommunity:p().object,onCommunityChange:p().func.isRequired,trigger:p().object,userCommunitiesMemberships:p().object.isRequired,extraContentComponents:p().node,modalHeader:p().string,onModalChange:p().func,displaySelected:p().bool,modalOpen:p().bool,apiConfigs:p().object,handleClose:p().func.isRequired,record:p().object.isRequired,isInitialSubmission:p().bool},wi.defaultProps={chosenCommunity:void 0,extraContentComponents:void 0,modalHeader:g.M.t("Select a community"),onModalChange:void 0,displaySelected:!1,modalOpen:!1,trigger:void 0,apiConfigs:void 0,isInitialSubmission:!0};var Ri=(0,u.connect)((function(e){return{userCommunitiesMemberships:e.deposit.config.user_communities_memberships}}),null)(wi),Ci=["actionState","filesState","buttonLabel","publishWithoutCommunity","formik","publishModalExtraContent"];function Pi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Pi=function(){return!!e})()}var Si=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,Pi()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"state",{isConfirmModalOpen:!1}),(0,A.A)(e,"openConfirmModal",(function(){return e.setState({isConfirmModalOpen:!0})})),(0,A.A)(e,"closeConfirmModal",(function(){return e.setState({isConfirmModalOpen:!1})})),(0,A.A)(e,"handlePublish",(function(t,n,r){(0,e.context.setSubmitContext)(r?Mn:Fn),n(t),e.closeConfirmModal()})),(0,A.A)(e,"isDisabled",(function(e,t,n){var r;if(t)return!0;var i=pe()(e,"files.enabled",!1),a=Object.values(null!==(r=n.entries)&&void 0!==r?r:{});return!(!i||0!==a.length)||!a.every((function(e){return"finished"===e.status}))})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.actionState,i=t.filesState,a=t.buttonLabel,o=t.publishWithoutCommunity,l=t.formik,c=t.publishModalExtraContent,u=(0,J.A)(t,Ci),d=this.state.isConfirmModalOpen,p=l.values,f=l.isSubmitting,m=l.handleSubmit,h=Jr()(u,["dispatch"]);return s.createElement(s.Fragment,null,s.createElement(R.A,(0,r.A)({disabled:this.isDisabled(p,f,i),name:"publish",onClick:this.openConfirmModal,positive:!0,icon:"upload",loading:f&&n===ht,labelPosition:"left",content:a},h,{type:"button"})),d&&s.createElement(Ae.A,{open:d,onClose:this.closeConfirmModal,size:"small",closeIcon:!0,closeOnDimmerClick:!1},s.createElement(Ae.A.Header,null,g.M.t("Are you sure you want to publish this record?")),s.createElement(Ae.A.Content,null,s.createElement(V.A,{visible:!0,warning:!0},s.createElement("p",null,s.createElement(w.A,{name:"warning sign"})," ",g.M.t("Once the record is published you will no longer be able to change the files in the upload! However, you will still be able to update the record's metadata later."))),c&&s.createElement("div",{dangerouslySetInnerHTML:{__html:c}})),s.createElement(Ae.A.Actions,null,s.createElement(R.A,{onClick:this.closeConfirmModal,floated:"left"},g.M.t("Cancel")),s.createElement(R.A,{onClick:function(t){return e.handlePublish(t,m,o)},positive:!0,content:a}))))}}])}(s.Component);(0,A.A)(Si,"contextType",jn),Si.propTypes={buttonLabel:p().string,publishWithoutCommunity:p().bool,actionState:p().string,formik:p().object.isRequired,publishModalExtraContent:p().string,filesState:p().object},Si.defaultProps={buttonLabel:g.M.t("Publish"),publishWithoutCommunity:!1,actionState:void 0,publishModalExtraContent:void 0,filesState:void 0};var ki,Oi=(0,u.connect)((function(e){return{actionState:e.deposit.actionState,publishModalExtraContent:e.deposit.config.publish_modal_extra,filesState:e.files}}),null)((0,f.connect)(Si));function Di(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ii(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Di(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Di(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fi=(0,a.A)((function e(){(0,i.A)(this,e)}));function Mi(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).includes(e.status)}function xi(e){var t,n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=Mi(e,Fi.allowsReviewDeletionStates),l=Mi(e,Fi.allowsReviewUpdateStates),c=Mi(e,Fi.disallowsSubmitForReviewStates),s=function(e,t){switch(t){case void 0:var n,r,i=null===(n=e.parent)||void 0===n||null===(n=n.review)||void 0===n||null===(n=n.receiver)||void 0===n?void 0:n.community,a=null===(r=e.parent)||void 0===r||null===(r=r.communities)||void 0===r?void 0:r.default;if(!i&&!a)return;return Mi(e,[Fi.PUBLISHED,Fi.NEW_VERSION_DRAFT])?e.expanded.parent.communities.default:e.expanded.parent.review.receiver;case null:return null;default:return t}}(e,a),u=!x()(s),d=null===e||void 0===e||null===(t=e.parent)||void 0===t?void 0:t.review,p=Mi(e,[Fi.DRAFT_WITH_REVIEW])&&(null===d||void 0===d||null===(n=d.receiver)||void 0===n?void 0:n.community)===(null===s||void 0===s?void 0:s.id),f=Mi(e,[Fi.DECLINED,Fi.EXPIRED])&&(null===d||void 0===d||null===(r=d.receiver)||void 0===r?void 0:r.community)===(null===s||void 0===s?void 0:s.id),m=!0===(null===s||void 0===s?void 0:s.is_ghost),h=u&&!m,v=Mi(e,[Fi.PUBLISHED,Fi.NEW_VERSION_DRAFT])&&(x()(null===(i=e.parent)||void 0===i?void 0:i.communities)||!h),b=u&&!Mi(e,[Fi.PUBLISHED,Fi.NEW_VERSION_DRAFT])&&s.ui.permissions.can_include_directly,y=u&&!f&&!Mi(e,[Fi.PUBLISHED,Fi.NEW_VERSION_DRAFT]),g=!Mi(e,[Fi.PUBLISHED,Fi.NEW_VERSION_DRAFT]),A=u&&l&&!p&&!f,E=!u&&o;return{selectedCommunity:s,ui:{showSubmitForReviewButton:y,showDirectPublishButton:b,disableSubmitForReviewButton:y&&c,showChangeCommunityButton:f,showCommunitySelectionButton:g,showCommunityHeader:!v,disableCommunitySelectionButton:g&&(f||c&&!v)},actions:{shouldUpdateReview:A,shouldDeleteReview:E,communityStateMustBeChecked:A||E}}}ki=Fi,(0,A.A)(Fi,"DRAFT","draft"),(0,A.A)(Fi,"NEW_VERSION_DRAFT","new_version_draft"),(0,A.A)(Fi,"DRAFT_WITH_REVIEW","draft_with_review"),(0,A.A)(Fi,"IN_REVIEW","in_review"),(0,A.A)(Fi,"DECLINED","declined"),(0,A.A)(Fi,"EXPIRED","expired"),(0,A.A)(Fi,"PUBLISHED","published"),(0,A.A)(Fi,"allowsReviewDeletionStates",[ki.DRAFT_WITH_REVIEW,ki.DECLINED,ki.EXPIRED]),(0,A.A)(Fi,"allowsReviewUpdateStates",[ki.DRAFT_WITH_REVIEW,ki.DECLINED,ki.EXPIRED,ki.DRAFT]),(0,A.A)(Fi,"disallowsSubmitForReviewStates",[ki.PUBLISHED,ki.IN_REVIEW,ki.NEW_VERSION_DRAFT]);const Ti=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case pt:case ht:case At:case yt:return Ii(Ii({},e),{},{actionState:t.type});case wt:return Ii(Ii({},e),{},{actionState:t.type,actionStateExtra:{reviewComment:t.payload.reviewComment,directPublish:t.payload.directPublish}});case Pt:case Ot:return Ii(Ii({},e),{},{actionState:t.type,actionStateExtra:{pidType:t.payload.pidType}});case St:case Dt:return Ii(Ii({},e),{},{record:Ii(Ii({},e.record),t.payload.data),editorState:xi(t.payload.data,e.editorState.selectedCommunity),errors:{},actionState:t.type,actionStateExtra:{}});case ut:case ft:return Ii(Ii({},e),{},{record:Ii({},t.payload.data),editorState:xi(t.payload.data,e.editorState.selectedCommunity),errors:{},actionState:t.type,actionStateExtra:{}});case dt:case bt:case Ct:return Ii(Ii({},e),{},{record:Ii(Ii({},e.record),t.payload.data),editorState:xi(t.payload.data,e.editorState.selectedCommunity),errors:Ii({},t.payload.errors),actionState:t.type});case mt:case vt:case Et:case gt:case kt:case It:case Rt:return Ii(Ii({},e),{},{errors:Ii({},t.payload.errors),actionState:t.type,actionStateExtra:{}});case Vt:var n,r=Ii({},e.record),i="restricted"===(null===(n=t.payload)||void 0===n||null===(n=n.community)||void 0===n||null===(n=n.access)||void 0===n?void 0:n.visibility);return"public"===r.access.record&&i&&(r=Ii(Ii({},e.record),{},{access:{files:"restricted",record:"restricted"}})),Ii(Ii({},e),{},{record:r,editorState:xi(r,t.payload.community)});default:return e}};function _i(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_i=function(){return!!e})()}var qi=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,_i()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"ConfirmSubmitReviewSchema",Ee.Ik({acceptAccessToRecord:Ee.lc().oneOf([!0],g.M.t("You must accept this.")),reviewComment:Ee.Yj()})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"componentDidMount",value:function(){var e=document.getElementById("accept-access-checkbox").querySelector("input");null===e||void 0===e||e.focus()}},{key:"render",value:function(){var e,t,n,r,i=this,a=this.props,o=a.initialReviewComment,l=a.isConfirmModalOpen,c=a.community,u=a.onClose,d=a.onSubmit,p=a.publishModalExtraContent,h=a.directPublish,b=a.errors,y=a.loading,A=a.record,E=c.metadata.title;null!==A&&void 0!==A&&A.is_published?(e=g.M.t("Submit to community"),t=g.M.t("Before submitting to community, please read and check the following:"),r=g.M.t("Submit to community")):h?(e=g.M.t("Publish to community"),t=g.M.t("Before publishing to the community, please read and check the following:"),n=g.M.t("Your upload will be <bold>immediately published</bold> in '{{communityTitle}}'. You will no longer be able to change the files in the upload! However, you will still be able to update the record's metadata later.",{communityTitle:E}),r=g.M.t("Publish record to community")):(e=g.M.t("Submit for review"),t=g.M.t("Before requesting review, please read and check the following:"),n=g.M.t("If your upload is accepted by the community curators, it will be <bold>immediately published</bold>. Before that, you will still be able to modify metadata and files of this upload."),r=g.M.t("Submit record for review"));return s.createElement(f.Formik,{initialValues:{acceptAccessToRecord:!1,acceptAfterPublishRecord:!1,reviewComment:o||""},onSubmit:d,validationSchema:function(){if(A)return i.ConfirmSubmitReviewSchema;var e=Ee.Ik({acceptAfterPublishRecord:Ee.lc().oneOf([!0],g.M.t("You must accept this."))});return i.ConfirmSubmitReviewSchema.concat(e)},validateOnChange:!1,validateOnBlur:!1},(function(i){var a=i.values,o=i.handleSubmit;return s.createElement(Ae.A,{open:l,onClose:u,size:"small",closeIcon:!0,closeOnDimmerClick:!1},s.createElement(Ae.A.Header,null,e),s.createElement(Ae.A.Content,null,b&&s.createElement(m.ErrorMessage,{errors:b}),s.createElement(V.A,{visible:!0,warning:!0},s.createElement("p",null,s.createElement(w.A,{name:"warning sign"}),t)),s.createElement(v.A,null,s.createElement(v.A.Field,{id:"accept-access-checkbox"},s.createElement(m.RadioField,{control:_.A,fieldPath:"acceptAccessToRecord",label:s.createElement(N.x,{defaults:g.M.t("The '{{communityTitle}}' curators will have access to <bold>view</bold> and <bold>edit</bold> your upload's metadata and files.",{communityTitle:E}),values:{communityTitle:E},components:{bold:s.createElement("b",null)},shouldUnescape:!0}),checked:!0===pe()(a,"acceptAccessToRecord"),onChange:function(e){var t=e.data;e.formikProps.form.setFieldValue("acceptAccessToRecord",t.checked)},optimized:!0}),s.createElement(m.ErrorLabel,{role:"alert",fieldPath:"acceptAccessToRecord",className:"mt-0 mb-5"})),!A&&s.createElement(v.A.Field,null,s.createElement(m.RadioField,{control:_.A,fieldPath:"acceptAfterPublishRecord",label:s.createElement(N.x,{defaults:n,values:{communityTitle:E},components:{bold:s.createElement("b",null)}}),checked:!0===pe()(a,"acceptAfterPublishRecord"),onChange:function(e){var t=e.data;e.formikProps.form.setFieldValue("acceptAfterPublishRecord",t.checked)},optimized:!0}),s.createElement(m.ErrorLabel,{role:"alert",fieldPath:"acceptAfterPublishRecord",className:"mt-0 mb-5"})),!h&&s.createElement(m.TextAreaField,{fieldPath:"reviewComment",label:g.M.t("Message to curators (optional)")}),p&&s.createElement("div",{dangerouslySetInnerHTML:{__html:p}}))),s.createElement(Ae.A.Actions,null,s.createElement(R.A,{onClick:u,floated:"left",loading:y,disabled:y},g.M.t("Cancel")),s.createElement(R.A,{name:"submitReview",onClick:function(e){o(e)},loading:y,disabled:y,positive:h,primary:!h,content:r})))}))}}])}(s.Component);qi.propTypes={isConfirmModalOpen:p().bool.isRequired,community:p().object.isRequired,onClose:p().func.isRequired,onSubmit:p().func.isRequired,initialReviewComment:p().string,publishModalExtraContent:p().string,directPublish:p().bool,errors:p().node,loading:p().bool,record:p().object.isRequired},qi.defaultProps={initialReviewComment:"",publishModalExtraContent:void 0,directPublish:!1,errors:void 0,loading:!1};var zi=["actionState","actionStateExtra","community","disableSubmitForReviewButton","directPublish","formik","isRecordSubmittedForReview","publishModalExtraContent","filesState"];function ji(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ji=function(){return!!e})()}var Li=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,ji()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"state",{isConfirmModalOpen:!1}),(0,A.A)(e,"openConfirmModal",(function(){return e.setState({isConfirmModalOpen:!0})})),(0,A.A)(e,"closeConfirmModal",(function(){return e.setState({isConfirmModalOpen:!1})})),(0,A.A)(e,"handleSubmitReview",(function(t){var n=t.reviewComment,r=e.props,i=r.formik,a=r.directPublish,o=i.handleSubmit;(0,e.context.setSubmitContext)(zn,{reviewComment:n,directPublish:a}),o(),e.closeConfirmModal()})),(0,A.A)(e,"isDisabled",(function(t,n){var r,i=e.props.formik,a=i.values,o=i.isSubmitting;if(t||o)return!0;var l=pe()(a,"files.enabled",!1),c=Object.values(null!==(r=n.entries)&&void 0!==r?r:{});return!(!l||0!==c.length)||!c.every((function(e){return"finished"===e.status}))})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props,t=e.actionState,n=e.actionStateExtra,i=e.community,a=e.disableSubmitForReviewButton,o=e.directPublish,l=e.formik,c=e.isRecordSubmittedForReview,u=e.publishModalExtraContent,d=e.filesState,p=(0,J.A)(e,zi),f=l.isSubmitting,m=Jr()(p,["dispatch"]),h=this.state.isConfirmModalOpen,v=c?g.M.t("Submitted for review"):g.M.t("Submit for review"),b=o?g.M.t("Publish to community"):v;return s.createElement(s.Fragment,null,s.createElement(R.A,(0,r.A)({disabled:this.isDisabled(a,d),name:"SubmitReview",onClick:this.openConfirmModal,positive:o,primary:!o,icon:"upload",loading:f&&"DRAFT_SUBMIT_REVIEW_STARTED"===t,labelPosition:"left",content:b},m,{type:"button"})),h&&s.createElement(qi,{isConfirmModalOpen:h,initialReviewComment:n.reviewComment,onSubmit:this.handleSubmitReview,community:i,onClose:this.closeConfirmModal,publishModalExtraContent:u,directPublish:o}))}}])}(s.Component);(0,A.A)(Li,"contextType",jn),Li.propTypes={actionState:p().string,actionStateExtra:p().object.isRequired,community:p().object.isRequired,disableSubmitForReviewButton:p().bool,isRecordSubmittedForReview:p().bool.isRequired,directPublish:p().bool,formik:p().object.isRequired,publishModalExtraContent:p().string,filesState:p().object},Li.defaultProps={actionState:void 0,disableSubmitForReviewButton:void 0,publishModalExtraContent:void 0,directPublish:!1,filesState:void 0};var Bi=(0,u.connect)((function(e){return{actionState:e.deposit.actionState,actionStateExtra:e.deposit.actionStateExtra,community:e.deposit.editorState.selectedCommunity,isRecordSubmittedForReview:e.deposit.record.status===Fi.IN_REVIEW,disableSubmitForReviewButton:e.deposit.editorState.ui.disableSubmitForReviewButton,publishModalExtraContent:e.deposit.config.publish_modal_extra,filesState:e.files}}),null)((0,f.connect)(Li)),Ni=["community","changeSelectedCommunityFn","showChangeCommunityButton","showDirectPublishButton","showSubmitForReviewButton","record"];function Ui(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ui=function(){return!!e})()}var Vi=function(e){function t(e){var n,r,a,c;return(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),(n=(0,o.A)(r,Ui()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c))).state={modalOpen:!1},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.community,i=t.changeSelectedCommunityFn,a=t.showChangeCommunityButton,o=t.showDirectPublishButton,l=t.showSubmitForReviewButton,c=t.record,u=(0,J.A)(t,Ni),d=this.state.modalOpen;return l?s.createElement(Bi,(0,r.A)({directPublish:o},u,{fluid:!0,className:"mb-10"})):a?s.createElement(s.Fragment,null,s.createElement(Ri,{onCommunityChange:function(e){i(e)},onModalChange:function(t){return e.setState({modalOpen:t})},modalOpen:d,displaySelected:!0,record:c,chosenCommunity:n,trigger:s.createElement(R.A,{content:g.M.t("Change community"),fluid:!0,className:"mb-10"})}),s.createElement(Oi,(0,r.A)({buttonLabel:g.M.t("Publish without community"),publishWithoutCommunity:!0},u))):s.createElement(Oi,u)}}])}(s.Component);Vi.propTypes={community:p().object,changeSelectedCommunityFn:p().func.isRequired,showChangeCommunityButton:p().bool.isRequired,showDirectPublishButton:p().bool.isRequired,showSubmitForReviewButton:p().bool.isRequired,record:p().object.isRequired},Vi.defaultProps={community:void 0};var Hi=(0,u.connect)((function(e){return{community:e.deposit.editorState.selectedCommunity,showDirectPublishButton:e.deposit.editorState.ui.showDirectPublishButton,showChangeCommunityButton:e.deposit.editorState.ui.showChangeCommunityButton,showSubmitForReviewButton:e.deposit.editorState.ui.showSubmitForReviewButton}}),(function(e){return{changeSelectedCommunityFn:function(t){return e($t(t))}}}))(Vi),Yi=["actionState","formik"];function Wi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Wi=function(){return!!e})()}var Gi=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,Wi()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"handleSave",(function(t){var n=e.props.formik,r=e.context.setSubmitContext,i=n.handleSubmit;r(In),i(t),ae()})),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.actionState,i=t.formik,a=(0,J.A)(t,Yi),o=i.isSubmitting,l=Jr()(a,["dispatch"]);return s.createElement(R.A,(0,r.A)({name:"save",disabled:o,onClick:function(t){return e.handleSave(t)},icon:"save",loading:o&&n===pt,labelPosition:"left",content:g.M.t("Save draft")},l))}}])}(s.Component);(0,A.A)(Gi,"contextType",jn),Gi.propTypes={formik:p().object.isRequired,actionState:p().string},Gi.defaultProps={actionState:void 0};var Qi,Ki=(0,u.connect)((function(e){return{actionState:e.deposit.actionState}}),null)((0,f.connect)(Gi)),Xi=n(23805),$i=n.n(Xi);function Ji(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ji(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ji(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ea(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ea=function(){return!!e})()}var ta={"files.enabled":g.M.t("Files"),"metadata.resource_type":g.M.t("Resource type"),"metadata.title":g.M.t("Title"),"metadata.additional_titles":g.M.t("Additional titles"),"metadata.publication_date":g.M.t("Publication date"),"metadata.creators":g.M.t("Creators"),"metadata.contributors":g.M.t("Contributors"),"metadata.description":g.M.t("Description"),"metadata.additional_descriptions":g.M.t("Additional descriptions"),"metadata.rights":g.M.t("Licenses"),"metadata.languages":g.M.t("Languages"),"metadata.dates":g.M.t("Dates"),"metadata.version":g.M.t("Version"),"metadata.publisher":g.M.t("Publisher"),"metadata.related_identifiers":g.M.t("Related works"),"metadata.references":g.M.t("References"),"metadata.identifiers":g.M.t("Alternate identifiers"),"metadata.subjects":g.M.t("Keywords and subjects"),"access.embargo.until":g.M.t("Embargo until"),"pids.doi":g.M.t("DOI")},na=(Qi={},(0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)(Qi,ft,{feedback:"positive",message:g.M.t("Record successfully saved.")}),dt,{feedback:"warning",message:g.M.t("Record saved with validation errors:")}),mt,{feedback:"negative",message:g.M.t("The draft was not saved. Please try again. If the problem persists, contact user support.")}),vt,{feedback:"negative",message:g.M.t("The draft was not published. Please try again. If the problem persists, contact user support.")}),bt,{feedback:"negative",message:g.M.t("The draft was not published. Record saved with validation errors:")}),Rt,{feedback:"negative",message:g.M.t("The draft was not submitted for review. Please try again. If the problem persists, contact user support.")}),Ct,{feedback:"negative",message:g.M.t("The draft was not submitted for review. Record saved with validation errors:")}),Et,{feedback:"negative",message:g.M.t("Draft deletion failed. Please try again. If the problem persists, contact user support.")}),gt,{feedback:"negative",message:g.M.t("Draft preview failed. Please try again. If the problem persists, contact user support.")}),kt,{feedback:"negative",message:g.M.t("Identifier reservation failed. Please try again. If the problem persists, contact user support.")}),(0,A.A)((0,A.A)((0,A.A)(Qi,It,{feedback:"negative",message:g.M.t("Identifier could not be discarded. Please try again. If the problem persists, contact user support.")}),_t,{feedback:"negative",message:g.M.t("Draft save failed before file upload. Please try again. If the problem persists, contact user support.")}),jt,{feedback:"negative",message:g.M.t("Files import from the previous version failed. Please try again. If the problem persists, contact user support.")})),ra=function(e){function t(e){var n,r,a,c;return(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),(n=(0,o.A)(r,ea()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c))).labels=Zi(Zi({},ta),e.labels),n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"renderErrorMessages",value:function(e){var t=(0,Ce.A)(new Set(e));return 1===t.length?e[0]:s.createElement("ul",null,t.map((function(e){return s.createElement("li",{key:e},e)})))}},{key:"toErrorMessages",value:function(e){var t=[];return re(e,(function(e){t.push(e)})),t}},{key:"toLabelledErrorMessages",value:function(e){var t,n=this,r=e.metadata||{},i=Object.entries(r).map((function(e){var t=(0,be.A)(e,2);return["metadata."+t[0],t[1]]})),a=e.files||{},o=Object.entries(a).map((function(e){var t=(0,be.A)(e,2);return["files."+t[0],t[1]]})),l=(null===(t=e.access)||void 0===t?void 0:t.embargo)||{},c=Object.entries(l).map((function(e){var t=(0,be.A)(e,2);return["access.embargo."+t[0],t[1]]})),s=e.pids||{},u=$i()(s)?Object.entries(s).map((function(e){var t=(0,be.A)(e,2);return["pids."+t[0],t[1]]})):[["pids",s]],d=e.custom_fields||{},p=Object.entries(d).map((function(e){var t=(0,be.A)(e,2);return["custom_fields."+t[0],t[1]]})),f=Object.fromEntries(i.concat(o).concat(c).concat(u).concat(p)),m=Object.fromEntries(Object.entries(f).map((function(e){var t=(0,be.A)(e,2),r=t[0],i=t[1];return[r,n.toErrorMessages(i)]}))),h={};for(var v in m){var b=this.labels[v]||"Unknown field",y=h[b]||[];h[b]=y.concat(m[v])}return h}},{key:"render",value:function(){var e=this,t=this.props,n=t.errors,r=t.actionState,i=n||{},a=pe()(na,r,{feedback:void 0,message:void 0}),o=a.feedback,l=a.message;if(!l)return null;var c=this.toLabelledErrorMessages(i),u=Object.entries(c).map((function(t){var n=(0,be.A)(t,2),r=n[0],i=n[1];return s.createElement(V.A.Item,{key:r},s.createElement("b",null,r),": ",e.renderErrorMessages(i))})),d=i.message;return s.createElement(V.A,{visible:!0,positive:"positive"===o,warning:"warning"===o,negative:"negative"===o,className:"flashed top attached"},s.createElement(X.A,{container:!0},s.createElement(X.A.Column,{width:15,textAlign:"left"},s.createElement("strong",null,d||l),u.length>0&&s.createElement(V.A.List,null,u))))}}])}(s.Component);ra.propTypes={errors:p().object,actionState:p().string,labels:p().object},ra.defaultProps={errors:void 0,actionState:void 0,labels:void 0};var ia=(0,u.connect)((function(e){return{actionState:e.deposit.actionState,errors:e.deposit.errors}}),null)(ra);n(75866);var aa=n(71083);function oa(e,t,n){return t=(0,l.A)(t),(0,o.A)(e,la()?Reflect.construct(t,n||[],(0,l.A)(e).constructor):t.apply(e,n))}function la(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(la=function(){return!!e})()}var ca={json:{"Content-Type":"application/json"},"vnd+json":{"Content-Type":"application/json",Accept:"application/vnd.inveniordm.v1+json"},"octet-stream":{"Content-Type":"application/octet-stream"}},sa=(0,a.A)((function e(t,n){(0,i.A)(this,e),this.data=t,this.errors=n})),ua=function(){return(0,a.A)((function e(t,n,r){if((0,i.A)(this,e),this.constructor===e)throw new Error("Abstract");var a=pe()(t,"headers");this.apiHeaders=Object.assign({},ca,a),this.apiConfig={withCredentials:!0,xsrfCookieName:"csrftoken",xsrfHeaderName:"X-CSRFToken",headers:this.apiHeaders["vnd+json"]},this.axiosWithConfig=aa.A.create(this.apiConfig),this.cancelToken=aa.A.CancelToken}),[{key:"createDraft",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveDraft",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"publishDraft",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteDraft",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"reservePID",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"discardPID",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createOrUpdateReview",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteReview",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitReview",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}])}(),da=function(e){function t(e,n,r){var a;return(0,i.A)(this,t),(a=oa(this,t,[e])).createDraftURL=n,a.recordSerializer=r,a}return(0,c.A)(t,e),(0,a.A)(t,[{key:"_createResponse",value:function(){var e=(0,at.A)(lt().mark((function e(t){var n,r,i,a;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:return n=e.sent,r=this.recordSerializer.deserialize(n.data||{}),i=this.recordSerializer.deserializeErrors(n.data.errors||[]),e.abrupt("return",new sa(r,i));case 9:throw e.prev=9,e.t0=e.catch(0),a=e.t0.response.data,new sa({},a);case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createDraft",value:function(){var e=(0,at.A)(lt().mark((function e(t){var n,r=this;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.recordSerializer.serialize(t),e.abrupt("return",this._createResponse((function(){return r.axiosWithConfig.post(r.createDraftURL,n,{params:{expand:1}})})));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readDraft",value:function(){var e=(0,at.A)(lt().mark((function e(t){var n=this;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createResponse((function(){return n.axiosWithConfig.get(t.self,{params:{expand:1}})})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveDraft",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){var r,i=this;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.recordSerializer.serialize(t),e.abrupt("return",this._createResponse((function(){return i.axiosWithConfig.put(n.self,r,{params:{expand:1}})})));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"publishDraft",value:function(){var e=(0,at.A)(lt().mark((function e(t){var n=this;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createResponse((function(){return n.axiosWithConfig.post(t.publish,{},{params:{expand:1}})})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteDraft",value:function(){var e=(0,at.A)(lt().mark((function e(t){var n=this;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createResponse((function(){return n.axiosWithConfig.delete(t.self,{})})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reservePID",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){var r=this;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createResponse((function(){var e="reserve_".concat(n),i=t[e];return r.axiosWithConfig.post(i,{},{params:{expand:1}})})));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"discardPID",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){var r=this;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createResponse((function(){var e="reserve_".concat(n),i=t[e];return r.axiosWithConfig.delete(i,{params:{expand:1}})})));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createOrUpdateReview",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){var r=this;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createResponse((function(){return r.axiosWithConfig.put(t.review,{receiver:{community:n},type:"community-submission"})})));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteReview",value:function(){var e=(0,at.A)(lt().mark((function e(t){var n=this;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createResponse((function(){return n.axiosWithConfig.delete(t.review,{})})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitReview",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){var r=this;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._createResponse((function(){var e=n?{payload:{content:n,format:"html"}}:{};return r.axiosWithConfig.post(t["submit-review"],e)})));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"cancelReview",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.axiosWithConfig.post(t.actions.cancel,n?{payload:{content:n,format:"html"}}:{}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}])}(ua),pa=function(){return(0,a.A)((function e(t){if((0,i.A)(this,e),this.constructor===e)throw new Error("Abstract");var n=pe()(t,"headers",{});this.apiHeaders=Object.assign({},ca,n);var r={withCredentials:!0,xsrfCookieName:"csrftoken",xsrfHeaderName:"X-CSRFToken",headers:this.apiHeaders["vnd+json"]};this.axiosWithConfig=aa.A.create(r)}),[{key:"isCancelled",value:function(e){return aa.A.isCancel(e)}},{key:"initializeFileUpload",value:function(e,t){throw new Error("Not implemented.")}},{key:"uploadFile",value:function(e,t,n,r){throw new Error("Not implemented.")}},{key:"finalizeFileUpload",value:function(e){throw new Error("Not implemented.")}},{key:"deleteFile",value:function(e){throw new Error("Not implemented.")}}])}(),fa=function(e){function t(){return(0,i.A)(this,t),oa(this,t,arguments)}return(0,c.A)(t,e),(0,a.A)(t,[{key:"initializeFileUpload",value:function(e,t){var n=[{key:t}];return this.axiosWithConfig.post(e,n,{})}},{key:"uploadFile",value:function(e,t,n,r){return this.axiosWithConfig.put(e,t,{headers:this.apiHeaders["octet-stream"],onUploadProgress:function(e){var t=Math.floor(e.loaded/e.total*100);n&&n(t)},cancelToken:new aa.A.CancelToken(r)})}},{key:"finalizeFileUpload",value:function(e){return this.axiosWithConfig.post(e,{})}},{key:"importParentRecordFiles",value:function(e){var t="".concat(e.self,"/actions/files-import");return this.axiosWithConfig.post(t,{})}},{key:"deleteFile",value:function(e){return this.axiosWithConfig.delete(e.self)}}])}(pa),ma=n(52230),ha=["isFileUploadInProgress"];function va(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ba(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?va(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):va(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ya(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ya=function(){return!!e})()}var ga=function(e){function t(){var e,n,r,a;(0,i.A)(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,r=t,a=[].concat(s),r=(0,l.A)(r),e=(0,o.A)(n,ya()?Reflect.construct(r,a||[],(0,l.A)(n).constructor):r.apply(n,a)),(0,A.A)(e,"submitContext",void 0),(0,A.A)(e,"setSubmitContext",(function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.submitContext={actionName:t,extra:n}})),(0,A.A)(e,"onFormSubmit",function(){var t=(0,at.A)(lt().mark((function t(n,r){var i,a,o,l,c,s,u,d,p,f,m,h,v;return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=e.props,a=i.saveAction,o=i.publishAction,l=i.submitReview,c=i.previewAction,s=i.deleteAction,u=i.reservePIDAction,d=i.discardPIDAction,p=e.submitContext,f=p.actionName,m=p.extra,h=void 0,v={},t.t0=f,t.next=t.t0===In?7:t.t0===Fn?9:t.t0===Mn?11:t.t0===zn?14:t.t0===xn?18:t.t0===Tn?20:t.t0===_n?23:t.t0===qn?26:29;break;case 7:return h=a,t.abrupt("break",30);case 9:return h=o,t.abrupt("break",30);case 11:return h=o,v.removeSelectedCommunity=!0,t.abrupt("break",30);case 14:return h=l,v.reviewComment=m.reviewComment,v.directPublish=m.directPublish,t.abrupt("break",30);case 18:return h=c,t.abrupt("break",30);case 20:return h=s,v.isDiscardingVersion=m.isDiscardingVersion,t.abrupt("break",30);case 23:return h=u,v.pidType=m.pidType,t.abrupt("break",30);case 26:return h=d,v.pidType=m.pidType,t.abrupt("break",30);case 29:throw Error("The submit btn must set the form action name.");case 30:return t.prev=30,t.next=33,h(n,v);case 33:t.next=38;break;case 35:t.prev=35,t.t1=t.catch(30),t.t1&&t.t1.errors?r.setErrors(t.t1.errors):ae();case 38:return t.prev=38,e.submitContext={},t.finish(38);case 41:case"end":return t.stop()}}),t,null,[[30,35,38,41]])})));return function(e,n){return t.apply(this,arguments)}}()),e}return(0,c.A)(t,e),(0,a.A)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("beforeunload",(function(t){if(e.props.fileUploadOngoing)return t.returnValue="",""})),window.addEventListener("unload",(0,at.A)(lt().mark((function e(){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))))}},{key:"render",value:function(){var e=this.props,t=e.errors,n=e.record,r=e.children;return s.createElement(jn.Provider,{value:{setSubmitContext:this.setSubmitContext}},s.createElement(m.BaseForm,{onSubmit:this.onFormSubmit,formik:ba({enableReinitialize:!0,initialValues:n},t&&{initialErrors:t})},r))}}])}(s.Component);ga.propTypes={errors:p().object,record:p().object.isRequired,children:p().node,saveAction:p().func.isRequired,publishAction:p().func.isRequired,submitReview:p().func.isRequired,previewAction:p().func.isRequired,deleteAction:p().func.isRequired,reservePIDAction:p().func.isRequired,discardPIDAction:p().func.isRequired,fileUploadOngoing:p().bool},ga.defaultProps={errors:void 0,children:void 0,fileUploadOngoing:!1};var Aa=(0,u.connect)((function(e){var t=e.files,n=t.isFileUploadInProgress,r=(0,J.A)(t,ha);return{record:e.deposit.record,errors:e.deposit.errors,formState:e.deposit.formState,fileUploadOngoing:n,files:r}}),(function(e){return{publishAction:function(t,n){var r=n.removeSelectedCommunity;return e(function(e,t){var n=t.removeSelectedCommunity,r=void 0!==n&&n;return function(){var t=(0,at.A)(lt().mark((function t(n,i,a){var o,l,c,s;return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n({type:ht}),!r){t.next=4;break}return t.next=4,n($t(null));case 4:return t.next=6,Kt(e,a.service.drafts,{depositState:i().deposit,dispatchFn:n,failType:vt,partialValidationActionType:bt});case 6:return o=t.sent,l=o.data,t.prev=8,t.next=11,a.service.drafts.publish(l.links);case 11:c=t.sent,s=c.data.links.self_html,window.location.replace(s),t.next=21;break;case 16:throw t.prev=16,t.t0=t.catch(8),console.error("Error publishing draft",t.t0,e),n({type:vt,payload:{errors:t.t0.errors}}),t.t0;case 21:case"end":return t.stop()}}),t,null,[[8,16]])})));return function(e,n,r){return t.apply(this,arguments)}}()}(t,{removeSelectedCommunity:void 0!==r&&r}))},submitReview:function(t,n){var r=n.reviewComment,i=n.directPublish;return e(function(e,t){var n=t.reviewComment,r=t.directPublish;return function(){var t=(0,at.A)(lt().mark((function t(i,a,o){var l,c,s,u;return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i({type:wt,payload:{reviewComment:n},directPublish:r}),t.next=3,Kt(e,o.service.drafts,{depositState:a().deposit,dispatchFn:i,failType:Rt,partialValidationActionType:Ct});case 3:return l=t.sent,c=l.data,t.prev=5,t.next=8,o.service.drafts.submitReview(c.links,n);case 8:s=t.sent,u=s.data.links.next_html,window.location.replace(u),t.next=18;break;case 13:throw t.prev=13,t.t0=t.catch(5),console.error("Error submitting review",t.t0,e),i({type:Rt,payload:{errors:t.t0.errors}}),t.t0;case 18:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(e,n,r){return t.apply(this,arguments)}}()}(t,{reviewComment:r,directPublish:i}))},saveAction:function(t){return e((n=t,function(){var e=(0,at.A)(lt().mark((function e(t,r,i){var a;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:pt}),e.next=3,Kt(n,i.service.drafts,{depositState:r().deposit,dispatchFn:t,failType:mt,partialValidationActionType:dt});case 3:a=e.sent,t({type:ft,payload:{data:a.data}});case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()));var n},previewAction:function(t){return e((n=t,function(){var e=(0,at.A)(lt().mark((function e(t,r,i){var a,o;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:yt}),e.next=3,Kt(n,i.service.drafts,{depositState:r().deposit,dispatchFn:t,failType:gt,partialValidationActionType:dt});case 3:a=e.sent,o=a.data.links.record_html,window.location="".concat(o,"?preview=1");case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()));var n},deleteAction:function(t,n){n.isDiscardingVersion;return e(function(){var e=(0,at.A)(lt().mark((function e(t,n,r){var i,a;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:At}),e.prev=1,i=n().deposit.record,e.next=5,r.service.drafts.delete(i.links);case 5:a=r.config.dashboard_routes.uploads,window.location.replace(a),e.next=14;break;case 9:throw e.prev=9,e.t0=e.catch(1),console.error("Error deleting draft",e.t0),t({type:Et,payload:{errors:e.t0.errors}}),e.t0;case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n,r){return e.apply(this,arguments)}}())},reservePIDAction:function(t,n){var r=n.pidType;return e(function(e,t){var n=t.pidType;return function(){var t=(0,at.A)(lt().mark((function t(r,i,a){var o,l;return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r({type:Pt,payload:{pidType:n}}),t.prev=1,t.next=4,Qt(e,a.service.drafts);case 4:return o=t.sent,l=o.data,t.next=8,a.service.drafts.reservePID(l.links,n);case 8:o=t.sent,r({type:St,payload:{data:o.data}}),t.next=17;break;case 12:throw t.prev=12,t.t0=t.catch(1),console.error("Error reserving PID",t.t0,e),r({type:kt,payload:{errors:t.t0.errors}}),t.t0;case 17:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e,n,r){return t.apply(this,arguments)}}()}(t,{pidType:r}))},discardPIDAction:function(t,n){var r=n.pidType;return e(function(e,t){var n=t.pidType;return function(){var t=(0,at.A)(lt().mark((function t(r,i,a){var o,l;return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r({type:Ot,payload:{pidType:n}}),t.prev=1,t.next=4,Qt(e,a.service.drafts);case 4:return o=t.sent,l=o.data,t.next=8,a.service.drafts.discardPID(l.links,n);case 8:o=t.sent,r({type:Dt,payload:{data:o.data}}),t.next=17;break;case 12:throw t.prev=12,t.t0=t.catch(1),console.error("Error discarding PID",t.t0,e),r({type:It,payload:{errors:t.t0.errors}}),t.t0;case 17:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e,n,r){return t.apply(this,arguments)}}()}(t,{pidType:r}))}}}))(ga);function Ea(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ea=function(){return!!e})()}var wa=function(){return(0,a.A)((function e(t){if((0,i.A)(this,e),this.constructor===e)throw new Error("Abstract")}),[{key:"read",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"create",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"publish",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"reservePID",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"discardPID",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createOrUpdateReview",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteReview",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitReview",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}])}(),Ra=function(e){function t(e){var n,r,a,c;return(0,i.A)(this,t),r=this,a=t,a=(0,l.A)(a),(n=(0,o.A)(r,Ea()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c))).apiClient=e,n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"_draftAlreadyCreated",value:function(e){return!!e.id}},{key:"create",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.createDraft(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.readDraft(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._draftAlreadyCreated(t)?this.apiClient.saveDraft(t,t.links):this.create(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"publish",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.publishDraft(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.deleteDraft(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reservePID",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.reservePID(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"discardPID",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.discardPID(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createOrUpdateReview",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.createOrUpdateReview(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteReview",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.deleteReview(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitReview",value:function(){var e=(0,at.A)(lt().mark((function e(t,n){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.apiClient.submitReview(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}])}(wa);function Ca(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ca(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ca(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Sa(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Sa=function(){return!!e})()}var ka=function(){return(0,a.A)((function e(){(0,i.A)(this,e),(0,A.A)(this,"currents",[]),(0,A.A)(this,"pending",[])}),[{key:"put",value:function(e,t){this.pending.push({initializeUploadURL:e,file:t})}},{key:"totalInProgress",get:function(){return this.currents.length}},{key:"next",get:function(){var e=this.pending.shift();return void 0!==e&&this.currents.push(e.file),e}},{key:"markCompleted",value:function(e){var t=this.currents.indexOf(e);t>=0&&this.currents.splice(t,1)}}])}(),Oa=function(){return(0,a.A)((function e(t){(0,i.A)(this,e),this.dispatcher=t}),[{key:"onUploadAdded",value:function(e){throw new Error("Not implemented.")}},{key:"onUploadStarted",value:function(e,t){throw new Error("Not implemented.")}},{key:"onUploadProgress",value:function(e,t){throw new Error("Not implemented.")}},{key:"onUploadCompleted",value:function(e,t,n,r){throw new Error("Not implemented.")}},{key:"onUploadCancelled",value:function(e){throw new Error("Not implemented.")}},{key:"onUploadFailed",value:function(e){throw new Error("Not implemented.")}}])}(),Da=function(){return(0,a.A)((function e(t,n){if((0,i.A)(this,e),this.constructor===e)throw new Error("Abstract")}),[{key:"setProgressNotifier",value:function(e){if(!(e instanceof Oa))throw new Error("Progress notifier must be an instance of `UploadProgressNotifier`");this.progressNotifier=e}},{key:"upload",value:function(){var e=(0,at.A)(lt().mark((function e(t,n,r){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"importParentRecordFiles",value:function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}])}(),Ia=function(e){function t(e,n){var r,a,c,s;return(0,i.A)(this,t),a=this,c=t,c=(0,l.A)(c),r=(0,o.A)(a,Sa()?Reflect.construct(c,s||[],(0,l.A)(a).constructor):c.apply(a,s)),(0,A.A)(r,"_initializeUpload",function(){var e=(0,at.A)(lt().mark((function e(t,n){var i,a;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.fileApiClient.initializeFileUpload(t,n.name);case 2:return i=e.sent,a=i.data.entries.filter((function(e){return e.key.normalize()===n.name.normalize()}))[0],e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),(0,A.A)(r,"_doUpload",function(){var e=(0,at.A)(lt().mark((function e(t,n){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.fileApiClient.uploadFile(t,n,(function(e){return r.progressNotifier.onUploadProgress(n.name,e)}),(function(e){return r.progressNotifier.onUploadStarted(n.name,e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),(0,A.A)(r,"_finalizeUpload",function(){var e=(0,at.A)(lt().mark((function e(t,n){var i;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.uploaderQueue.markCompleted(n),r._startNextUpload(),e.next=4,r.fileApiClient.finalizeFileUpload(t);case 4:return i=e.sent,e.abrupt("return",i.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),(0,A.A)(r,"_onError",(function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?r.progressNotifier.onUploadCancelled(e.name):r.progressNotifier.onUploadFailed(e.name),r.uploaderQueue.markCompleted(e),r._startNextUpload()})),(0,A.A)(r,"_startNewUpload",function(){var e=(0,at.A)(lt().mark((function e(t,n){var i,a,o,l,c;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r._initializeUpload(t,n);case 3:i=e.sent,e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(0),r._onError(n),e.abrupt("return");case 10:return a=i.links.content,o=i.links.commit,e.prev=12,e.next=15,r._doUpload(a,n);case 15:return e.next=17,r._finalizeUpload(o,n);case 17:l=e.sent,r.progressNotifier.onUploadCompleted(l.key,l.size,l.checksum,l.links),e.next=26;break;case 21:e.prev=21,e.t1=e.catch(12),console.error(e.t1),c=r.fileApiClient.isCancelled(e.t1),r._onError(n,c);case 26:case"end":return e.stop()}}),e,null,[[0,6],[12,21]])})));return function(t,n){return e.apply(this,arguments)}}()),(0,A.A)(r,"_startNextUpload",(0,at.A)(lt().mark((function e(){var t;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.uploaderQueue.totalInProgress<r.maxConcurrentUploads)){e.next=6;break}if(!(t=r.uploaderQueue.next)){e.next=6;break}return e.next=6,r._startNewUpload(t.initializeUploadURL,t.file);case 6:case"end":return e.stop()}}),e)})))),(0,A.A)(r,"upload",function(){var e=(0,at.A)(lt().mark((function e(t,n){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.uploaderQueue.put(t,n),r.progressNotifier.onUploadAdded(n.name),e.next=4,r._startNextUpload();case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),(0,A.A)(r,"delete",function(){var e=(0,at.A)(lt().mark((function e(t){return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.fileApiClient.deleteFile(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,A.A)(r,"importParentRecordFiles",function(){var e=(0,at.A)(lt().mark((function e(t){var n;return lt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.fileApiClient.importParentRecordFiles(t);case 2:return n=e.sent,e.abrupt("return",n.data.entries.reduce((function(e,t){return Pa(Pa({},e),{},(0,A.A)({},t.key,{status:rn.finished,size:t.size,name:t.key,progressPercentage:100,checksum:t.checksum,links:t.links}))}),{}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r.fileApiClient=e,r.maxConcurrentUploads=n||3,r.uploaderQueue=new ka,r}return(0,c.A)(t,e),(0,a.A)(t)}(Da),Fa=n(88055),Ma=n.n(Fa),xa=n(84684),Ta=n.n(xa),_a=n(56449),qa=n.n(_a),za=n(53812),ja=n.n(za),La=n(5187),Ba=n.n(La),Na=n(98023),Ua=n.n(Na),Va=n(73916),Ha=n.n(Va),Ya=n(44383),Wa=n.n(Ya),Ga=n(71086),Qa=n.n(Ga),Ka=n(63560),Xa=n.n(Ka),$a=n(8306),Ja=n(80357);function Za(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return eo(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function eo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function to(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function no(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?to(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):to(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ro(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ro=function(){return!!e})()}var io=function(){return(0,a.A)((function e(t){if((0,i.A)(this,e),this.constructor===e)throw new Error("Abstract")}),[{key:"deserialize",value:function(e){throw new Error("Not implemented.")}},{key:"deserializeErrors",value:function(e){throw new Error("Not implemented.")}},{key:"serialize",value:function(e){throw new Error("Not implemented.")}}])}(),ao=function(e){function t(e){var n,r,a,c,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(0,i.A)(this,t),r=this,a=t,a=(0,l.A)(a),(n=(0,o.A)(r,ro()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c))).defaultLocale=e,n.customFieldVocabularies=s,n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"depositRecordSchema",get:function(){return{files:new $a.D0({fieldpath:"files"}),media_files:new $a.D0({fieldpath:"media_files"}),links:new $a.D0({fieldpath:"links"}),expanded:new $a.D0({fieldpath:"expanded",deserializedDefault:{}}),pids:new $a.D0({fieldpath:"pids",deserializedDefault:{},serializedDefault:{}}),title:new $a.D0({fieldpath:"metadata.title",deserializedDefault:""}),additional_titles:new $a.yv({fieldpath:"metadata.additional_titles",schema:{title:new $a.D0({fieldpath:"title"}),type:new $a.vE({fieldpath:"type",deserializedDefault:"",serializedDefault:""}),lang:new $a.vE({fieldpath:"lang",deserializedDefault:"",serializedDefault:""})}}),additional_descriptions:new $a.yv({fieldpath:"metadata.additional_descriptions",schema:{description:new $a.D0({fieldpath:"description"}),type:new $a.vE({fieldpath:"type",deserializedDefault:"",serializedDefault:""}),lang:new $a.vE({fieldpath:"lang",deserializedDefault:"",serializedDefault:""})}}),creators:new $a.yv({fieldpath:"metadata.creators",schema:{person_or_org:new $a.D0({fieldpath:"person_or_org"}),role:new $a.vE({fieldpath:"role",deserializedDefault:"",serializedDefault:""}),affiliations:new $a.TV({fieldpath:"affiliations",deserializedDefault:[],serializedDefault:[],labelField:"name"})}}),contributors:new $a.yv({fieldpath:"metadata.contributors",schema:{person_or_org:new $a.D0({fieldpath:"person_or_org"}),role:new $a.vE({fieldpath:"role",deserializedDefault:"",serializedDefault:""}),affiliations:new $a.TV({fieldpath:"affiliations",deserializedDefault:[],serializedDefault:[],labelField:"name"})}}),resource_type:new $a.vE({fieldpath:"metadata.resource_type",deserializedDefault:"",serializedDefault:""}),access:new $a.D0({fieldpath:"access",deserializedDefault:{record:"public",files:"public"}}),publication_date:new $a.D0({fieldpath:"metadata.publication_date",deserializedDefault:""}),dates:new $a.yv({fieldpath:"metadata.dates",schema:{date:new $a.D0({fieldpath:"date"}),type:new $a.vE({fieldpath:"type",deserializedDefault:"",serializedDefault:""}),description:new $a.D0({fieldpath:"description"})},deserializedDefault:[]}),languages:new $a.vE({fieldpath:"metadata.languages",deserializedDefault:[],serializedDefault:[]}),identifiers:new $a.yv({fieldpath:"metadata.identifiers",schema:{scheme:new $a.D0({fieldpath:"scheme"}),identifier:new $a.D0({fieldpath:"identifier"})},deserializedDefault:[]}),related_identifiers:new $a.yv({fieldpath:"metadata.related_identifiers",schema:{scheme:new $a.D0({fieldpath:"scheme"}),identifier:new $a.D0({fieldpath:"identifier"}),relation_type:new $a.vE({fieldpath:"relation_type",deserializedDefault:"",serializedDefault:""}),resource_type:new $a.vE({fieldpath:"resource_type",deserializedDefault:"",serializedDefault:""})},deserializedDefault:[]}),references:new $a.yv({fieldpath:"metadata.references",schema:{reference:new $a.D0({fieldpath:"reference"})},deserializedDefault:[]}),subjects:new $a.TV({fieldpath:"metadata.subjects",deserializedDefault:[],serializedDefault:[],labelField:"subject"}),funding:new $a.yv({fieldpath:"metadata.funding",schema:{award:new $a.qB({fieldpath:"award",deserializedDefault:{}}),funder:new $a.qB({fieldpath:"funder",deserializedDefault:{}})}}),version:new $a.D0({fieldpath:"metadata.version",deserializedDefault:""}),rights:new $a.MQ({fieldpath:"metadata.rights",deserializedDefault:[],serializedDefault:[],localeFields:["title","description"]}),custom_fields:new Ja.CustomField({fieldpath:"custom_fields",deserializedDefault:{},serializedDefault:{},vocabularyFields:this.customFieldVocabularies})}}},{key:"_removeEmptyValues",value:function(e){var t=this;if(qa()(e))return e.map((function(e){return t._removeEmptyValues(e)})).filter((function(e){return ja()(e)||Ua()(e)?e:!x()(e)}));if($i()(e)){var n=Ha()(e,(function(e){return t._removeEmptyValues(e)}));return Qa()(n,(function(e){return qa()(e)||$i()(e)?!x()(e):!Ba()(e)}))}return Ua()(e)||ja()(e)||e?e:null}},{key:"deserialize",value:function(e){var t=Wa()(Ma()(e),["access","expanded","metadata","id","links","files","media_files","is_published","versions","parent","status","pids","ui","custom_fields","created","updated","revision_id"]),n=t.pids||{},r=this._removeEmptyValues(t);for(var i in r=no(no({},r),x()(n)?{}:{pids:n}),this.depositRecordSchema)r=this.depositRecordSchema[i].deserialize(r,this.defaultLocale);return r}},{key:"deserializeErrors",value:function(e){var t,n={},r=Za(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;Xa()(n,i.field,i.messages.join(" "))}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"serialize",value:function(e){var t=Wa()(Ma()(e),["access","metadata","id","links","files","media_files","pids","parent","custom_fields"]),n=t.pids||{},r=t;for(var i in this.depositRecordSchema)r=this.depositRecordSchema[i].serialize(r,this.defaultLocale);return r=no(no({},r=this._removeEmptyValues(r)),{pids:x()(n)?{}:n}),Ta()(r,{metadata:{},custom_fields:{}}),r}}])}(io),oo=function(){return(0,a.A)((function e(t,n){(0,i.A)(this,e),this.draftsService=t,this.filesService=n}),[{key:"drafts",get:function(){return this.draftsService}},{key:"files",get:function(){return this.filesService}}])}(),lo=n(68238),co=n(1265);const so=(0,lo.combineReducers)({deposit:Ti,files:on});var uo=["record","preselectedCommunity","files","config","permissions"];function po(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?po(Object(n),!0).forEach((function(t){(0,A.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):po(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var mo=function(e){var t=Ma()(e);return{links:e.links||{},entries:pe()(t,"entries",[]).map((function(e){var t=e.size>=0,n={name:e.key,size:e.size||0,checksum:e.checksum||"",links:e.links||{}};return fo(t?{status:rn.finished,progressPercentage:100}:{status:rn.pending},n)})).reduce((function(e,t){return e[t.name]=fo({},t),e}),{})}};function ho(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ho=function(){return!!e})()}var vo=function(e){function t(){return(0,i.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,ho()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,a.A)(t,[{key:"onUploadAdded",value:function(e){this.dispatcher&&this.dispatcher({type:Ft,payload:{filename:e}})}},{key:"onUploadStarted",value:function(e,t){this.dispatcher&&this.dispatcher({type:Nt,payload:{filename:e,cancelUploadFn:t}})}},{key:"onUploadProgress",value:function(e,t){this.dispatcher&&this.dispatcher({type:Mt,payload:{filename:e,percent:t}})}},{key:"onUploadCompleted",value:function(e,t,n,r){this.dispatcher&&this.dispatcher({type:xt,payload:{filename:e,size:t,checksum:n,links:r}})}},{key:"onUploadCancelled",value:function(e){this.dispatcher&&this.dispatcher({type:Ut,payload:{filename:e}})}},{key:"onUploadFailed",value:function(e){this.dispatcher&&this.dispatcher({type:Tt,payload:{filename:e}})}}])}(Oa);function bo(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(bo=function(){return!!e})()}var yo=function(e){function t(e){var n,r,a,c;(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),n=(0,o.A)(r,bo()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c));var s=e.recordSerializer?e.recordSerializer:new ao(e.config.default_locale,e.config.custom_fields.vocabularies),u={headers:e.config.apiHeaders?e.config.apiHeaders:null},d=e.apiClient?e.apiClient:new da(u,e.config.createUrl,s),p=e.fileApiClient?e.fileApiClient:new fa(u),f=e.draftsService?e.draftsService:new Ra(d),m=e.filesService?e.filesService:new Ia(p,e.config.fileUploadConcurrency),h=new oo(f,m),v={config:e.config,record:s.deserialize(e.record),preselectedCommunity:e.preselectedCommunity,files:e.files,apiClient:d,fileApiClient:p,service:h,permissions:e.permissions,recordSerializer:s};n.store=function(e){var t=e.record,n=e.preselectedCommunity,r=e.files,i=e.config,a=e.permissions,o=(0,J.A)(e,uo),l={deposit:{record:t,editorState:xi(t,n||void 0),config:i,permissions:a,actionState:null,actionStateExtra:{}},files:mo(r||{})},c=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||lo.compose;return(0,lo.createStore)(so,l,c((0,lo.applyMiddleware)(co.default.withExtraArgument(fo({config:i},o)))))}(v);var b=new vo(n.store.dispatch);return m.setProgressNotifier(b),n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e=this.props.children;return s.createElement(u.Provider,{store:this.store},s.createElement(ma.x,{i18n:g.M},s.createElement(Aa,null,e)))}}])}(s.Component);yo.propTypes={config:p().object.isRequired,record:p().object.isRequired,preselectedCommunity:p().object,files:p().object,permissions:p().object,apiClient:p().instanceOf(ua),fileApiClient:p().instanceOf(pa),draftsService:p().instanceOf(wa),filesService:p().instanceOf(Da),recordSerializer:p().instanceOf(io),children:p().node},yo.defaultProps={preselectedCommunity:void 0,permissions:void 0,apiClient:void 0,fileApiClient:void 0,draftsService:void 0,filesService:void 0,recordSerializer:void 0,files:void 0,children:void 0};var go=(0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)((0,A.A)({},Fi.IN_REVIEW,{color:"warning",title:g.M.t("In review"),message:g.M.t("Community curators will review your upload. Once accepted, it will be published.")}),Fi.DECLINED,{color:"negative",title:g.M.t("Declined"),message:g.M.t("The request to submit this upload to the community was declined.")}),Fi.EXPIRED,{color:"expired",title:g.M.t("Expired"),message:g.M.t("The request to submit this upload to the community has expired.")}),Fi.PUBLISHED,{color:"positive",title:g.M.t("Published"),message:g.M.t("Your upload is published.")}),Fi.DRAFT_WITH_REVIEW,{color:"neutral",title:g.M.t("Draft"),message:g.M.t("Once your upload is complete, you can submit it for review to the community curators.")}),Fi.DRAFT,{color:"neutral",title:g.M.t("Draft"),message:g.M.t("Once your upload is complete, you can publish or submit it for review to the community curators.")}),Fi.NEW_VERSION_DRAFT,{color:"neutral",title:g.M.t("New version draft"),message:g.M.t("Once your upload is complete, you can publish it.")}),Ao=function(e){var t=e.depositReview,n=e.depositStatus,r=go[n];if(!r)throw new Error("Status is undefined");var i=n===Fi.IN_REVIEW;return s.createElement(X.A,{verticalAlign:"middle"},s.createElement(X.A.Row,{centered:!0,className:"pt-5 pb-5 ".concat(r.color)},s.createElement(X.A.Column,{width:i?8:16,textAlign:i?"left":"center"},s.createElement("span",null,r.title),s.createElement(E.A,{trigger:s.createElement(w.A,{className:"ml-10",name:"info circle"}),content:r.message})),i&&s.createElement(X.A.Column,{width:8,textAlign:"right"},s.createElement(R.A,{href:"/me/requests/".concat(t.id),target:"_blank",icon:"external alternate",content:g.M.t("View request"),size:"mini",className:"transparent",title:g.M.t("Opens in new tab")}))))};Ao.propTypes={depositReview:p().bool,depositStatus:p().string.isRequired},Ao.defaultProps={depositReview:void 0};var Eo=(0,u.connect)((function(e){return{depositStatus:e.deposit.record.status,depositReview:e.deposit.record.status!==Fi.DRAFT&&e.deposit.record.parent.review}}),null)(Ao),wo=n(27089);function Ro(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ro=function(){return!!e})()}var Co=function(e){function t(e){var n,r,a,c;return(0,i.A)(this,t),r=this,a=t,c=[e],a=(0,l.A)(a),(n=(0,o.A)(r,Ro()?Reflect.construct(a,c||[],(0,l.A)(r).constructor):a.apply(r,c))).state={modalOpen:!1},n}return(0,c.A)(t,e),(0,a.A)(t,[{key:"render",value:function(){var e,t=this,n=this.props,r=n.changeSelectedCommunity,i=n.community,a=n.imagePlaceholderLink,o=n.showCommunitySelectionButton,l=n.disableCommunitySelectionButton,c=n.showCommunityHeader,u=n.record,d=this.state.modalOpen;return c&&s.createElement(wo.A,{className:"page-subheader-outer compact ml-0-mobile mr-0-mobile",fluid:!0},s.createElement(wo.A,{className:"page-subheader"},i?s.createElement(s.Fragment,null,s.createElement("div",{className:"page-subheader-element"},s.createElement(m.Image,{rounded:!0,className:"community-header-logo",src:(null===(e=i.links)||void 0===e?void 0:e.logo)||a,fallbackSrc:a})),s.createElement("div",{className:"page-subheader-element flex align-items-center"},i.metadata.title)):s.createElement("div",{className:"page-subheader-element"},g.M.t("Select the community where you want to submit your record.")),s.createElement("div",{className:"community-header-element flex align-items-center rel-ml-1"},o&&s.createElement(O.default,{id:"InvenioRdmRecords.CommunityHeader.CommunityHeaderElement.Container"},s.createElement(s.Fragment,null,s.createElement(Ri,{onCommunityChange:function(e){r(e),t.setState({modalOpen:!1})},onModalChange:function(e){return t.setState({modalOpen:e})},modalOpen:d,chosenCommunity:i,displaySelected:!0,record:u,trigger:s.createElement(O.default,{id:"InvenioRdmRecords.CommunityHeader.CommunitySelectionButton.Container"},s.createElement(R.A,{className:"community-header-button",disabled:l,onClick:function(){return t.setState({modalOpen:!0})},primary:!0,size:"mini",name:"setting",type:"button",content:i?g.M.t("Change"):g.M.t("Select a community")}))}),s.createElement(O.default,{id:"InvenioRdmRecords.CommunityHeader.RemoveCommunityButton.Container",community:i},i&&s.createElement(R.A,{basic:!0,size:"mini",labelPosition:"left",className:"community-header-button ml-5",onClick:function(){return r(null)},content:g.M.t("Remove"),icon:"close",disabled:l})))))))}}])}(s.Component);Co.propTypes={imagePlaceholderLink:p().string.isRequired,community:p().object,disableCommunitySelectionButton:p().bool.isRequired,showCommunitySelectionButton:p().bool.isRequired,showCommunityHeader:p().bool.isRequired,changeSelectedCommunity:p().func.isRequired,record:p().object.isRequired},Co.defaultProps={community:void 0};var Po=(0,u.connect)((function(e){return{community:e.deposit.editorState.selectedCommunity,disableCommunitySelectionButton:e.deposit.editorState.ui.disableCommunitySelectionButton,showCommunitySelectionButton:e.deposit.editorState.ui.showCommunitySelectionButton,showCommunityHeader:e.deposit.editorState.ui.showCommunityHeader}}),(function(e){return{changeSelectedCommunity:function(t){return e($t(t))}}}))(Co);var So=function(e){var t=document.getElementsByName(e);return t.length>0&&t[0].hasAttribute("value")?JSON.parse(t[0].value):null}},80357:(e,t,n)=>{n.r(t),n.d(t,{CustomField:()=>P,Imprint:()=>T,Journal:()=>q,Meeting:()=>j,Thesis:()=>B});var r=n(80296),i=n(82284),a=n(23029),o=n(92901),l=n(56822),c=n(53954),s=n(85501),u=n(58156),d=n.n(u),p=n(63560),f=n.n(p),m=n(88055),h=n.n(m),v=n(56449),b=n.n(v),y=n(23805),g=n.n(y),A=n(8306);function E(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(E=function(){return!!e})()}function w(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function R(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var C=new WeakSet,P=function(e){function t(e){var n,r,i,o,s=e.fieldpath,u=e.deserializedDefault,d=void 0===u?null:u,p=e.serializedDefault,f=void 0===p?null:p,m=e.allowEmpty,h=void 0!==m&&m,v=e.vocabularyFields,b=void 0===v?[]:v;return(0,a.A)(this,t),r=this,i=t,o=[{fieldpath:s,deserializedDefault:d,serializedDefault:f,allowEmpty:h}],i=(0,c.A)(i),w(n=(0,l.A)(r,E()?Reflect.construct(i,o||[],(0,c.A)(r).constructor):i.apply(r,o)),C),n.vocabularyFields=b,n}return(0,s.A)(t,e),(0,o.A)(t,[{key:"recursiveMapping",value:function(e,t,n){var r=null;if(b()(e))r=e.map((function(e,r){return n(e,r,t)}));else if(g()(e)&&!t){for(var i in e)e[i]=this.recursiveMapping(e[i],t,n);r=e}else r=n(e,null,t);return r}},{key:"deserialize",value:function(e){var t=h()(e),n=d()(e,this.fieldpath,this.deserializedDefault);return R(C,this,S).call(this,t,n,(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&null!==e&&void 0!==e&&e.id?e.id:(t&&"object"===(0,i.A)(e)&&null!==e&&(e.__key=t),e)})),t}},{key:"serialize",value:function(e){var t=h()(e),n=d()(e,this.fieldpath,this.serializedDefault);return R(C,this,S).call(this,t,n,(function(e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&"string"===typeof e?{id:e}:(delete e.__key,e)})),t}}])}(A.D0);function S(e,t,n){if(null!==t)for(var i=0,a=Object.entries(t);i<a.length;i++){var o=(0,r.A)(a[i],2),l=o[0],c=o[1],s=this.vocabularyFields.includes(l),u=this.recursiveMapping(c,s,n);e=f()(e,"custom_fields.".concat(l),u)}}var k=n(96540),O=n(81057),D=n(36713),I=n(1489),F=n(5556),M=n.n(F);function x(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(x=function(){return!!e})()}var T=function(e){function t(){return(0,a.A)(this,t),e=this,n=t,r=arguments,n=(0,c.A)(n),(0,l.A)(e,x()?Reflect.construct(n,r||[],(0,c.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,s.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.title,r=e.place,i=e.isbn,a=e.pages,o=e.label,l=e.icon;return k.createElement(k.Fragment,null,o&&k.createElement(k.Fragment,null,k.createElement(O.FieldLabel,{htmlFor:t,icon:l,label:o}),k.createElement(D.A,{fitted:!0})),k.createElement(I.A,{padded:!0},k.createElement(I.A.Column,{width:"12"},k.createElement(O.Input,{fieldPath:"".concat(t,".title"),label:n.label,placeholder:n.placeholder}),n.description&&k.createElement("label",{className:"helptext mb-0"},n.description)),k.createElement(I.A.Column,{width:"4"},k.createElement(O.Input,{fieldPath:"".concat(t,".isbn"),label:i.label,placeholder:i.placeholder}),i.description&&k.createElement("label",{className:"helptext mb-0"},i.description)),k.createElement(I.A.Column,{width:"6"},k.createElement(O.Input,{fieldPath:"".concat(t,".place"),label:r.label,placeholder:r.placeholder}),r.description&&k.createElement("label",{className:"helptext mb-0"},r.description)),k.createElement(I.A.Column,{width:"6"},k.createElement(O.Input,{fieldPath:"".concat(t,".pages"),label:a.label,placeholder:a.placeholder}),a.description&&k.createElement("label",{className:"helptext mb-0"},a.description))))}}])}(k.Component);function _(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_=function(){return!!e})()}T.propTypes={fieldPath:M().string.isRequired,title:M().object.isRequired,place:M().object.isRequired,isbn:M().object.isRequired,pages:M().object.isRequired,icon:M().string,label:M().string},T.defaultProps={icon:void 0,label:void 0};var q=function(e){function t(){return(0,a.A)(this,t),e=this,n=t,r=arguments,n=(0,c.A)(n),(0,l.A)(e,_()?Reflect.construct(n,r||[],(0,c.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,s.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.title,r=e.volume,i=e.issue,a=e.pages,o=e.issn,l=e.icon,c=e.label;return k.createElement(k.Fragment,null,c&&k.createElement(k.Fragment,null,k.createElement(O.FieldLabel,{htmlFor:t,icon:l,label:c}),k.createElement(D.A,{fitted:!0})),k.createElement(I.A,{padded:!0},k.createElement(I.A.Column,{width:"12"},k.createElement(O.Input,{fieldPath:"".concat(t,".title"),label:n.label,placeholder:n.placeholder}),n.description&&k.createElement("label",{className:"helptext mb-0"},n.description)),k.createElement(I.A.Column,{width:"4"},k.createElement(O.Input,{fieldPath:"".concat(t,".issn"),label:o.label,placeholder:o.placeholder}),o.description&&k.createElement("label",{className:"helptext mb-0"},o.description)),k.createElement(I.A.Column,{width:"6"},k.createElement(O.Input,{fieldPath:"".concat(t,".volume"),label:r.label,placeholder:r.placeholder}),r.description&&k.createElement("label",{className:"helptext mb-0"},r.description)),k.createElement(I.A.Column,{width:"6"},k.createElement(O.Input,{fieldPath:"".concat(t,".issue"),label:i.label,placeholder:i.placeholder}),i.description&&k.createElement("label",{className:"helptext mb-0"},i.description)),k.createElement(I.A.Column,{width:"4"},k.createElement(O.Input,{fieldPath:"".concat(t,".pages"),label:a.label,placeholder:a.placeholder}),a.description&&k.createElement("label",{className:"helptext mb-0"},a.description))))}}])}(k.Component);function z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(z=function(){return!!e})()}q.propTypes={fieldPath:M().string.isRequired,title:M().object.isRequired,volume:M().object.isRequired,issue:M().object.isRequired,pages:M().object.isRequired,issn:M().object.isRequired,icon:M().string,label:M().string},q.defaultProps={icon:void 0,label:void 0};var j=function(e){function t(){return(0,a.A)(this,t),e=this,n=t,r=arguments,n=(0,c.A)(n),(0,l.A)(e,z()?Reflect.construct(n,r||[],(0,c.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,s.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.title,r=e.acronym,i=e.dates,a=e.place,o=e.url,l=e.session,c=e.session_part,s=e.icon,u=e.label;return k.createElement(k.Fragment,null,u&&k.createElement(k.Fragment,null,k.createElement(O.FieldLabel,{htmlFor:t,icon:s,label:u}),k.createElement(D.A,{fitted:!0})),k.createElement(I.A,{padded:!0},k.createElement(I.A.Column,{width:"12"},k.createElement(O.Input,{fieldPath:"".concat(t,".title"),label:n.label,placeholder:n.placeholder}),n.description&&k.createElement("label",{className:"helptext mb-0"},n.description)),k.createElement(I.A.Column,{width:"4"},k.createElement(O.Input,{fieldPath:"".concat(t,".acronym"),label:r.label,placeholder:r.placeholder}),r.description&&k.createElement("label",{className:"helptext mb-0"},r.description)),k.createElement(I.A.Column,{width:"12"},k.createElement(O.Input,{fieldPath:"".concat(t,".place"),label:a.label,placeholder:a.placeholder}),a.description&&k.createElement("label",{className:"helptext mb-0"},a.description)),k.createElement(I.A.Column,{width:"4"},k.createElement(O.Input,{fieldPath:"".concat(t,".dates"),label:i.label,placeholder:i.placeholder}),i.description&&k.createElement("label",{className:"helptext mb-0"},i.description)),k.createElement(I.A.Column,{width:"12"},k.createElement(O.Input,{fieldPath:"".concat(t,".url"),label:o.label,placeholder:o.placeholder}),o.description&&k.createElement("label",{className:"helptext mb-0"},o.description)),k.createElement(I.A.Column,{width:"6"},k.createElement(O.Input,{fieldPath:"".concat(t,".session"),label:l.label,placeholder:l.placeholder}),l.description&&k.createElement("label",{className:"helptext mb-0"},l.description)),k.createElement(I.A.Column,{width:"6"},k.createElement(O.Input,{fieldPath:"".concat(t,".session_part"),label:c.label,placeholder:c.placeholder}),c.description&&k.createElement("label",{className:"helptext mb-0"},c.description))))}}])}(k.Component);function L(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(L=function(){return!!e})()}j.propTypes={fieldPath:M().string.isRequired,title:M().object.isRequired,acronym:M().object.isRequired,session_part:M().object.isRequired,session:M().object.isRequired,url:M().object.isRequired,dates:M().object.isRequired,place:M().object.isRequired,icon:M().string,label:M().string},j.defaultProps={icon:void 0,label:void 0};var B=function(e){function t(){return(0,a.A)(this,t),e=this,n=t,r=arguments,n=(0,c.A)(n),(0,l.A)(e,L()?Reflect.construct(n,r||[],(0,c.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,s.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.fieldPath,n=e.university,r=e.icon,i=e.label;return k.createElement(k.Fragment,null,i&&k.createElement(k.Fragment,null,k.createElement(O.FieldLabel,{htmlFor:t,icon:r,label:i}),k.createElement(D.A,{fitted:!0})),k.createElement(I.A,{padded:!0},k.createElement(I.A.Column,{width:"16"},k.createElement(O.Input,{fieldPath:t,label:n.label,placeholder:n.placeholder}),n.description&&k.createElement("label",{className:"helptext mb-0"},n.description))))}}])}(k.Component);B.propTypes={fieldPath:M().string.isRequired,university:M().object.isRequired,icon:M().string,label:M().string},B.defaultProps={icon:void 0,label:void 0}},8306:(e,t,n)=>{n.d(t,{TV:()=>F,D0:()=>d,qB:()=>P,MQ:()=>k,yv:()=>y,vE:()=>R});var r=n(58156),i=n.n(r),a=(n(2404),n(23029)),o=n(92901),l=n(63560),c=n.n(l),s=n(88055),u=n.n(s),d=function(){return(0,o.A)((function e(t){var n=t.fieldpath,r=t.deserializedDefault,i=void 0===r?null:r,o=t.serializedDefault,l=void 0===o?null:o,c=t.allowEmpty,s=void 0!==c&&c;(0,a.A)(this,e),this.fieldpath=n,this.deserializedDefault=i,this.serializedDefault=l,this.allowEmpty=s}),[{key:"deserialize",value:function(e){var t=i()(e,this.fieldpath,this.deserializedDefault);return null!==t?c()(u()(e),this.fieldpath,t):e}},{key:"serialize",value:function(e){var t=i()(e,this.fieldpath,this.serializedDefault);return null!==t?c()(u()(e),this.fieldpath,t):e}}])}();var p=n(56822),f=n(53954),m=n(85501),h=n(44383),v=n.n(h);function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(b=function(){return!!e})()}var y=function(e){function t(e){var n,r,i,o,l=e.fieldpath,c=e.schema,s=e.deserializedDefault,u=void 0===s?[]:s,d=e.serializedDefault,m=void 0===d?[]:d;return(0,a.A)(this,t),r=this,i=t,o=[{fieldpath:l,deserializedDefault:u,serializedDefault:m}],i=(0,f.A)(i),(n=(0,p.A)(r,b()?Reflect.construct(i,o||[],(0,f.A)(r).constructor):i.apply(r,o))).schema=c,n.schemaKeys=Object.keys(n.schema),n}return(0,m.A)(t,e),(0,o.A)(t,[{key:"deserialize",value:function(e,t){var n=this,r=i()(e,this.fieldpath,this.deserializedDefault).map((function(e,r){var i=v()(e,n.schemaKeys);return n.schemaKeys.forEach((function(e){i=n.schema[e].deserialize(i,t)})),i.__key=r,i}));return c()(u()(e),this.fieldpath,r)}},{key:"serialize",value:function(e,t){var n=this,r=i()(e,this.fieldpath,this.serializedDefault),a=null===r||void 0===r?void 0:r.map((function(e){var r=v()(e,n.schemaKeys);return n.schemaKeys.forEach((function(e){r=n.schema[e].serialize(r,t)})),r}));return null!==a?c()(u()(e),this.fieldpath,a):a}}])}(d),g=n(64467);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(w=function(){return!!e})()}var R=function(e){function t(e){var n,r,i,o,l=e.fieldpath,c=e.deserializedDefault,s=void 0===c?null:c,u=e.serializedDefault,d=void 0===u?null:u,m=e.labelField,h=void 0===m?"name":m;return(0,a.A)(this,t),r=this,i=t,o=[{fieldpath:l,deserializedDefault:s,serializedDefault:d}],i=(0,f.A)(i),(n=(0,p.A)(r,w()?Reflect.construct(i,o||[],(0,f.A)(r).constructor):i.apply(r,o))).labelField=h,n}return(0,m.A)(t,e),(0,o.A)(t,[{key:"deserialize",value:function(e){var t=function(e){if(null!==e&&void 0!==e&&e.id)return e.id},n=i()(e,this.fieldpath,this.deserializedDefault),r=null;return null!==n&&(r=Array.isArray(n)?n.map(t):t(n)),c()(u()(e),this.fieldpath,r||n)}},{key:"serialize",value:function(e){var t=this,n=function(e){return"string"===typeof e?{id:e}:E(E({},e.id?{id:e.id}:{}),e[t.labelField]&&(0,g.A)({},t.labelField,e[t.labelField]))},r=i()(e,this.fieldpath,this.serializedDefault),a=null;return null!==r&&(a=Array.isArray(r)?r.map(n):n(r)),c()(u()(e),this.fieldpath,a||r)}}])}(d);function C(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(C=function(){return!!e})()}var P=function(e){function t(e){var n,r,i,o=e.fieldpath,l=e.deserializedDefault,c=void 0===l?null:l,s=e.serializedDefault,u=void 0===s?null:s;return(0,a.A)(this,t),n=this,r=t,i=[{fieldpath:o,deserializedDefault:c,serializedDefault:u}],r=(0,f.A)(r),(0,p.A)(n,C()?Reflect.construct(r,i||[],(0,f.A)(n).constructor):r.apply(n,i))}return(0,m.A)(t,e),(0,o.A)(t,[{key:"deserialize",value:function(e,t){var n=function(e){var n=u()(e);if(null!==e&&void 0!==e&&e.title&&(n.title=e.title[t]),e.identifiers){["url"].forEach((function(t){var r=null;e.identifiers.forEach((function(e){e.scheme===t&&(r=e.identifier)})),r&&(n[t]=r)})),delete n.identifiers}return n},r=i()(e,this.fieldpath,this.deserializedDefault),a=null;return null!==r&&(a=Array.isArray(r)?r.map(n):n(r)),c()(u()(e),this.fieldpath,a||r)}},{key:"serialize",value:function(e,t){var n=function(e){if(e.id)return{id:e.id};var n=u()(e);return e.title&&(n.title=(0,g.A)({},t,e.title)),e.url&&(n.identifiers=[{identifier:e.url,scheme:"url"}],delete n.url),n},r=i()(e,this.fieldpath,this.serializedDefault),a=null;return null!==r&&(a=Array.isArray(r)?r.map(n):n(r)),c()(u()(e),this.fieldpath,a||r)}}])}(d);function S(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(S=function(){return!!e})()}var k=function(e){function t(e){var n,r,i,o,l=e.fieldpath,c=e.deserializedDefault,s=void 0===c?null:c,u=e.serializedDefault,d=void 0===u?null:u,m=e.localeFields,h=void 0===m?[]:m;return(0,a.A)(this,t),r=this,i=t,o=[{fieldpath:l,deserializedDefault:s,serializedDefault:d}],i=(0,f.A)(i),(n=(0,p.A)(r,S()?Reflect.construct(i,o||[],(0,f.A)(r).constructor):i.apply(r,o))).localeFields=h,n}return(0,m.A)(t,e),(0,o.A)(t,[{key:"deserialize",value:function(e,t){var n=this,r=i()(e,this.fieldpath,this.deserializedDefault),a=function(e){if("id"in e)return"string"===typeof e.title?e:{id:e.id};var r=u()(e);return n.localeFields.forEach((function(n){e[n]&&(r[n]=e[n][t])})),r},o=null;return null!==r&&(o=Array.isArray(r)?r.map(a):a(r)),c()(u()(e),this.fieldpath,o||r)}},{key:"serialize",value:function(e,t){var n=this,r=i()(e,this.fieldpath,this.serializedDefault),a=null,o=function(e){var r=u()(e);return"id"in e&&null!=e.id?{id:e.id}:(n.localeFields.forEach((function(n){n in e&&(r[n]=(0,g.A)({},t,e[n]))})),r)};return null!==r&&(a=Array.isArray(r)?r.map(o):o(r)),c()(u()(e),this.fieldpath,a||r)}}])}(R);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,g.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(I=function(){return!!e})()}var F=function(e){function t(){return(0,a.A)(this,t),e=this,n=t,r=arguments,n=(0,f.A)(n),(0,p.A)(e,I()?Reflect.construct(n,r||[],(0,f.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,m.A)(t,e),(0,o.A)(t,[{key:"deserialize",value:function(e){var t=this,n=i()(e,this.fieldpath,this.deserializedDefault),r=function(e){return D(D({},e.id?{id:e.id}:{}),{},(0,g.A)({},t.labelField,e[t.labelField]))},a=null;return null!==n&&(a=Array.isArray(n)?n.map(r):r(n)),c()(u()(e),this.fieldpath,a||n)}}])}(R)}}]);
//# sourceMappingURL=3532.3441c3627d2621d1f46f.js.map